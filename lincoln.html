<!DOCTYPE html>
html>
<head>
<title>Lincoln Memorial CaBi Trips</title>
<style>
body {
  background-color: #000000;
  font-family: Monospace;
  cursor: url(cursor.png), auto;
  margin: 0;
  height: 100%;
  overflow: hidden;
  }
canvas {
  position: absolute;
  top: 0;
  left: 0;
  }
.cabistation {
  padding: 2px 8px;
  position: absolute;
  color: #FFFFFF;
  background-color: #FF0000;
  font-family: sans-serif;
  border-width: 2px;
  border-style: solid;
  border-radius: 8px 8px 8px 0px;
  border-color: #FFFF00;
  }
.cabistation:after {
  bottom: -16px;
  left: 0px;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
  border-color: transparent;
  border-top-color: #FFFF00;
  border-left-color: #FFFF00;
  border-width: 8px;
  margin-left: -2px;
  }
#instructions {
  position: absolute;
  top: 15px;
  width: 100%;
  color: #BBBBFF;
  text-align: center;
  }
</style>
<script src="../../lib/three.min.js"></script>
<script src="../../lib/Projector.js"></script>
<script src="../../lib/MapControls.js"></script>
</head>
<body>
<script>
// Mesh = Geometry + Material
var scene, camera, renderer;
var globalScale = 0.022;  // how to convert meters to pixels
var light;
var ground;
var lastTime;
var minLng, maxLng, minLat, maxLat;
var worldWidth = 400;
var worldHeight = 400;
var lookingAt = {point: new THREE.Vector3(0, 0, 0), theta: 0};
var cursor = {x: window.innerWidth/2, y: window.innerHeight/2};
var LincolnTraffic = [{trips:0,name:"8th & F St NW",lat:38.896866,lng:-77.02291},{trips:0,name:"11th & K St NW",lat:38.90268,lng:-77.02674},{trips:0,name:"S Abingdon St & 36th St S",lat:38.834946,lng:-77.094},{trips:0,name:"White House [17th & State Pl NW]",lat:38.896496,lng:-77.03895},{trips:57,name:"20th & Bell St",lat:38.8561,lng:-77.0512},{trips:158,name:"18th & Eads St.",lat:38.85725,lng:-77.05332},{trips:407,name:"20th & Crystal Dr",lat:38.856213,lng:-77.04983},{trips:373,name:"15th & Crystal Dr",lat:38.86017,lng:-77.04959},{trips:82,name:"Aurora Hills Community Ctr/18th & Hayes St",lat:38.857864,lng:-77.05949},{trips:606,name:"Pentagon City Metro / 12th & S Hayes St",lat:38.862305,lng:-77.05994},{trips:609,name:"S Joyce & Army Navy Dr",lat:38.8637,lng:-77.0633},{trips:171,name:"Crystal City Metro / 18th & Bell St",lat:38.857063,lng:-77.05114},{trips:189,name:"12th & Army Navy Dr",lat:38.8629,lng:-77.0528},{trips:112,name:"27th & Crystal Dr",lat:38.848442,lng:-77.05151},{trips:71,name:"S Glebe & Potomac Ave",lat:38.8426,lng:-77.0502},{trips:120,name:"23rd & Crystal Dr",lat:38.8533,lng:-77.0498},{trips:34,name:"26th & S Clark St",lat:38.85069,lng:-77.05152},{trips:385,name:"19th St & Pennsylvania Ave NW",lat:38.9003,lng:-77.0429},{trips:218,name:"14th & V St NW",lat:38.9176,lng:-77.0321},{trips:37,name:"11th & Kenyon St NW",lat:38.929462,lng:-77.027824},{trips:130,name:"16th & Harvard St NW",lat:38.926086,lng:-77.03654},{trips:126,name:"Adams Mill & Columbia Rd NW",lat:38.922924,lng:-77.04258},{trips:79,name:"14th & Harvard St NW",lat:38.9268,lng:-77.0322},{trips:132,name:"Calvert & Biltmore St NW",lat:38.923203,lng:-77.04764},{trips:44,name:"Lamont & Mt Pleasant NW",lat:38.9319,lng:-77.0388},{trips:423,name:"4th & M St SW",lat:38.8767,lng:-77.0178},{trips:477,name:"15th & P St NW",lat:38.90985,lng:-77.03444},{trips:209,name:"14th & R St NW",lat:38.91268,lng:-77.03168},{trips:454,name:"14th & Rhode Island Ave NW",lat:38.9086,lng:-77.0323},{trips:525,name:"20th & E St NW",lat:38.8963,lng:-77.045},{trips:535,name:"21st & I St NW",lat:38.9008,lng:-77.047},{trips:10,name:"Georgia & New Hampshire Ave NW",lat:38.936043,lng:-77.02465},{trips:10,name:"14th St & Spring Rd NW",lat:38.9375,lng:-77.0328},{trips:5,name:"John McCormack Dr & Michigan Ave NE",lat:38.9346,lng:-76.9955},{trips:191,name:"5th & K St NW",lat:38.90304,lng:-77.01903},{trips:22,name:"19th & East Capitol St SE",lat:38.8896,lng:-76.9769},{trips:44,name:"Park Rd & Holmead Pl NW",lat:38.9308,lng:-77.0315},{trips:0,name:"Good Hope & Naylor Rd SE",lat:38.8601,lng:-76.9672},{trips:62,name:"Connecticut Ave & Newark St NW / Cleveland Park",lat:38.934265,lng:-77.057976},{trips:0,name:"Randle Circle & Minnesota Ave SE",lat:38.878,lng:-76.9607},{trips:1,name:"Minnesota Ave Metro/DOES",lat:38.897064,lng:-76.94745},{trips:0,name:"Nannie Helen Burroughs & Minnesota Ave NE",lat:38.901386,lng:-76.94188},{trips:0,name:"Anacostia Metro",lat:38.86267,lng:-76.99464},{trips:5,name:"Good Hope Rd & MLK Ave SE",lat:38.867374,lng:-76.98804},{trips:407,name:"19th & E Street NW",lat:38.8952,lng:-77.0436},{trips:8,name:"4th & W St NE",lat:38.91908,lng:-77.00065},{trips:50,name:"10th & U St NW",lat:38.9172,lng:-77.0259},{trips:8,name:"Georgia Ave and Fairmont St NW",lat:38.9249,lng:-77.0222},{trips:69,name:"1st & N St  SE",lat:38.8743,lng:-77.0057},{trips:250,name:"20th St & Florida Ave NW",lat:38.9154,lng:-77.0446},{trips:49,name:"7th & T St NW",lat:38.9155,lng:-77.0222},{trips:84,name:"23rd & Eads St",lat:38.85353,lng:-77.05351},{trips:91,name:"M St & New Jersey Ave SE",lat:38.8763,lng:-77.0037},{trips:1022,name:"Massachusetts Ave & Dupont Circle NW",lat:38.9101,lng:-77.0444},{trips:307,name:"1st & M St NE",lat:38.9057,lng:-77.0056},{trips:604,name:"21st & M St NW",lat:38.90534,lng:-77.046776},{trips:568,name:"17th & K St NW",lat:38.90276,lng:-77.03863},{trips:174,name:"3rd & H St NW",lat:38.899406,lng:-77.01529},{trips:308,name:"3rd & D St SE",lat:38.8851,lng:-77.0023},{trips:50,name:"Potomac & Pennsylvania Ave SE",lat:38.8803,lng:-76.9862},{trips:24,name:"14th & D St SE",lat:38.884,lng:-76.9861},{trips:264,name:"17th & Corcoran St NW",lat:38.9121,lng:-77.0387},{trips:40,name:"Van Ness Metro / UDC",lat:38.94455,lng:-77.063896},{trips:74,name:"Florida Ave & R St NW",lat:38.9126,lng:-77.0135},{trips:39,name:"8th & Eye St SE / Barracks Row",lat:38.8792,lng:-76.9953},{trips:27,name:"Ward Circle / American University",lat:38.938736,lng:-77.08717},{trips:32,name:"Wisconsin Ave & Newark St NW",lat:38.93488,lng:-77.072754},{trips:7,name:"14th St Heights / 14th & Crittenden St NW",lat:38.947773,lng:-77.03282},{trips:0,name:"Anacostia Library",lat:38.865784,lng:-76.9784},{trips:0,name:"Pennsylvania & Minnesota Ave SE",lat:38.87306,lng:-76.971016},{trips:147,name:"Eastern Market / 7th & North Carolina Ave SE",lat:38.88695,lng:-76.9968},{trips:688,name:"14th St & New York Ave NW",lat:38.89963,lng:-77.031685},{trips:0,name:"Benning Branch Library",lat:38.894,lng:-76.947975},{trips:1971,name:"USDA / 12th & Independence Ave SW",lat:38.887238,lng:-77.02823},{trips:2482,name:"Georgetown Harbor / 30th St NW",lat:38.90222,lng:-77.05922},{trips:5,name:"12th & Newton St NE",lat:38.933666,lng:-76.99101},{trips:422,name:"US Dept of State / Virginia Ave & 21st St NW",lat:38.89492,lng:-77.046585},{trips:1258,name:"L'Enfant Plaza / 7th & C St SW",lat:38.886265,lng:-77.02224},{trips:2333,name:"10th St & Constitution Ave NW",lat:38.89303,lng:-77.02602},{trips:463,name:"Kennedy Center",lat:38.897293,lng:-77.05557},{trips:287,name:"Eastern Market Metro / Pennsylvania Ave & 7th St SE",lat:38.884,lng:-76.9954},{trips:288,name:"18th & M St NW",lat:38.904743,lng:-77.0416},{trips:25,name:"Tenleytown / Wisconsin Ave & Albemarle St NW",lat:38.947605,lng:-77.079384},{trips:44,name:"13th & H St NE",lat:38.9003,lng:-76.9882},{trips:343,name:"5th & F St NW",lat:38.89722,lng:-77.01935},{trips:3735,name:"New York Ave & 15th St NW",lat:38.8991,lng:-77.0337},{trips:183,name:"Convention Center / 7th & M St NW",lat:38.90572,lng:-77.02226},{trips:189,name:"Harvard St & Adams Mill Rd NW",lat:38.92787,lng:-77.04336},{trips:198,name:"19th & L St NW",lat:38.903408,lng:-77.04365},{trips:1395,name:"C & O Canal & Wisconsin Ave NW",lat:38.90375,lng:-77.06269},{trips:300,name:"6th & Water St SW / SW Waterfront",lat:38.87675,lng:-77.02127},{trips:125,name:"D St & Maryland Ave NE",lat:38.894756,lng:-76.997116},{trips:103,name:"34th St & Wisconsin Ave NW",lat:38.916443,lng:-77.0682},{trips:372,name:"13th St & New York Ave NW",lat:38.900284,lng:-77.02982},{trips:727,name:"8th & H St NW",lat:38.8997,lng:-77.02309},{trips:3,name:"10th & Monroe St NE",lat:38.932514,lng:-76.99289},{trips:19,name:"Eckington Pl & Q St NE",lat:38.910973,lng:-77.00495},{trips:82,name:"6th & H St NE",lat:38.89997,lng:-76.998344},{trips:195,name:"3rd & H St NE",lat:38.900414,lng:-77.001945},{trips:14,name:"Bladensburg Rd & Benning Rd NE",lat:38.900414,lng:-76.98287},{trips:333,name:"4th & East Capitol St NE",lat:38.889954,lng:-77.00035},{trips:108,name:"Lincoln Park / 13th & East Capitol St NE ",lat:38.89046,lng:-76.98836},{trips:0,name:"Branch & Pennsylvania Ave SE",lat:38.8692,lng:-76.9599},{trips:41,name:"13th & D St NE",lat:38.894833,lng:-76.98763},{trips:232,name:"New Hampshire Ave & T St NW",lat:38.91554,lng:-77.03818},{trips:1087,name:"Metro Center / 12th & G St NW",lat:38.898365,lng:-77.02787},{trips:2231,name:"14th & D St NW / Ronald Reagan Building",lat:38.894512,lng:-77.03162},{trips:1117,name:"7th & F St NW / National Portrait Gallery",lat:38.89735,lng:-77.02247},{trips:695,name:"17th & K St NW / Farragut Square",lat:38.90206,lng:-77.03832},{trips:411,name:"20th & O St NW / Dupont South",lat:38.908905,lng:-77.04478},{trips:167,name:"4th & D St NW / Judiciary Square",lat:38.895344,lng:-77.016106},{trips:2948,name:"19th St & Constitution Ave NW",lat:38.8923,lng:-77.0436},{trips:555,name:"37th & O St NW / Georgetown University",lat:38.90774,lng:-77.071655},{trips:48,name:"11th & H St NE",lat:38.899982,lng:-76.99139},{trips:681,name:"25th St & Pennsylvania Ave NW",lat:38.903828,lng:-77.05348},{trips:955,name:"Columbus Circle / Union Station",lat:38.89696,lng:-77.00493},{trips:628,name:"North Capitol St & F St NW",lat:38.897446,lng:-77.00989},{trips:272,name:"11th & M St NW",lat:38.905605,lng:-77.02714},{trips:53,name:"36th & Calvert St NW / Glover Park",lat:38.92258,lng:-77.070335},{trips:1211,name:"14th & G St NW",lat:38.898067,lng:-77.03182},{trips:60,name:"Potomac Ave & 35th St S",lat:38.844013,lng:-77.05054},{trips:4900,name:"Ohio Dr & West Basin Dr SW / MLK & FDR Memorials",lat:38.88412,lng:-77.04657},{trips:529,name:"11th & F St NW",lat:38.897858,lng:-77.02698},{trips:695,name:"23rd & E St NW ",lat:38.896103,lng:-77.04988},{trips:1038,name:"Lynn & 19th St North",lat:38.897316,lng:-77.07099},{trips:711,name:"Rosslyn Metro / Wilson Blvd & Ft Myer Dr",lat:38.8946,lng:-77.0723},{trips:199,name:"Clarendon Blvd & Pierce St",lat:38.893646,lng:-77.0767},{trips:175,name:"Wilson Blvd & N Uhle St",lat:38.891697,lng:-77.0846},{trips:166,name:"N Rhodes & 16th St N",lat:38.892162,lng:-77.07938},{trips:0,name:"Fairfax Village",lat:38.86559,lng:-76.9521},{trips:1295,name:"21st St & Constitution Ave NW",lat:38.89246,lng:-77.04657},{trips:36,name:"Wilson Blvd & N Edgewood St",lat:38.889,lng:-77.0925},{trips:66,name:"Columbia Rd & Belmont St NW",lat:38.92067,lng:-77.04368},{trips:301,name:"17th & Rhode Island Ave NW",lat:38.9066,lng:-77.03879},{trips:841,name:"Thomas Circle",lat:38.9059,lng:-77.0325},{trips:55,name:"Wilson Blvd & Franklin Rd",lat:38.8904,lng:-77.0889},{trips:70,name:"Clarendon Blvd & N Fillmore St",lat:38.8881,lng:-77.09308},{trips:35,name:"Clarendon Metro / Wilson Blvd & N Highland St",lat:38.88786,lng:-77.09487},{trips:692,name:"18th St & Pennsylvania Ave NW",lat:38.89968,lng:-77.04154},{trips:3619,name:"Maryland & Independence Ave SW",lat:38.8873,lng:-77.018936},{trips:498,name:"4th & E St SW",lat:38.88412,lng:-77.01745},{trips:60,name:"3rd & G St SE",lat:38.881184,lng:-77.00183},{trips:58,name:"7th & R St NW / Shaw Library",lat:38.91272,lng:-77.022156},{trips:2,name:"9th & Upshur St NW",lat:38.9418,lng:-77.0251},{trips:45,name:"1st & Rhode Island Ave NW",lat:38.915417,lng:-77.01229},{trips:9,name:"Columbia Rd & Georgia Ave NW",lat:38.928158,lng:-77.02344},{trips:112,name:"California St & Florida Ave NW",lat:38.917763,lng:-77.04062},{trips:0,name:"Benning Rd & East Capitol St NE / Benning Rd Metro",lat:38.889935,lng:-76.93723},{trips:152,name:"3000 Connecticut Ave NW / National Zoo",lat:38.930283,lng:-77.055595},{trips:2,name:"Anacostia Ave & Benning Rd NE / River Terrace ",lat:38.896545,lng:-76.96012},{trips:1158,name:"M St & Pennsylvania Ave NW",lat:38.905125,lng:-77.056885},{trips:92,name:"15th St & Massachusetts Ave SE",lat:38.88732,lng:-76.98357},{trips:0,name:"Congress Heights Metro",lat:38.84471,lng:-76.98782},{trips:12,name:"N Quincy St & Glebe Rd",lat:38.876392,lng:-77.107735},{trips:30,name:"Wilson Blvd & N Oakland St",lat:38.8815,lng:-77.10396},{trips:52,name:"N Veitch  & 20th St N",lat:38.896923,lng:-77.0865},{trips:553,name:"10th & K St NW",lat:38.9024,lng:-77.02622},{trips:20,name:"Fairfax Dr & Wilson Blvd",lat:38.8858,lng:-77.09775},{trips:58,name:"Key Blvd & N Quinn St",lat:38.896015,lng:-77.07811},{trips:225,name:"1st & K St SE",lat:38.87861,lng:-77.006004},{trips:57,name:"39th & Calvert St NW / Stoddert",lat:38.92265,lng:-77.07727},{trips:1,name:"1st & Washington Hospital Center NW",lat:38.92874,lng:-77.01246},{trips:39,name:"Virginia Square Metro / N Monroe St & 9th St N",lat:38.88279,lng:-77.10315},{trips:64,name:"Central Library / N Quincy St & 10th St N",lat:38.88397,lng:-77.10783},{trips:43,name:"Washington Blvd & 10th St N",lat:38.884735,lng:-77.09348},{trips:15283,name:"Jefferson Dr & 14th St SW",lat:38.888554,lng:-77.03243},{trips:7802,name:"Smithsonian / Jefferson Dr & 12th St SW",lat:38.888767,lng:-77.02858},{trips:16,name:"George Mason Dr & Wilson Blvd",lat:38.87887,lng:-77.1207},{trips:958,name:"6th St & Indiana Ave NW",lat:38.894573,lng:-77.01994},{trips:34,name:"N Veitch & Key Blvd",lat:38.89324,lng:-77.086044},{trips:26,name:"N Adams St & Lee Hwy",lat:38.89593,lng:-77.089005},{trips:320,name:"15th & N Scott St",lat:38.89054,lng:-77.08095},{trips:21,name:"Washington Blvd & 7th St N",lat:38.880833,lng:-77.091125},{trips:55,name:"Ballston Metro / N Stuart & 9th St N",lat:38.881042,lng:-77.11177},{trips:102,name:"N Randolph St & Fairfax Dr",lat:38.88263,lng:-77.10937},{trips:11818,name:"Jefferson Memorial",lat:38.879818,lng:-77.037415},{trips:2,name:"Good Hope Rd & 14th St SE",lat:38.86661,lng:-76.98524},{trips:11,name:"Glebe Rd & 11th St N",lat:38.883923,lng:-77.11681},{trips:219,name:"N Quincy St & Wilson Blvd",lat:38.88015,lng:-77.10767},{trips:18,name:"Fairfax Dr & Kenmore St",lat:38.884617,lng:-77.10108},{trips:34,name:"Gallaudet / 8th St & Florida Ave NE",lat:38.90509,lng:-76.9941},{trips:271,name:"20th & L St NW",lat:38.903584,lng:-77.04479},{trips:166,name:"12th & L St NW",lat:38.90382,lng:-77.0284},{trips:335,name:"21st St & Pennsylvania Ave NW",lat:38.90154,lng:-77.04656},{trips:178,name:"19th & K St NW",lat:38.902203,lng:-77.04337},{trips:114,name:"Prince St & Union St",lat:38.803123,lng:-77.04036},{trips:67,name:"Market Square / King St & Royal St",lat:38.804718,lng:-77.043365},{trips:54,name:"Saint Asaph St & Pendleton  St",lat:38.81074,lng:-77.04466},{trips:7,name:"King St & Patrick St",lat:38.805317,lng:-77.04988},{trips:545,name:"15th & K St NW",lat:38.902,lng:-77.03353},{trips:11,name:"Commerce St & Fayette St",lat:38.80565,lng:-77.05293},{trips:4,name:"Henry St & Pendleton St",lat:38.811455,lng:-77.05028},{trips:17,name:"Braddock Rd Metro",lat:38.814575,lng:-77.05281},{trips:29,name:"King St Metro",lat:38.805767,lng:-77.06072},{trips:449,name:"24th & N St NW",lat:38.9066,lng:-77.05152},{trips:948,name:"10th & E St NW",lat:38.895912,lng:-77.02606},{trips:1293,name:"22nd & I St NW / Foggy Bottom",lat:38.90088,lng:-77.04891},{trips:21,name:"Utah St & 11th St N ",lat:38.88367,lng:-77.11391},{trips:68,name:"Barton St & 10th St N",lat:38.88496,lng:-77.08777},{trips:236,name:"Arlington Blvd & N Queen St",lat:38.889366,lng:-77.07729},{trips:11988,name:"Lincoln Memorial",lat:38.888252,lng:-77.04942},{trips:255,name:"20th St & Virginia Ave NW",lat:38.894722,lng:-77.04513},{trips:313,name:"5th St & Massachusetts Ave NW",lat:38.90093,lng:-77.01868},{trips:6,name:"39th & Veazey St NW",lat:38.943836,lng:-77.07708},{trips:4,name:"Fessenden St & Wisconsin Ave NW",lat:38.95481,lng:-77.08243},{trips:94,name:"M St & Delaware Ave NE",lat:38.90571,lng:-77.003044},{trips:218,name:"Columbia Pike & S Courthouse Rd",lat:38.863834,lng:-77.08032},{trips:2,name:"Walter Reed Community Center / Walter Reed Dr & 16th St S",lat:38.857803,lng:-77.08673},{trips:27,name:"28th St S & S Meade St",lat:38.846222,lng:-77.069275},{trips:145,name:"18th St & Wyoming Ave NW",lat:38.918808,lng:-77.04157},{trips:0,name:"5th & Kennedy St NW",lat:38.956596,lng:-77.01981},{trips:0,name:"Georgia Ave & Emerson St NW",lat:38.94966,lng:-77.027336},{trips:34,name:"14th & Upshur St NW",lat:38.942017,lng:-77.03265},{trips:4,name:"14th St & Colorado Ave NW",lat:38.956432,lng:-77.03294},{trips:17,name:"S Troy St & 26th St S",lat:38.847977,lng:-77.0751},{trips:21,name:"S Four Mile Run Dr & S Shirlington Rd",lat:38.8444,lng:-77.08593},{trips:8,name:"S Oakland St & Columbia Pike",lat:38.86079,lng:-77.09586},{trips:2,name:"S Four Mile Run & Walter Reed Dr",lat:38.84736,lng:-77.09543},{trips:62,name:"S Arlington Mill Dr & Campbell Ave",lat:38.84232,lng:-77.089554},{trips:1,name:"S Kenmore & 24th St S",lat:38.848454,lng:-77.084915},{trips:0,name:"13th St & Eastern Ave",lat:38.987,lng:-77.02942},{trips:426,name:"Wisconsin Ave & O St NW",lat:38.90849,lng:-77.06358},{trips:2,name:"S George Mason Dr & 13th St S",lat:38.85469,lng:-77.100555},{trips:6,name:"Connecticut & Nebraska Ave NW",lat:38.955017,lng:-77.069954},{trips:222,name:"17th St & Massachusetts Ave NW",lat:38.908142,lng:-77.03836},{trips:57,name:"15th & Euclid St  NW",lat:38.92333,lng:-77.0352},{trips:295,name:"8th & East Capitol St NE",lat:38.889988,lng:-76.99519},{trips:34,name:"New Jersey Ave & R St NW",lat:38.91266,lng:-77.01767},{trips:78,name:"15th & East Capitol St NE",lat:38.889908,lng:-76.98333},{trips:99,name:"8th & F St NE",lat:38.897274,lng:-76.99475},{trips:0,name:"18th St & Rhode Island Ave NE",lat:38.927094,lng:-76.97893},{trips:17,name:"15th & F St NE",lat:38.897194,lng:-76.983574},{trips:1,name:"12th & Irving St NE",lat:38.928642,lng:-76.99095},{trips:0,name:"34th St & Minnesota Ave SE",lat:38.884087,lng:-76.95746},{trips:0,name:"Alabama & MLK Ave SE",lat:38.843224,lng:-76.99939},{trips:0,name:"Pleasant St & MLK Ave SE",lat:38.863895,lng:-76.990036},{trips:18,name:"Neal St & Trinidad Ave NE",lat:38.903732,lng:-76.98721},{trips:112,name:"12th & U St NW",lat:38.916786,lng:-77.02814},{trips:3,name:"S George Mason Dr & Four Mile Run",lat:38.85225,lng:-77.10502},{trips:1,name:"S Stafford & 34th St S",lat:38.834106,lng:-77.087326},{trips:74,name:"N Pershing Dr & Wayne St",lat:38.880707,lng:-77.08596},{trips:448,name:"Columbia Pike & S Orme St",lat:38.867264,lng:-77.07231},{trips:645,name:"3rd St & Pennsylvania Ave SE",lat:38.88738,lng:-77.00195},{trips:1104,name:"8th & D St NW",lat:38.89485,lng:-77.02324},{trips:28,name:"3rd & Elm St NW",lat:38.91762,lng:-77.01597},{trips:10,name:"Rhode Island Ave & V St NE",lat:38.918156,lng:-77.004745},{trips:2134,name:"Constitution Ave & 2nd St NW/DOL",lat:38.892277,lng:-77.013916},{trips:1810,name:"Washington & Independence Ave SW/HHS",lat:38.88731,lng:-77.01397},{trips:672,name:"Independence Ave & L'Enfant Plaza SW/DOE",lat:38.887314,lng:-77.025764},{trips:1,name:"Hamlin & 7th St NE",lat:38.927498,lng:-76.99719},{trips:56,name:"Columbia Pike & S Walter Reed Dr",lat:38.862476,lng:-77.0866},{trips:1,name:"Columbia Pike & S Dinwiddie St / Arlington Mill Community Center",lat:38.85632,lng:-77.11153},{trips:9,name:"Pershing & N George Mason Dr",lat:38.871822,lng:-77.1079},{trips:0,name:"Fenton St & New York Ave ",lat:38.985405,lng:-77.02308},{trips:15,name:"Bethesda Ave & Arlington Rd",lat:38.981102,lng:-77.09743},{trips:6,name:"Montgomery Ave & Waverly St ",lat:38.983837,lng:-77.09221},{trips:0,name:"Fallsgrove Blvd & Fallsgrove Dr",lat:39.096313,lng:-77.19267},{trips:0,name:"Traville Gateway Dr & Gudelsky Dr",lat:39.093784,lng:-77.2025},{trips:0,name:"Norfolk Ave & Fairmont St",lat:38.988564,lng:-77.09654},{trips:0,name:"E Montgomery Ave & Maryland Ave",lat:39.084126,lng:-77.15129},{trips:3,name:"Cordell & Norfolk Ave",lat:38.98954,lng:-77.09803},{trips:0,name:"Frederick Ave & Horners Ln",lat:39.094772,lng:-77.14521},{trips:0,name:"Philadelphia & Maple Ave",lat:38.98128,lng:-77.01134},{trips:0,name:"Maple & Ritchie Ave",lat:38.983627,lng:-77.00631},{trips:0,name:"Silver Spring Metro/Colesville Rd & Wayne Ave",lat:38.99521,lng:-77.02918},{trips:14,name:"Montgomery & East Ln",lat:38.983524,lng:-77.09537},{trips:7,name:"Friendship Hts Metro/Wisconsin Ave & Wisconsin Cir",lat:38.96176,lng:-77.086},{trips:83,name:"14th & Belmont St NW",lat:38.921074,lng:-77.03188},{trips:77,name:"3rd & Tingey St SE",lat:38.87501,lng:-77.0024},{trips:7,name:"10th & Florida Ave NW",lat:38.920387,lng:-77.02567},{trips:7,name:"Potomac Ave & 8th St SE",lat:38.876736,lng:-76.99447},{trips:0,name:"Crabbs Branch Way & Redland Rd",lat:39.120045,lng:-77.15698},{trips:0,name:"Fallsgrove Dr & W Montgomery Ave",lat:39.099377,lng:-77.18801},{trips:0,name:"Monroe St & Monroe Pl",lat:39.08278,lng:-77.14883},{trips:0,name:"Needwood Rd & Eagles Head Ct",lat:39.123512,lng:-77.15741},{trips:0,name:"East West Hwy & Blair Mill Rd",lat:38.99025,lng:-77.02935},{trips:0,name:"Crabbs Branch Way & Calhoun Pl",lat:39.107708,lng:-77.15207},{trips:10,name:"47th & Elm St",lat:38.982456,lng:-77.09199},{trips:0,name:"Garland Ave & Walden Rd",lat:39.00058,lng:-77.00149},{trips:0,name:"Montgomery College/W Campus Dr & Mannakee St",lat:39.09566,lng:-77.15905},{trips:0,name:"Fenton St & Gist Ave",lat:38.989723,lng:-77.02386},{trips:2,name:"Carroll & Westmoreland Ave",lat:38.975,lng:-77.01121},{trips:1,name:"Carroll & Ethan Allen Ave",lat:38.977932,lng:-77.00647},{trips:4,name:"Battery Ln & Trolley Trail",lat:38.992374,lng:-77.100105},{trips:0,name:"Norfolk & Rugby Ave",lat:38.99064,lng:-77.10024},{trips:5,name:"Offutt Ln & Chevy Chase Dr",lat:38.977093,lng:-77.09459},{trips:0,name:"Broschart & Blackwell Rd",lat:39.1021,lng:-77.200325},{trips:0,name:"Taft St & E Gude Dr",lat:39.094105,lng:-77.13296},{trips:0,name:"Fleet St & Ritchie Pkwy",lat:39.076332,lng:-77.14138},{trips:0,name:"Piccard & W Gude Dr",lat:39.10221,lng:-77.17709},{trips:0,name:"Ripley & Bonifant St",lat:38.99268,lng:-77.02946},{trips:0,name:"Georgia Ave & Spring St",lat:38.99939,lng:-77.031555},{trips:0,name:"Fenton St & Ellsworth Dr ",lat:38.997032,lng:-77.025604},{trips:0,name:"King Farm Blvd & Pleasant Dr",lat:39.11469,lng:-77.171486},{trips:0,name:"King Farm Blvd & Piccard Dr",lat:39.110313,lng:-77.18267},{trips:391,name:"Calvert St & Woodley Pl NW",lat:38.923584,lng:-77.05005},{trips:47,name:"New Jersey Ave & N St NW/Dunbar HS",lat:38.90706,lng:-77.01523},{trips:1,name:"Nannie Helen Burroughs Ave & 49th St NE",lat:38.898537,lng:-76.93186},{trips:0,name:"Deanwood Rec Center",lat:38.908474,lng:-76.9331},{trips:377,name:"Hains Point/Buckeye & Ohio Dr SW",lat:38.878433,lng:-77.03023},{trips:10,name:"Arlington Blvd & Fillmore St",lat:38.873756,lng:-77.08923},{trips:160,name:"Long Bridge Park/Long Bridge Dr & 6th St S",lat:38.86646,lng:-77.04826},{trips:0,name:"Old Georgetown Rd & Southwick St",lat:38.999634,lng:-77.10965},{trips:1,name:"Friendship Blvd & Willard Ave",lat:38.96115,lng:-77.08866},{trips:134,name:"North Capitol St & G Pl NE",lat:38.899704,lng:-77.00891},{trips:3,name:"31st & Woodrow St S",lat:38.837666,lng:-77.09482},{trips:49,name:"Washington Blvd & Walter Reed Dr ",lat:38.87322,lng:-77.08211},{trips:81,name:"TJ Cmty Ctr / 2nd St & S Old Glebe Rd",lat:38.86942,lng:-77.0956},{trips:110,name:"Connecticut Ave & Tilden St NW",lat:38.941154,lng:-77.062035},{trips:0,name:"Medical Center Dr & Key West Ave",lat:39.103092,lng:-77.19644},{trips:0,name:"Shady Grove Hospital",lat:39.097637,lng:-77.19663},{trips:0,name:"Veterans Pl & Pershing Dr ",lat:38.997444,lng:-77.023895},{trips:0,name:"Rockville Metro East",lat:39.085396,lng:-77.145805},{trips:249,name:"1st & H St NW",lat:38.900356,lng:-77.01211},{trips:0,name:"Fort Totten Metro",lat:38.95237,lng:-77.00272},{trips:0,name:"Takoma Metro",lat:38.97522,lng:-77.01685},{trips:4,name:"Rhode Island Ave Metro",lat:38.92068,lng:-76.99587},{trips:118,name:"Rolfe St & 9th St S",lat:38.86647,lng:-77.07613},{trips:8,name:"Shirlington Transit Center / S Quincy & Randolph St",lat:38.839912,lng:-77.08708},{trips:0,name:"Shady Grove Metro West",lat:39.119766,lng:-77.16609},{trips:9,name:"River Rd & Landy Ln",lat:38.964993,lng:-77.10338},{trips:0,name:"Rockville Metro West",lat:39.084377,lng:-77.146866},{trips:11,name:"Bethesda Metro",lat:38.98469,lng:-77.094536},{trips:3482,name:"Iwo Jima Memorial/N Meade & 14th St N",lat:38.88992,lng:-77.071304},{trips:983,name:"34th & Water St NW",lat:38.903584,lng:-77.06779},{trips:10,name:"Duke St & John Carlyle St",lat:38.80438,lng:-77.06087},{trips:16,name:"Lee Hwy & N Cleveland St",lat:38.89494,lng:-77.09169},{trips:5,name:"Arlington Blvd & S George Mason Dr/NFATC",lat:38.869442,lng:-77.1045},{trips:421,name:"MLK Library/9th & G St NW",lat:38.898403,lng:-77.024284},{trips:90,name:"Lee Hwy & N Scott St",lat:38.897614,lng:-77.08085},{trips:624,name:"New Hampshire Ave & 24th St NW",lat:38.901756,lng:-77.05109},{trips:6,name:"Eisenhower Ave & Mill Race Ln",lat:38.80111,lng:-77.068954},{trips:19,name:"Potomac Greens Dr & Slaters Ln",lat:38.82175,lng:-77.04749},{trips:11,name:"Ballenger Ave & Dulaney St",lat:38.802677,lng:-77.06356},{trips:1,name:"Mount Vernon Ave & E Nelson Ave",lat:38.820065,lng:-77.05762},{trips:10,name:"Mount Vernon Ave & E Del Ray Ave",lat:38.82595,lng:-77.05854},{trips:10,name:"Monroe Ave & Leslie Ave",lat:38.82093,lng:-77.05309},{trips:9,name:"Mount Vernon Ave & Kennedy St",lat:38.833076,lng:-77.05982},{trips:215,name:"Court House Metro / 15th & N Uhle St ",lat:38.890614,lng:-77.0848},{trips:0,name:"Washington Adventist U / Flower Ave & Division St",lat:38.986744,lng:-77.00004},{trips:23,name:"6th & S Ball St",lat:38.8647,lng:-77.048676},{trips:0,name:"McKinley St & Connecticut Ave NW",lat:38.96497,lng:-77.07594},{trips:508,name:"15th & L St NW",lat:38.90366,lng:-77.03484},{trips:3288,name:"17th & G St NW",lat:38.89841,lng:-77.03963},{trips:2,name:"Spring St & Second Ave",lat:38.997654,lng:-77.0345},{trips:143,name:"18th & R St NW",lat:38.912647,lng:-77.04183},{trips:197,name:"S Joyce & 16th St S",lat:38.859253,lng:-77.06328},{trips:24,name:"Union Market/6th St & Neal Pl NE",lat:38.90801,lng:-76.99699},{trips:12,name:"N Nelson St & Lee Hwy",lat:38.895927,lng:-77.10525},{trips:22,name:"21st St N & N Pierce St",lat:38.898983,lng:-77.078316},{trips:9,name:"Lee Hwy & N Kirkwood Rd",lat:38.89538,lng:-77.09713},{trips:267,name:"19th & G St NW",lat:38.89841,lng:-77.04318},{trips:67,name:"Army Navy Dr & S Nash St",lat:38.86247,lng:-77.068245},{trips:52,name:"11th & S St NW",lat:38.91376,lng:-77.02702},{trips:9,name:"S Walter Reed Dr & 8th St S",lat:38.86612,lng:-77.08787},{trips:64,name:"2nd & G St NE",lat:38.89967,lng:-77.00367},{trips:48,name:"8th & O St NW",lat:38.90864,lng:-77.02277},{trips:0,name:"Georgia & Missouri Ave NW",lat:38.961338,lng:-77.027855},{trips:2,name:"Oklahoma Ave & D St NE",lat:38.894474,lng:-76.97483},{trips:6,name:"Maryland Ave & E St NE",lat:38.896133,lng:-76.9929},{trips:0,name:"New York Ave & Hecht Ave NE",lat:38.915604,lng:-76.98368}];

function WashingtonMonument(lat, lng) {
  var obeliskGeometry = new THREE.Geometry();
  var height = 169.29;  // height in meters
  var pyramidBase = 0.9*height;
  var pyramidHalfWidth = 0.03*height;
  var bottomHalfWidth = 0.05*height;
  // Define each vertex:
  // The bottom plane:
  obeliskGeometry.vertices.push(new THREE.Vector3( bottomHalfWidth,            0,  bottomHalfWidth));
  obeliskGeometry.vertices.push(new THREE.Vector3( bottomHalfWidth,            0, -bottomHalfWidth));
  obeliskGeometry.vertices.push(new THREE.Vector3(-bottomHalfWidth,            0, -bottomHalfWidth));
  obeliskGeometry.vertices.push(new THREE.Vector3(-bottomHalfWidth,            0,  bottomHalfWidth));
  // Base of the pyramid:
  obeliskGeometry.vertices.push(new THREE.Vector3( pyramidHalfWidth, pyramidBase,  pyramidHalfWidth));
  obeliskGeometry.vertices.push(new THREE.Vector3( pyramidHalfWidth, pyramidBase, -pyramidHalfWidth));
  obeliskGeometry.vertices.push(new THREE.Vector3(-pyramidHalfWidth, pyramidBase, -pyramidHalfWidth));
  obeliskGeometry.vertices.push(new THREE.Vector3(-pyramidHalfWidth, pyramidBase,  pyramidHalfWidth));
  // The tippy-top:
  obeliskGeometry.vertices.push(new THREE.Vector3(0, height, 0));
  // Create the faces:
  // Floor:
  obeliskGeometry.faces.push(new THREE.Face3(0, 2, 1), new THREE.Face3(0, 3, 2));
  // The four main sides (each side is two triangles):
  obeliskGeometry.faces.push(new THREE.Face3(0, 1, 5), new THREE.Face3(0, 5, 4));
  obeliskGeometry.faces.push(new THREE.Face3(1, 2, 6), new THREE.Face3(1, 6, 5));
  obeliskGeometry.faces.push(new THREE.Face3(2, 3, 7), new THREE.Face3(2, 7, 6));
  obeliskGeometry.faces.push(new THREE.Face3(3, 0, 4), new THREE.Face3(3, 4, 7));
  // Four sides of the pyramid:
  obeliskGeometry.faces.push(new THREE.Face3(4, 5, 8));
  obeliskGeometry.faces.push(new THREE.Face3(6, 7, 8));
  obeliskGeometry.faces.push(new THREE.Face3(5, 6, 8));
  obeliskGeometry.faces.push(new THREE.Face3(7, 4, 8));
  obeliskGeometry.computeFaceNormals();  // required to show directional light
  var obelisk = new THREE.Mesh(obeliskGeometry, new THREE.MeshLambertMaterial({vertexColors: THREE.VertexColors}));
  obelisk.scale.x = obelisk.scale.y = obelisk.scale.z = globalScale;
  obelisk.position.set(lngToX(lng), 0, latToZ(lat));
  obelisk.updateMatrix();
  return obelisk;
  }

function WhiteHouse(lat, lng) {
  var geometry = new THREE.Geometry();
  box = makeBox(51, 13.5, 26,  0.0);  geometry.merge(box.geometry, box.matrix);  // main building
  box = makeBox(31,  1.0,  6, 13.5);  geometry.merge(box.geometry, box.matrix);  // sun roof
  box = makeBox(14,  1.0, 13, 0);
  box.position.set(0, 11.5, 19.5);
  box.updateMatrix();
  geometry.merge(box.geometry, box.matrix);  // north portico
  var box = makeCylinder(9, 9, 1, 28, 11.5);
  box.position.set(0, 12, -13);
  box.updateMatrix();
  geometry.merge(box.geometry, box.matrix);  // south balcony roof
  var box = makeCylinder(9, 9, 3.5, 28, 0);
  box.position.set(0, 1.75, -13);
  box.updateMatrix();
  geometry.merge(box.geometry, box.matrix);  // south balcony base
  var cylgeo = new THREE.CylinderGeometry(0.25, 0.25, 8, 8);  // radiusTop, radiusBottom, height, segments
  var column = new THREE.Mesh(cylgeo);
  for (var i = 0; i < 8; i++) {  // south balcony columns
    column.position.set(8.75*Math.cos(Math.PI*i/7), 7.5, -8.75*Math.sin(Math.PI*i/7) - 13);
    column.updateMatrix();
    geometry.merge(column.geometry, column.matrix);
    }
  var cylgeo = new THREE.CylinderGeometry(0.5, 0.5, 11, 8);  // radiusTop, radiusBottom, height, segments
  var column = new THREE.Mesh(cylgeo);
  column.position.set(-6.5, 5.5, 21.5);  column.updateMatrix();  geometry.merge(column.geometry, column.matrix);
  column.position.set(-6.5, 5.5, 18.5);  column.updateMatrix();  geometry.merge(column.geometry, column.matrix);
  column.position.set(-6.5, 5.5, 25.5);  column.updateMatrix();  geometry.merge(column.geometry, column.matrix);
  column.position.set(-2.2, 5.5, 25.5);  column.updateMatrix();  geometry.merge(column.geometry, column.matrix);
  column.position.set( 2.2, 5.5, 25.5);  column.updateMatrix();  geometry.merge(column.geometry, column.matrix);
  column.position.set( 6.5, 5.5, 25.5);  column.updateMatrix();  geometry.merge(column.geometry, column.matrix);
  column.position.set( 6.5, 5.5, 21.5);  column.updateMatrix();  geometry.merge(column.geometry, column.matrix);
  column.position.set( 6.5, 5.5, 18.5);  column.updateMatrix();  geometry.merge(column.geometry, column.matrix);
  var whitehouse = new THREE.Mesh(geometry, new THREE.MeshLambertMaterial({color: 0xffeeff}));
  whitehouse.scale.x = whitehouse.scale.y = whitehouse.scale.z = globalScale;
  whitehouse.position.x = lngToX(lng);
  whitehouse.position.z = latToZ(lat);
  whitehouse.updateMatrix();
  return whitehouse;
  }

function makeRoundObject(pattern, segments, lat, lng) {
  // build an object that has rotational symmetry around the Y axis; similar to a lathe
  // pattern:  array of {x, y} points defining the shapes's cutaway silhouette in the 1st quadrant of the X-Y Plane
  //           closure is not automatic; repeat the first point at the end in order to make a closed object
  // segments: how many times to create vertexes, rotating around the Y axis
  // lat, lng: where to place the center of the object on the X-Z place
  var geometry = new THREE.Geometry();
  var maxHeight = pattern[0].y;
  for (var j = 1; j < pattern.length; j++) {
    maxHeight = Math.max(maxHeight, pattern[j].y);
    }
  for (var i = 0; i < segments; i++) {  // each segment
    var theta = 2*Math.PI*i/segments;
    for (var j = 0; j < pattern.length; j++) {  // each point for this segment
      geometry.vertices.push(new THREE.Vector3(pattern[j].x*Math.sin(theta),  pattern[j].y, pattern[j].x*Math.cos(theta)));
      }
    }
  for (var i = 0; i < segments; i++) {  // each segment
    var a = pattern.length*i;
    var b = pattern.length*((i + 1) % segments);
    for (var j = 0; j < pattern.length - 1; j++) {  // each face for this and the next segment
      var k = j + 1
      geometry.faces.push(new THREE.Face3(a + j, b + k, a + k), new THREE.Face3(a + j, b + j, b + k));
      }
    }
  geometry.computeFaceNormals();  // required to show directional light
  var object = new THREE.Mesh(geometry, new THREE.MeshLambertMaterial({vertexColors: THREE.VertexColors}));
  object.scale.x = object.scale.y = object.scale.z = globalScale;
  //object.position.set(lngToX(lng), maxHeight/2 + floor, latToZ(lat));
  object.position.set(lngToX(lng), 0, latToZ(lat));
  object.updateMatrix();
  return object;
  }

function makeCylinder(radiusTop, radiusBottom, height, segments, floor) {
  var geometry = new THREE.CylinderGeometry(radiusTop, radiusBottom, height, segments);
  var cylinder = new THREE.Mesh(geometry);
  cylinder.position.y = height/2 + floor;
  cylinder.updateMatrix();
  return cylinder;
  }

function makeBox(depth, height, width, floor) {
  var box = new THREE.CubeGeometry(depth, height, width);
  var mesh = new THREE.Mesh(box);
  mesh.position.y = height/2 + floor;
  mesh.updateMatrix();
  return mesh;
  }

function makeCube(depth, height, width, dx, dz) {
  var box = new THREE.CubeGeometry(depth, height, width);
  var mesh = new THREE.Mesh(box);
  mesh.position.set(dx, height/2, dz);
  mesh.updateMatrix();
  return mesh;
  }

function makeTruncatedPyramid(lowerWidth, lowerDepth, upperWidth, upperDepth, height, dx, dy, dz) {
  var geometry = new THREE.Geometry();
  geometry.vertices.push(new THREE.Vector3( lowerWidth/2,      0,  lowerDepth/2));
  geometry.vertices.push(new THREE.Vector3(-lowerWidth/2,      0,  lowerDepth/2));
  geometry.vertices.push(new THREE.Vector3(-lowerWidth/2,      0, -lowerDepth/2));
  geometry.vertices.push(new THREE.Vector3( lowerWidth/2,      0, -lowerDepth/2));
  geometry.vertices.push(new THREE.Vector3( upperWidth/2, height,  upperDepth/2));
  geometry.vertices.push(new THREE.Vector3(-upperWidth/2, height,  upperDepth/2));
  geometry.vertices.push(new THREE.Vector3(-upperWidth/2, height, -upperDepth/2));
  geometry.vertices.push(new THREE.Vector3( upperWidth/2, height, -upperDepth/2));
  console.log("AAA")
  geometry.faces.push(new THREE.Face3(0, 4, 5), new THREE.Face3(0, 5, 1));
  geometry.faces.push(new THREE.Face3(1, 5, 6), new THREE.Face3(1, 6, 2));
  geometry.faces.push(new THREE.Face3(2, 6, 7), new THREE.Face3(2, 7, 3));
  geometry.faces.push(new THREE.Face3(3, 7, 4), new THREE.Face3(3, 4, 0));
  geometry.faces.push(new THREE.Face3(4, 7, 6), new THREE.Face3(4, 6, 5));  // roof
  geometry.computeFaceNormals();  // required to show directional light
  var pyramid = new THREE.Mesh(geometry);
  pyramid.position.set(dx, dy, dz);
  pyramid.updateMatrix();
  return pyramid;
  }

function AlexandriaLodge(lat, lng) {
  var geometry = new THREE.Geometry();
  box = makeBox(68,  1.0, 78,  0.0);      geometry.merge(box.geometry, box.matrix);  // basement level
  box = makeBox(50, 18.9, 60,  0.0);      geometry.merge(box.geometry, box.matrix);  // main structure
  box = makeBox(22, 27.5, 34,  0.0);      geometry.merge(box.geometry, box.matrix);  // 2nd segment
  box = makeBox(16, 46.5, 22,  0.0);      geometry.merge(box.geometry, box.matrix);  // 3rd segment
  box = makeBox(14, 63.8, 18,  0.0);      geometry.merge(box.geometry, box.matrix);  //
  box = makeBox(10, 79.2, 14,  0.0);      geometry.merge(box.geometry, box.matrix);  //
  box = makeBox( 8, 86.0, 10,  0.0);      geometry.merge(box.geometry, box.matrix);  //
  box = makeCube(18, 22.6, 15, 0, 24.5);  geometry.merge(box.geometry, box.matrix);  // front extrusion
  for (var i = 0; i < 10; i++) {
    box = makeBox(7 - i*0.5, 87.4 + 1.4*i, 9 - i*0.5,  0.0);  geometry.merge(box.geometry, box.matrix);  // pyramidal top
    }
  var lodge = new THREE.Mesh(geometry, new THREE.MeshLambertMaterial({color: 0xffeeff}));
  lodge.scale.x = lodge.scale.y = lodge.scale.z = globalScale;
  lodge.rotation.y = -Math.PI*0.55555555555;
  lodge.position.x = lngToX(lng);
  lodge.position.z = latToZ(lat);
  lodge.updateMatrix();
  return lodge;
  }

function DupontFountain(lat, lng) {
  var geometry = new THREE.Geometry();
  var cyl = makeCylinder(28.9, 28.9, 0.3, 48, 0.0);  geometry.merge(cyl.geometry, cyl.matrix);  // lowest base
  var cyl = makeCylinder(20.2, 20.2, 2.3, 36, 0.0);  geometry.merge(cyl.geometry, cyl.matrix);  // walkable circumference
  var cyl = makeCylinder(15.4, 15.4, 3.4, 24, 0.0);  geometry.merge(cyl.geometry, cyl.matrix);  // pool container
  var cyl = makeCylinder( 3.5,  3.5, 4.1, 24, 0.0);  geometry.merge(cyl.geometry, cyl.matrix);  // pedestal base
  var cyl = makeCylinder( 2.2,  3.5, 0.3, 24, 4.1);  geometry.merge(cyl.geometry, cyl.matrix);  // pedestal base's bevel
  var cyl = makeCylinder( 2.2,  2.2, 9.0, 24, 0.0);  geometry.merge(cyl.geometry, cyl.matrix);  // pedestal column
  var cyl = makeCylinder( 5.3,  2.3, 1.4, 24, 9.0);  geometry.merge(cyl.geometry, cyl.matrix);  // upper bowl
  var fountain = new THREE.Mesh(geometry, new THREE.MeshLambertMaterial({color: 0xffeeff}));
  fountain.scale.x = fountain.scale.y = fountain.scale.z = globalScale;
  fountain.position.x = lngToX(lng);
  fountain.position.z = latToZ(lat);
  fountain.updateMatrix();
  return fountain;
  }

function RFKStadium(lat, lng) {
  var stadium = [{x: 104, y:  0.0},  // exterior foot
                 {x: 104, y: 22.5},  // top of lower wall
                 {x:  96, y: 22.5},  // setback
                 {x:  96, y: 33.8},  // top of upper wall
                 {x:  83, y: 40.0},  // tip of canopy
                 {x:  95, y: 33.8},  // top of upper seating area
                 {x:  74, y: 22.5},  // bottom of upper seating area
                 {x:  86, y: 16.3},  // top of lower seating area
                 {x:  55, y:  0.0}]  // bottom of lower seating area
  return makeRoundObject(stadium, 32, lat, lng);
  }

function Pentagon(lat, lng) {
  var geometry = new THREE.Geometry();
  for (var i = 0; i < 5; i++) {  // each of five segments
    var theta = 2*Math.PI*i/5;
    geometry.vertices.push(new THREE.Vector3( 90*Math.sin(theta),  0,  90*Math.cos(theta)));
    geometry.vertices.push(new THREE.Vector3( 90*Math.sin(theta), 23,  90*Math.cos(theta)));
    geometry.vertices.push(new THREE.Vector3(240*Math.sin(theta), 23, 240*Math.cos(theta)));
    geometry.vertices.push(new THREE.Vector3(240*Math.sin(theta),  0, 240*Math.cos(theta)));
    }
  for (var i = 0; i < 5; i++) {
    var a = 4*i;
    var b = 4*((i + 1) % 5);
    geometry.faces.push(new THREE.Face3(    a, a + 1, b + 1), new THREE.Face3(    a, b + 1,     b));  // inner wall
    geometry.faces.push(new THREE.Face3(a + 1, a + 2, b + 2), new THREE.Face3(a + 1, b + 2, b + 1));  // roof
    geometry.faces.push(new THREE.Face3(a + 2, a + 3, b + 3), new THREE.Face3(a + 2, b + 3, b + 2));  // outer wall
    }
  geometry.computeFaceNormals();  // required to show directional light
  var pentagon = new THREE.Mesh(geometry, new THREE.MeshLambertMaterial({vertexColors: THREE.VertexColors}));
  pentagon.scale.x = pentagon.scale.y = pentagon.scale.z = globalScale;
  pentagon.position.set(lngToX(lng), 0, latToZ(lat));
  pentagon.updateMatrix();
  return pentagon;
  }

function JeffersonMemorial(lat, lng) {
  var geometry = new THREE.Geometry();
  var cyl = makeCylinder(25.5, 25.5, 0.9, 48,  0.0);  geometry.merge(cyl.geometry, cyl.matrix);  // lowest base
  var cyl = makeCylinder(24.0, 24.0, 1.8, 36,  0.0);  geometry.merge(cyl.geometry, cyl.matrix);  // 1st step up
  var cyl = makeCylinder(22.5, 22.5, 2.7, 24,  0.0);  geometry.merge(cyl.geometry, cyl.matrix);  // 2nd step up
  var cyl = makeCylinder(22.5, 22.5, 4.7, 24, 15.7);  geometry.merge(cyl.geometry, cyl.matrix);  // roof over columns
  var cyl = makeCylinder(18.0, 18.0, 3.3, 24, 20.4);  geometry.merge(cyl.geometry, cyl.matrix);  // lower base of the dome
  var cyl = makeCylinder(15.4, 15.4, 2.4, 24, 23.7);  geometry.merge(cyl.geometry, cyl.matrix);  // upper base of the dome
  var spheregeo = new THREE.SphereGeometry(14, 12, 9, 0, 2*Math.PI, 0, Math.PI/2);
  var dome = new THREE.Mesh(spheregeo);
  dome.position.y = 24;
  dome.scale.y = 0.67;
  dome.updateMatrix();
  geometry.merge(dome.geometry, dome.matrix);
  var cylgeo = new THREE.CylinderGeometry(0.9, 0.9, 13, 24);  // radiusTop, radiusBottom, height, segments
  var column = new THREE.Mesh(cylgeo);
  for (var i = 0; i < 36; i++) {  // 36 columns
    var distFromXAxis = sign(           i - 17.5)*Math.min(3.5, 9 - Math.abs(      i % 18 - 8.5));
    var distFromZAxis = sign((i + 9) % 36 - 17.5)*Math.min(5.5, 9 - Math.abs((i + 9) % 18 - 8.5));
    column.position.set(20.5*Math.sin(Math.PI*i/18), 9.2, 20.5*Math.cos(Math.PI*i/18));
    column.updateMatrix();
    geometry.merge(column.geometry, column.matrix);
    }
  var memorial = new THREE.Mesh(geometry, new THREE.MeshLambertMaterial({color: 0xffeeff}));
  memorial.scale.x = memorial.scale.y = memorial.scale.z = globalScale;
  memorial.position.set(lngToX(lng), 0, latToZ(lat));
  memorial.updateMatrix();
  return memorial;
  }

function LincolnMemorial(lat, lng) {
  var columnWidth = 61/23;  // about 2.65 meters
  var memorialWidth = columnWidth*23;  // 23 = 12 columns + 11 spaces
  var memorialDepth = columnWidth*15;  // 15 = 8 columns + 7 spaces
  var geometry = new THREE.Geometry();
  box = makeBox(memorialDepth - 11, 29, memorialWidth - 11,  0.0);  geometry.merge(box.geometry, box.matrix);  // interior container
  box = makeBox(memorialDepth,       4, memorialWidth,      19.0);  geometry.merge(box.geometry, box.matrix);  // roof over columns
  box = makeBox(memorialDepth,       3, memorialWidth,       0.0);  geometry.merge(box.geometry, box.matrix);  // walkable circumference
  box = makeBox(memorialDepth +  2,  2, memorialWidth +  2,  0.0);  geometry.merge(box.geometry, box.matrix);  // upper base
  box = makeBox(memorialDepth +  4,  1, memorialWidth +  4,  0.0);  geometry.merge(box.geometry, box.matrix);  // lower base
  var cylgeo = new THREE.CylinderGeometry(columnWidth/2 - 0.1, columnWidth/2 - 0.01, 16, 24);  // radiusTop, radiusBottom, height, segments
  var cylinder = new THREE.Mesh(cylgeo);
  for (var i = 0; i < 36; i++) {  // 36 columns
    var distFromXAxis = sign(           i - 17.5)*Math.min(3.5, 9 - Math.abs(      i % 18 - 8.5));
    var distFromZAxis = sign((i + 9) % 36 - 17.5)*Math.min(5.5, 9 - Math.abs((i + 9) % 18 - 8.5));
    cylinder.position.set(2*columnWidth*distFromXAxis, 11, 2*columnWidth*distFromZAxis);
    cylinder.updateMatrix();
    geometry.merge(cylinder.geometry, cylinder.matrix);
    }
  var memorial = new THREE.Mesh(geometry, new THREE.MeshLambertMaterial({color: 0xffeeff}));
  memorial.scale.x = memorial.scale.y = memorial.scale.z = globalScale;
  memorial.position.set(lngToX(lng), 0, latToZ(lat));
  memorial.updateMatrix();
  return memorial;
  }

function Capitol(lat, lng) {
  var geometry = new THREE.Geometry();
  box = makeCube(68.0, 31.0,  54.6,  7.1,   0.0); geometry.merge(box.geometry, box.matrix);  // central section
  box = makeCube(48.4, 31.0,  28.4, -5.0,  41.5); geometry.merge(box.geometry, box.matrix);  // northern midsection
  box = makeCube(48.4, 31.0,  28.4, -5.0, -41.5); geometry.merge(box.geometry, box.matrix);  // southern midsection
  box = makeCube(24.0, 31.0, 139.0, -7.0,   0.0); geometry.merge(box.geometry, box.matrix);  // central north-south axis
  box = makeCube(75.4, 31.0,  45.0,  0.0,  92.0); geometry.merge(box.geometry, box.matrix);  // Senate chamber
  box = makeCube(75.4, 31.0,  45.0,  0.0, -92.0); geometry.merge(box.geometry, box.matrix);  // House chamber
  var cyl = makeCylinder(17.5, 17.5, 46.2, 48, 0.0);  geometry.merge(cyl.geometry, cyl.matrix);  // lower base of the dome ... should be 20?
  var cyl = makeCylinder(16.0, 16.0, 56.2, 48, 0.0);  geometry.merge(cyl.geometry, cyl.matrix);  // upper base of the dome
  var cyl = makeCylinder( 2.0,  2.0, 81.2, 48, 0.0);  geometry.merge(cyl.geometry, cyl.matrix);  // tholos
  var cyl = makeCylinder( 1.0,  2.0, 86.2, 48, 0.0);  geometry.merge(cyl.geometry, cyl.matrix);  // statue on top
  var spheregeo = new THREE.SphereGeometry(15, 12, 9, 0, 2*Math.PI, 0, Math.PI/2);
  var dome = new THREE.Mesh(spheregeo);
  dome.position.y = 56.2;
  dome.scale.y = 1.3333333;
  dome.updateMatrix();
  geometry.merge(dome.geometry, dome.matrix);
  var capitol = new THREE.Mesh(geometry, new THREE.MeshLambertMaterial({color: 0xffeeff}));
  capitol.scale.x = capitol.scale.y = capitol.scale.z = globalScale;
  capitol.position.set(lngToX(lng), 0, latToZ(lat));
  capitol.updateMatrix();
  return capitol;
  }

function latToZ(lat) {
  return worldHeight*(lat - minLat)/(maxLat - minLat) - worldHeight/2;
  }

function lngToX(lng) {
  return worldWidth/2 - worldWidth*(lng - minLng)/(maxLng - minLng);
  }

function setBoundary(background, south, west, north, east, w, h) {
  minLng = west;  // left
  maxLng = east;  // right
  minLat = south;  // bottom
  maxLat = north;  // top
  swidth = w;
  sheight = h;
  }

function init() {
  setBoundary("region512.png", 38.78854, -77.27364, 39.12946, -76.83205, 640, 640);
  renderer = new THREE.WebGLRenderer({antialias: true, alpha: false});
  renderer.setClearColor(0x202040);
  renderer.setSize(window.innerWidth, window.innerHeight);
  document.body.appendChild(renderer.domElement);
  camera = new THREE.PerspectiveCamera(50, window.innerWidth/window.innerHeight, 1, 10000);
  camera.position.x = lngToX(-77.058);
  camera.position.z = latToZ(38.887);
  camera.position.y = 1.5;
  camera.up.set(0, 1, 0);
  controls = new MapControls(camera, render);
  lookingAt.point.x = lngToX(-77.035246);
  lookingAt.point.z = latToZ( 38.889376);
  camera.lookAt(lookingAt.point);
  camera.updateMatrix();
  scene = new THREE.Scene();
  scene.fog = new THREE.FogExp2(0x000000, 0.0015);  // color, density
  var directionalLight = new THREE.DirectionalLight(0xffffee, 0.5);
  directionalLight.position.set(-800, 1600, 400);
  scene.add(directionalLight);
  scene.add(new THREE.HemisphereLight(0xffffff, 0x000088, 1));  // skyColorHex, groundColorHex, intensity
  scene.add(new THREE.AmbientLight(0x334444));
  for (var i = 0; i < LincolnTraffic.length; i++) {
    var curve = new THREE.CatmullRomCurve3([
      new THREE.Vector3(lngToX(-77.049426), 0, latToZ(38.888251)),  // LincolnMemorial cabi station
      new THREE.Vector3(lngToX((LincolnTraffic[i].lng + -77.050153)/2), 10 + LincolnTraffic[i].trips/2000, latToZ((LincolnTraffic[i].lat + 38.889376)/2)),
      new THREE.Vector3(lngToX(LincolnTraffic[i].lng), 0, latToZ(LincolnTraffic[i].lat))
      ]);
    var geometry = new THREE.Geometry();
    geometry.vertices = curve.getPoints(50);
    var material = new THREE.LineBasicMaterial({color: 0xff0000});
    var splineObject = new THREE.Line(geometry, material);
    scene.add(splineObject);
    LincolnTraffic[i].label = document.createElement('div');
    LincolnTraffic[i].label.innerHTML = LincolnTraffic[i].name + ":<br>" + LincolnTraffic[i].trips + " trips";
    LincolnTraffic[i].label.className = "cabistation";
    document.body.appendChild(LincolnTraffic[i].label);
    }
  var groundGeometry = new THREE.PlaneGeometry(worldWidth, worldHeight);
  var groundMaterial = new THREE.MeshBasicMaterial({side: THREE.DoubleSide});
  var textureLoader = new THREE.TextureLoader();
  textureLoader.load('region512.png', function(texture) {
    groundMaterial.map = texture;
    ground = new THREE.Mesh(groundGeometry, groundMaterial);
    ground.rotation.x = -Math.PI/2;  // change from vertical to horizontal
    ground.rotation.z = Math.PI;  // have south end of image (the bottom) be closest to us
    scene.add(ground);
    });
  scene.add(DupontFountain(    38.909662, -77.043415));
  scene.add(WhiteHouse(        38.897681, -77.036500));
  //scene.add(makeTruncatedPyramid(11, 11, 2, 2, 4, lngToX(-77.049426), 1, latToZ(38.888251)));
  scene.add(LincolnMemorial(   38.889376, -77.050153));
  scene.add(WashingtonMonument(38.889376, -77.035246));
  scene.add(Capitol(           38.889791, -77.009108));
  scene.add(RFKStadium(        38.889825, -76.971950));
  scene.add(JeffersonMemorial( 38.881398, -77.036513));
  scene.add(Pentagon(          38.870998, -77.055964));
  scene.add(AlexandriaLodge(   38.807510, -77.065934));
  lastTime = window.performance ? performance.now() : Date.now();
  }

function checkMouse(e) {
  cursor.x = e.clientX;
  cursor.y = e.clientY;
  }

function checkKeyboard(e) {
  var key = e.which || e.keyCode;
  // console.log(key)
  if (key == 108) {  // "L" for Lincoln Memorial:
    lookingAt.point.x = lngToX(-77.050153);
    lookingAt.point.z = latToZ( 38.889376);
    }
  if (key == 119) {  // "W" for Washington Monument:
    lookingAt.point.x = lngToX(-77.035246);
    lookingAt.point.z = latToZ( 38.889376);
    }
  camera.lookAt(lookingAt.point);
  }

function sign(x) {
  return x ? x < 0 ? -1 : 1 : 0;
  }

function animate() {
  requestAnimationFrame(animate);
  controls.update();
  var time = (window.performance ? performance.now() : Date.now())/1000;
  /*
  var horSpeed = Math.floor(8*(window.innerWidth/2 - cursor.x)/window.innerWidth);  // -4 to 4
  var verSpeed = Math.floor(8*(window.innerHeight/2 - cursor.y)/window.innerHeight);  // -4 to 4
  var lookingAt = camera.getWorldDirection();
  var theta = Math.atan2(lookingAt.x, lookingAt.z);
  //camera.position.x = camera.position.x + 0.03*(horSpeed*Math.cos(theta) + verSpeed*Math.sin(theta));
  //camera.position.z = camera.position.z + 0.03*(horSpeed*Math.sin(theta) + verSpeed*Math.cos(theta));
  camera.position.x = camera.position.x + 0.03*horSpeed*Math.cos(theta);
  camera.position.z = camera.position.z + 0.03*horSpeed*Math.sin(theta);
  //camera.position.x = camera.position.x + 0.03*(horSpeed*Math.cos(theta));
  //camera.position.z = camera.position.z + 0.03*(horSpeed*Math.sin(theta));
  console.log(theta)
  camera.updateMatrix();
  camera.updateProjectionMatrix();
  */
  renderer.render(scene, camera);
  var vector = new THREE.Vector3();
  var widthHalf = 0.5*renderer.context.canvas.width;
  var heightHalf = 0.5*renderer.context.canvas.height;
  for (var i = 0; i < LincolnTraffic.length; i++) {
    vector.set(lngToX(LincolnTraffic[i].lng), 0, latToZ(LincolnTraffic[i].lat));
    vector.project(camera);
    LincolnTraffic[i].label.style.left = vector.x*widthHalf + widthHalf + "px";
    LincolnTraffic[i].label.style.bottom = vector.y*heightHalf + heightHalf + 20 + "px";
    LincolnTraffic[i].label.style.zIndex = Math.round(2048*(1 - vector.z)) + "";
    LincolnTraffic[i].label.style.visibility = vector.z >= 0 && vector.z + 0.16*Math.abs(vector.x) < 0.92 ? "visible" : "hidden";
    }
  lastTime = time;
  }

function render() {
  renderer.render(scene, camera);
  }

document.addEventListener("keypress", checkKeyboard);
init();
animate();
</script>
<div id=instructions >place cursor left/right to pan; top/bottom to dolly</div>
</body>
</html>
