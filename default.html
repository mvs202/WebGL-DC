<!DOCTYPE html>
<html>
<head>
<title>CaBi World</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<style>
body {
  background-color: #000000;
  font-family: Monospace;
  margin: 0;
  height: 100%;
  overflow: hidden;
  }
canvas {
cursor: url(cursor.png), auto;
  position: absolute;
  top: 0;
  left: 0;
  }
.cabistation {
  padding: 2px 8px;
  position: absolute;
  color: #FFFFFF;
  background-color: #FF0000;
  font-family: sans-serif;
  border-width: 2px;
  border-style: solid;
  border-radius: 8px 8px 8px 0px;
  border-color: #FFFF00;
  }
.cabistation:after {
  bottom: -16px;
  left: 0px;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
  border-color: transparent;
  border-top-color: #FFFF00;
  border-left-color: #FFFF00;
  border-width: 8px;
  margin-left: -2px;
  }
#controls {
  cursor: auto;
  position: absolute;
  padding: 0px 8px;
  left: 0px;
  top: 0px;
  color: #000000;
  background-color: rgba(255, 255, 255, 0.6);
  }
</style>
<script src="../../lib/three.js"></script>
<script src="../../lib/Projector.js"></script>
<!--
<script src="../../lib/TrackballControls.js"></script>
-->
<script src="../../lib/MapControls.js"></script>
</head>
<body>
<script>
// Mesh = Geometry + Material
var scene, camera, renderer;
var globalScale = 0.011;  // how to convert meters to pixels
var light;
var ground;
var lastTime;
var minLng, maxLng, minLat, maxLat;
var worldWidth = 400;
var worldHeight = 400;
var lookingAt = {point: new THREE.Vector3(0, 0, 0), theta: 0};
var cursor = {x: window.innerWidth/2, y: window.innerHeight/2};
var LincolnTraffic = [{trips:2,name:"8th & F St NW",id:"31232",lat:38.896866,lng:-77.02291},{trips:1,name:"11th & K St NW",id:"31263",lat:38.90268,lng:-77.02674},{trips:0,name:"S Abingdon St & 36th St S",id:"39999",lat:38.834946,lng:-77.094},{trips:0,name:"White House [17th & State Pl NW]",id:"1",lat:38.896496,lng:-77.03895},{trips:0,name:"20th & Bell St",id:"31000",lat:38.8561,lng:-77.0512},{trips:1,name:"18th & Eads St.",id:"31001",lat:38.85725,lng:-77.05332},{trips:4,name:"20th & Crystal Dr",id:"31002",lat:38.856213,lng:-77.04983},{trips:1,name:"15th & Crystal Dr",id:"31003",lat:38.86017,lng:-77.04959},{trips:0,name:"Aurora Hills Community Ctr/18th & Hayes St",id:"31004",lat:38.857864,lng:-77.05949},{trips:3,name:"Pentagon City Metro / 12th & S Hayes St",id:"31005",lat:38.862305,lng:-77.05994},{trips:9,name:"S Joyce & Army Navy Dr",id:"31006",lat:38.8637,lng:-77.0633},{trips:1,name:"Crystal City Metro / 18th & Bell St",id:"31007",lat:38.857063,lng:-77.05114},{trips:1,name:"12th & Army Navy Dr",id:"31008",lat:38.8629,lng:-77.0528},{trips:0,name:"27th & Crystal Dr",id:"31009",lat:38.848442,lng:-77.05151},{trips:3,name:"S Glebe & Potomac Ave",id:"31010",lat:38.8426,lng:-77.0502},{trips:2,name:"23rd & Crystal Dr",id:"31011",lat:38.8533,lng:-77.0498},{trips:0,name:"26th & S Clark St",id:"31012",lat:38.85069,lng:-77.05152},{trips:4,name:"19th St & Pennsylvania Ave NW",id:"31100",lat:38.9003,lng:-77.0429},{trips:2,name:"14th & V St NW",id:"31101",lat:38.9176,lng:-77.0321},{trips:0,name:"11th & Kenyon St NW",id:"31102",lat:38.929462,lng:-77.027824},{trips:1,name:"16th & Harvard St NW",id:"31103",lat:38.926086,lng:-77.03654},{trips:1,name:"Adams Mill & Columbia Rd NW",id:"31104",lat:38.922924,lng:-77.04258},{trips:0,name:"14th & Harvard St NW",id:"31105",lat:38.9268,lng:-77.0322},{trips:0,name:"Calvert & Biltmore St NW",id:"31106",lat:38.923203,lng:-77.04764},{trips:0,name:"Lamont & Mt Pleasant NW",id:"31107",lat:38.9319,lng:-77.0388},{trips:0,name:"4th & M St SW",id:"31108",lat:38.8767,lng:-77.0178},{trips:9,name:"15th & P St NW",id:"31201",lat:38.90985,lng:-77.03444},{trips:0,name:"14th & R St NW",id:"31202",lat:38.91268,lng:-77.03168},{trips:1,name:"14th & Rhode Island Ave NW",id:"31203",lat:38.9086,lng:-77.0323},{trips:5,name:"20th & E St NW",id:"31204",lat:38.8963,lng:-77.045},{trips:2,name:"21st & I St NW",id:"31205",lat:38.9008,lng:-77.047},{trips:0,name:"Georgia & New Hampshire Ave NW",id:"31400",lat:38.936043,lng:-77.02465},{trips:0,name:"14th St & Spring Rd NW",id:"31401",lat:38.9375,lng:-77.0328},{trips:0,name:"John McCormack Dr & Michigan Ave NE",id:"31502",lat:38.9346,lng:-76.9955},{trips:0,name:"5th & K St NW",id:"31600",lat:38.90304,lng:-77.01903},{trips:0,name:"19th & East Capitol St SE",id:"31601",lat:38.8896,lng:-76.9769},{trips:0,name:"Park Rd & Holmead Pl NW",id:"31602",lat:38.9308,lng:-77.0315},{trips:0,name:"Good Hope & Naylor Rd SE",id:"31700",lat:38.8601,lng:-76.9672},{trips:0,name:"Connecticut Ave & Newark St NW / Cleveland Park",id:"31305",lat:38.934265,lng:-77.057976},{trips:0,name:"Randle Circle & Minnesota Ave SE",id:"31702",lat:38.878,lng:-76.9607},{trips:0,name:"Minnesota Ave Metro/DOES",id:"31703",lat:38.897064,lng:-76.94745},{trips:0,name:"Nannie Helen Burroughs & Minnesota Ave NE",id:"31704",lat:38.901386,lng:-76.94188},{trips:0,name:"Anacostia Metro",id:"31801",lat:38.86267,lng:-76.99464},{trips:0,name:"Good Hope Rd & MLK Ave SE",id:"31802",lat:38.867374,lng:-76.98804},{trips:0,name:"19th & E Street NW",id:"31206",lat:38.8952,lng:-77.0436},{trips:0,name:"4th & W St NE",id:"31500",lat:38.91908,lng:-77.00065},{trips:0,name:"10th & U St NW",id:"31111",lat:38.9172,lng:-77.0259},{trips:0,name:"Georgia Ave and Fairmont St NW",id:"31207",lat:38.9249,lng:-77.0222},{trips:1,name:"1st & N St  SE",id:"31209",lat:38.8743,lng:-77.0057},{trips:0,name:"20th St & Florida Ave NW",id:"31110",lat:38.9154,lng:-77.0446},{trips:1,name:"7th & T St NW",id:"31109",lat:38.9155,lng:-77.0222},{trips:0,name:"23rd & Eads St",id:"31013",lat:38.85353,lng:-77.05351},{trips:0,name:"M St & New Jersey Ave SE",id:"31208",lat:38.8763,lng:-77.0037},{trips:9,name:"Massachusetts Ave & Dupont Circle NW",id:"31200",lat:38.9101,lng:-77.0444},{trips:1,name:"1st & M St NE",id:"31603",lat:38.9057,lng:-77.0056},{trips:2,name:"21st & M St NW",id:"31212",lat:38.90534,lng:-77.046776},{trips:2,name:"17th & K St NW",id:"31213",lat:38.90276,lng:-77.03863},{trips:0,name:"3rd & H St NW",id:"31604",lat:38.899406,lng:-77.01529},{trips:1,name:"3rd & D St SE",id:"31605",lat:38.8851,lng:-77.0023},{trips:0,name:"Potomac & Pennsylvania Ave SE",id:"31606",lat:38.8803,lng:-76.9862},{trips:0,name:"14th & D St SE",id:"31607",lat:38.884,lng:-76.9861},{trips:3,name:"17th & Corcoran St NW",id:"31214",lat:38.9121,lng:-77.0387},{trips:0,name:"Van Ness Metro / UDC",id:"31300",lat:38.94455,lng:-77.063896},{trips:0,name:"Florida Ave & R St NW",id:"31503",lat:38.9126,lng:-77.0135},{trips:0,name:"8th & Eye St SE / Barracks Row",id:"31608",lat:38.8792,lng:-76.9953},{trips:0,name:"Ward Circle / American University",id:"31301",lat:38.938736,lng:-77.08717},{trips:0,name:"Wisconsin Ave & Newark St NW",id:"31302",lat:38.93488,lng:-77.072754},{trips:0,name:"14th St Heights / 14th & Crittenden St NW",id:"31402",lat:38.947773,lng:-77.03282},{trips:0,name:"Anacostia Library",id:"31804",lat:38.865784,lng:-76.9784},{trips:0,name:"Pennsylvania & Minnesota Ave SE",id:"31805",lat:38.87306,lng:-76.971016},{trips:0,name:"Eastern Market / 7th & North Carolina Ave SE",id:"31610",lat:38.88695,lng:-76.9968},{trips:3,name:"14th St & New York Ave NW",id:"31216",lat:38.89963,lng:-77.031685},{trips:0,name:"Benning Branch Library",id:"31705",lat:38.894,lng:-76.947975},{trips:5,name:"USDA / 12th & Independence Ave SW",id:"31217",lat:38.887238,lng:-77.02823},{trips:11,name:"Georgetown Harbor / 30th St NW",id:"31215",lat:38.90222,lng:-77.05922},{trips:0,name:"12th & Newton St NE",id:"31501",lat:38.933666,lng:-76.99101},{trips:1,name:"US Dept of State / Virginia Ave & 21st St NW",id:"31220",lat:38.89492,lng:-77.046585},{trips:8,name:"L'Enfant Plaza / 7th & C St SW",id:"31218",lat:38.886265,lng:-77.02224},{trips:5,name:"10th St & Constitution Ave NW",id:"31219",lat:38.89303,lng:-77.02602},{trips:0,name:"Kennedy Center",id:"31211",lat:38.897293,lng:-77.05557},{trips:1,name:"Eastern Market Metro / Pennsylvania Ave & 7th St SE",id:"31613",lat:38.884,lng:-76.9954},{trips:2,name:"18th & M St NW",id:"31221",lat:38.904743,lng:-77.0416},{trips:0,name:"Tenleytown / Wisconsin Ave & Albemarle St NW",id:"31303",lat:38.947605,lng:-77.079384},{trips:0,name:"13th & H St NE",id:"31611",lat:38.9003,lng:-76.9882},{trips:1,name:"5th & F St NW",id:"31620",lat:38.89722,lng:-77.01935},{trips:11,name:"New York Ave & 15th St NW",id:"31222",lat:38.8991,lng:-77.0337},{trips:0,name:"Convention Center / 7th & M St NW",id:"31223",lat:38.90572,lng:-77.02226},{trips:1,name:"Harvard St & Adams Mill Rd NW",id:"31112",lat:38.92787,lng:-77.04336},{trips:2,name:"19th & L St NW",id:"31224",lat:38.903408,lng:-77.04365},{trips:6,name:"C & O Canal & Wisconsin Ave NW",id:"31225",lat:38.90375,lng:-77.06269},{trips:2,name:"6th & Water St SW / SW Waterfront",id:"31609",lat:38.87675,lng:-77.02127},{trips:0,name:"D St & Maryland Ave NE",id:"31612",lat:38.894756,lng:-76.997116},{trips:0,name:"34th St & Wisconsin Ave NW",id:"31226",lat:38.916443,lng:-77.0682},{trips:0,name:"13th St & New York Ave NW",id:"31227",lat:38.900284,lng:-77.02982},{trips:0,name:"8th & H St NW",id:"31228",lat:38.8997,lng:-77.02309},{trips:2,name:"10th & Monroe St NE",id:"31504",lat:38.932514,lng:-76.99289},{trips:0,name:"Eckington Pl & Q St NE",id:"31505",lat:38.910973,lng:-77.00495},{trips:0,name:"6th & H St NE",id:"31615",lat:38.89997,lng:-76.998344},{trips:2,name:"3rd & H St NE",id:"31616",lat:38.900414,lng:-77.001945},{trips:1,name:"Bladensburg Rd & Benning Rd NE",id:"31617",lat:38.900414,lng:-76.98287},{trips:5,name:"4th & East Capitol St NE",id:"31618",lat:38.889954,lng:-77.00035},{trips:0,name:"Lincoln Park / 13th & East Capitol St NE ",id:"31619",lat:38.89046,lng:-76.98836},{trips:0,name:"Branch & Pennsylvania Ave SE",id:"31701",lat:38.8692,lng:-76.9599},{trips:0,name:"13th & D St NE",id:"31622",lat:38.894833,lng:-76.98763},{trips:0,name:"New Hampshire Ave & T St NW",id:"31229",lat:38.91554,lng:-77.03818},{trips:7,name:"Metro Center / 12th & G St NW",id:"31230",lat:38.898365,lng:-77.02787},{trips:11,name:"14th & D St NW / Ronald Reagan Building",id:"31231",lat:38.894512,lng:-77.03162},{trips:0,name:"7th & F St NW / National Portrait Gallery",id:"31232",lat:38.89735,lng:-77.02247},{trips:2,name:"17th & K St NW / Farragut Square",id:"31233",lat:38.90206,lng:-77.03832},{trips:6,name:"20th & O St NW / Dupont South",id:"31234",lat:38.908905,lng:-77.04478},{trips:0,name:"4th & D St NW / Judiciary Square",id:"31621",lat:38.895344,lng:-77.016106},{trips:7,name:"19th St & Constitution Ave NW",id:"31235",lat:38.8923,lng:-77.0436},{trips:1,name:"37th & O St NW / Georgetown University",id:"31236",lat:38.90774,lng:-77.071655},{trips:0,name:"11th & H St NE",id:"31614",lat:38.899982,lng:-76.99139},{trips:5,name:"25th St & Pennsylvania Ave NW",id:"31237",lat:38.903828,lng:-77.05348},{trips:9,name:"Columbus Circle / Union Station",id:"31623",lat:38.89696,lng:-77.00493},{trips:2,name:"North Capitol St & F St NW",id:"31624",lat:38.897446,lng:-77.00989},{trips:1,name:"11th & M St NW",id:"31266",lat:38.905605,lng:-77.02714},{trips:0,name:"36th & Calvert St NW / Glover Park",id:"31304",lat:38.92258,lng:-77.070335},{trips:3,name:"14th & G St NW",id:"31238",lat:38.898067,lng:-77.03182},{trips:0,name:"Potomac Ave & 35th St S",id:"31052",lat:38.844013,lng:-77.05054},{trips:13,name:"Ohio Dr & West Basin Dr SW / MLK & FDR Memorials",id:"31240",lat:38.88412,lng:-77.04657},{trips:12,name:"11th & F St NW",id:"31262",lat:38.897858,lng:-77.02698},{trips:1,name:"23rd & E St NW ",id:"31260",lat:38.896103,lng:-77.04988},{trips:5,name:"Lynn & 19th St North",id:"31014",lat:38.897316,lng:-77.07099},{trips:7,name:"Rosslyn Metro / Wilson Blvd & Ft Myer Dr",id:"31015",lat:38.8946,lng:-77.0723},{trips:0,name:"Clarendon Blvd & Pierce St",id:"31016",lat:38.893646,lng:-77.0767},{trips:4,name:"Wilson Blvd & N Uhle St",id:"31017",lat:38.891697,lng:-77.0846},{trips:2,name:"N Rhodes & 16th St N",id:"31018",lat:38.892162,lng:-77.07938},{trips:0,name:"Fairfax Village",id:"31706",lat:38.86559,lng:-76.9521},{trips:9,name:"21st St & Constitution Ave NW",id:"31261",lat:38.89246,lng:-77.04657},{trips:1,name:"Wilson Blvd & N Edgewood St",id:"31019",lat:38.889,lng:-77.0925},{trips:0,name:"Columbia Rd & Belmont St NW",id:"31113",lat:38.92067,lng:-77.04368},{trips:1,name:"17th & Rhode Island Ave NW",id:"31239",lat:38.9066,lng:-77.03879},{trips:7,name:"Thomas Circle",id:"31241",lat:38.9059,lng:-77.0325},{trips:0,name:"Wilson Blvd & Franklin Rd",id:"31020",lat:38.8904,lng:-77.0889},{trips:1,name:"Clarendon Blvd & N Fillmore St",id:"31021",lat:38.8881,lng:-77.09308},{trips:0,name:"Clarendon Metro / Wilson Blvd & N Highland St",id:"31022",lat:38.88786,lng:-77.09487},{trips:2,name:"18th St & Pennsylvania Ave NW",id:"31242",lat:38.89968,lng:-77.04154},{trips:12,name:"Maryland & Independence Ave SW",id:"31243",lat:38.8873,lng:-77.018936},{trips:14,name:"4th & E St SW",id:"31244",lat:38.88412,lng:-77.01745},{trips:0,name:"3rd & G St SE",id:"31625",lat:38.881184,lng:-77.00183},{trips:0,name:"7th & R St NW / Shaw Library",id:"31245",lat:38.91272,lng:-77.022156},{trips:0,name:"9th & Upshur St NW",id:"31404",lat:38.9418,lng:-77.0251},{trips:0,name:"1st & Rhode Island Ave NW",id:"31506",lat:38.915417,lng:-77.01229},{trips:0,name:"Columbia Rd & Georgia Ave NW",id:"31115",lat:38.928158,lng:-77.02344},{trips:0,name:"California St & Florida Ave NW",id:"31116",lat:38.917763,lng:-77.04062},{trips:0,name:"Benning Rd & East Capitol St NE / Benning Rd Metro",id:"31707",lat:38.889935,lng:-76.93723},{trips:1,name:"3000 Connecticut Ave NW / National Zoo",id:"31307",lat:38.930283,lng:-77.055595},{trips:0,name:"Anacostia Ave & Benning Rd NE / River Terrace ",id:"31708",lat:38.896545,lng:-76.96012},{trips:4,name:"M St & Pennsylvania Ave NW",id:"31246",lat:38.905125,lng:-77.056885},{trips:1,name:"15th St & Massachusetts Ave SE",id:"31626",lat:38.88732,lng:-76.98357},{trips:0,name:"Congress Heights Metro",id:"31806",lat:38.84471,lng:-76.98782},{trips:0,name:"N Quincy St & Glebe Rd",id:"31035",lat:38.876392,lng:-77.107735},{trips:0,name:"Wilson Blvd & N Oakland St",id:"31033",lat:38.8815,lng:-77.10396},{trips:0,name:"N Veitch  & 20th St N",id:"31029",lat:38.896923,lng:-77.0865},{trips:0,name:"10th & K St NW",id:"31263",lat:38.9024,lng:-77.02622},{trips:0,name:"Fairfax Dr & Wilson Blvd",id:"31023",lat:38.8858,lng:-77.09775},{trips:0,name:"Key Blvd & N Quinn St",id:"31027",lat:38.896015,lng:-77.07811},{trips:4,name:"1st & K St SE",id:"31628",lat:38.87861,lng:-77.006004},{trips:1,name:"39th & Calvert St NW / Stoddert",id:"31306",lat:38.92265,lng:-77.07727},{trips:0,name:"1st & Washington Hospital Center NW",id:"31507",lat:38.92874,lng:-77.01246},{trips:3,name:"Virginia Square Metro / N Monroe St & 9th St N",id:"31024",lat:38.88279,lng:-77.10315},{trips:0,name:"Central Library / N Quincy St & 10th St N",id:"31025",lat:38.88397,lng:-77.10783},{trips:0,name:"Washington Blvd & 10th St N",id:"31026",lat:38.884735,lng:-77.09348},{trips:72,name:"Jefferson Dr & 14th St SW",id:"31247",lat:38.888554,lng:-77.03243},{trips:23,name:"Smithsonian / Jefferson Dr & 12th St SW",id:"31248",lat:38.888767,lng:-77.02858},{trips:0,name:"George Mason Dr & Wilson Blvd",id:"31036",lat:38.87887,lng:-77.1207},{trips:6,name:"6th St & Indiana Ave NW",id:"31264",lat:38.894573,lng:-77.01994},{trips:1,name:"N Veitch & Key Blvd",id:"31028",lat:38.89324,lng:-77.086044},{trips:0,name:"N Adams St & Lee Hwy",id:"31030",lat:38.89593,lng:-77.089005},{trips:0,name:"15th & N Scott St",id:"31031",lat:38.89054,lng:-77.08095},{trips:0,name:"Washington Blvd & 7th St N",id:"31032",lat:38.880833,lng:-77.091125},{trips:0,name:"Ballston Metro / N Stuart & 9th St N",id:"31037",lat:38.881042,lng:-77.11177},{trips:2,name:"N Randolph St & Fairfax Dr",id:"31034",lat:38.88263,lng:-77.10937},{trips:42,name:"Jefferson Memorial",id:"31249",lat:38.879818,lng:-77.037415},{trips:1,name:"Good Hope Rd & 14th St SE",id:"31803",lat:38.86661,lng:-76.98524},{trips:0,name:"Glebe Rd & 11th St N",id:"31038",lat:38.883923,lng:-77.11681},{trips:0,name:"N Quincy St & Wilson Blvd",id:"31039",lat:38.88015,lng:-77.10767},{trips:0,name:"Fairfax Dr & Kenmore St",id:"31040",lat:38.884617,lng:-77.10108},{trips:2,name:"Gallaudet / 8th St & Florida Ave NE",id:"31508",lat:38.90509,lng:-76.9941},{trips:0,name:"20th & L St NW",id:"31250",lat:38.903584,lng:-77.04479},{trips:0,name:"12th & L St NW",id:"31251",lat:38.90382,lng:-77.0284},{trips:2,name:"21st St & Pennsylvania Ave NW",id:"31252",lat:38.90154,lng:-77.04656},{trips:2,name:"19th & K St NW",id:"31253",lat:38.902203,lng:-77.04337},{trips:0,name:"Prince St & Union St",id:"31041",lat:38.803123,lng:-77.04036},{trips:0,name:"Market Square / King St & Royal St",id:"31042",lat:38.804718,lng:-77.043365},{trips:0,name:"Saint Asaph St & Pendleton  St",id:"31043",lat:38.81074,lng:-77.04466},{trips:0,name:"King St & Patrick St",id:"31044",lat:38.805317,lng:-77.04988},{trips:9,name:"15th & K St NW",id:"31254",lat:38.902,lng:-77.03353},{trips:0,name:"Commerce St & Fayette St",id:"31045",lat:38.80565,lng:-77.05293},{trips:0,name:"Henry St & Pendleton St",id:"31046",lat:38.811455,lng:-77.05028},{trips:0,name:"Braddock Rd Metro",id:"31047",lat:38.814575,lng:-77.05281},{trips:0,name:"King St Metro",id:"31048",lat:38.805767,lng:-77.06072},{trips:2,name:"24th & N St NW",id:"31255",lat:38.9066,lng:-77.05152},{trips:4,name:"10th & E St NW",id:"31256",lat:38.895912,lng:-77.02606},{trips:6,name:"22nd & I St NW / Foggy Bottom",id:"31257",lat:38.90088,lng:-77.04891},{trips:1,name:"Utah St & 11th St N ",id:"31049",lat:38.88367,lng:-77.11391},{trips:1,name:"Barton St & 10th St N",id:"31050",lat:38.88496,lng:-77.08777},{trips:5,name:"Arlington Blvd & N Queen St",id:"31051",lat:38.889366,lng:-77.07729},{trips:82,name:"Lincoln Memorial",id:"31258",lat:38.888252,lng:-77.04942},{trips:0,name:"20th St & Virginia Ave NW",id:"31259",lat:38.894722,lng:-77.04513},{trips:2,name:"5th St & Massachusetts Ave NW",id:"31265",lat:38.90093,lng:-77.01868},{trips:0,name:"39th & Veazey St NW",id:"31308",lat:38.943836,lng:-77.07708},{trips:0,name:"Fessenden St & Wisconsin Ave NW",id:"31309",lat:38.95481,lng:-77.08243},{trips:1,name:"M St & Delaware Ave NE",id:"31627",lat:38.90571,lng:-77.003044},{trips:4,name:"Columbia Pike & S Courthouse Rd",id:"31053",lat:38.863834,lng:-77.08032},{trips:0,name:"Walter Reed Community Center / Walter Reed Dr & 16th St S",id:"31054",lat:38.857803,lng:-77.08673},{trips:0,name:"28th St S & S Meade St",id:"31055",lat:38.846222,lng:-77.069275},{trips:0,name:"18th St & Wyoming Ave NW",id:"31114",lat:38.918808,lng:-77.04157},{trips:0,name:"5th & Kennedy St NW",id:"31403",lat:38.956596,lng:-77.01981},{trips:0,name:"Georgia Ave & Emerson St NW",id:"31405",lat:38.94966,lng:-77.027336},{trips:2,name:"14th & Upshur St NW",id:"31406",lat:38.942017,lng:-77.03265},{trips:0,name:"14th St & Colorado Ave NW",id:"31407",lat:38.956432,lng:-77.03294},{trips:0,name:"S Troy St & 26th St S",id:"31056",lat:38.847977,lng:-77.0751},{trips:0,name:"S Four Mile Run Dr & S Shirlington Rd",id:"31057",lat:38.8444,lng:-77.08593},{trips:0,name:"S Oakland St & Columbia Pike",id:"31058",lat:38.86079,lng:-77.09586},{trips:0,name:"S Four Mile Run & Walter Reed Dr",id:"31059",lat:38.84736,lng:-77.09543},{trips:0,name:"S Arlington Mill Dr & Campbell Ave",id:"31060",lat:38.84232,lng:-77.089554},{trips:0,name:"S Kenmore & 24th St S",id:"31061",lat:38.848454,lng:-77.084915},{trips:0,name:"13th St & Eastern Ave",id:"32006",lat:38.987,lng:-77.02942},{trips:1,name:"Wisconsin Ave & O St NW",id:"31312",lat:38.90849,lng:-77.06358},{trips:0,name:"S George Mason Dr & 13th St S",id:"31062",lat:38.85469,lng:-77.100555},{trips:0,name:"Connecticut & Nebraska Ave NW",id:"31310",lat:38.955017,lng:-77.069954},{trips:9,name:"17th St & Massachusetts Ave NW",id:"31267",lat:38.908142,lng:-77.03836},{trips:0,name:"15th & Euclid St  NW",id:"31117",lat:38.92333,lng:-77.0352},{trips:2,name:"8th & East Capitol St NE",id:"31629",lat:38.889988,lng:-76.99519},{trips:2,name:"New Jersey Ave & R St NW",id:"31509",lat:38.91266,lng:-77.01767},{trips:2,name:"15th & East Capitol St NE",id:"31630",lat:38.889908,lng:-76.98333},{trips:2,name:"8th & F St NE",id:"31631",lat:38.897274,lng:-76.99475},{trips:0,name:"18th St & Rhode Island Ave NE",id:"31510",lat:38.927094,lng:-76.97893},{trips:0,name:"15th & F St NE",id:"31632",lat:38.897194,lng:-76.983574},{trips:0,name:"12th & Irving St NE",id:"31511",lat:38.928642,lng:-76.99095},{trips:0,name:"34th St & Minnesota Ave SE",id:"31709",lat:38.884087,lng:-76.95746},{trips:0,name:"Alabama & MLK Ave SE",id:"31800",lat:38.843224,lng:-76.99939},{trips:0,name:"Pleasant St & MLK Ave SE",id:"31807",lat:38.863895,lng:-76.990036},{trips:0,name:"Neal St & Trinidad Ave NE",id:"31512",lat:38.903732,lng:-76.98721},{trips:2,name:"12th & U St NW",id:"31268",lat:38.916786,lng:-77.02814},{trips:0,name:"S George Mason Dr & Four Mile Run",id:"31063",lat:38.85225,lng:-77.10502},{trips:0,name:"S Stafford & 34th St S",id:"31064",lat:38.834106,lng:-77.087326},{trips:2,name:"N Pershing Dr & Wayne St",id:"31065",lat:38.880707,lng:-77.08596},{trips:0,name:"Columbia Pike & S Orme St",id:"31066",lat:38.867264,lng:-77.07231},{trips:3,name:"3rd St & Pennsylvania Ave SE",id:"31269",lat:38.88738,lng:-77.00195},{trips:8,name:"8th & D St NW",id:"31270",lat:38.89485,lng:-77.02324},{trips:0,name:"3rd & Elm St NW",id:"31118",lat:38.91762,lng:-77.01597},{trips:0,name:"Rhode Island Ave & V St NE",id:"31513",lat:38.918156,lng:-77.004745},{trips:15,name:"Constitution Ave & 2nd St NW/DOL",id:"31271",lat:38.892277,lng:-77.013916},{trips:12,name:"Washington & Independence Ave SW/HHS",id:"31272",lat:38.88731,lng:-77.01397},{trips:7,name:"Independence Ave & L'Enfant Plaza SW/DOE",id:"31633",lat:38.887314,lng:-77.025764},{trips:0,name:"Hamlin & 7th St NE",id:"31514",lat:38.927498,lng:-76.99719},{trips:1,name:"Columbia Pike & S Walter Reed Dr",id:"31067",lat:38.862476,lng:-77.0866},{trips:0,name:"Columbia Pike & S Dinwiddie St / Arlington Mill Community Center",id:"31068",lat:38.85632,lng:-77.11153},{trips:0,name:"Pershing & N George Mason Dr",id:"31069",lat:38.871822,lng:-77.1079},{trips:0,name:"Fenton St & New York Ave ",id:"32001",lat:38.985405,lng:-77.02308},{trips:0,name:"Bethesda Ave & Arlington Rd",id:"32002",lat:38.981102,lng:-77.09743},{trips:0,name:"Montgomery Ave & Waverly St ",id:"32003",lat:38.983837,lng:-77.09221},{trips:0,name:"Fallsgrove Blvd & Fallsgrove Dr",id:"32004",lat:39.096313,lng:-77.19267},{trips:0,name:"Traville Gateway Dr & Gudelsky Dr",id:"32005",lat:39.093784,lng:-77.2025},{trips:0,name:"Norfolk Ave & Fairmont St",id:"32000",lat:38.988564,lng:-77.09654},{trips:0,name:"E Montgomery Ave & Maryland Ave",id:"32007",lat:39.084126,lng:-77.15129},{trips:0,name:"Cordell & Norfolk Ave",id:"32008",lat:38.98954,lng:-77.09803},{trips:0,name:"Frederick Ave & Horners Ln",id:"32009",lat:39.094772,lng:-77.14521},{trips:0,name:"Philadelphia & Maple Ave",id:"32010",lat:38.98128,lng:-77.01134},{trips:0,name:"Maple & Ritchie Ave",id:"32011",lat:38.983627,lng:-77.00631},{trips:0,name:"Silver Spring Metro/Colesville Rd & Wayne Ave",id:"32012",lat:38.99521,lng:-77.02918},{trips:0,name:"Montgomery & East Ln",id:"32013",lat:38.983524,lng:-77.09537},{trips:0,name:"Friendship Hts Metro/Wisconsin Ave & Wisconsin Cir",id:"32014",lat:38.96176,lng:-77.086},{trips:0,name:"14th & Belmont St NW",id:"31119",lat:38.921074,lng:-77.03188},{trips:1,name:"3rd & Tingey St SE",id:"31634",lat:38.87501,lng:-77.0024},{trips:0,name:"10th & Florida Ave NW",id:"31120",lat:38.920387,lng:-77.02567},{trips:0,name:"Potomac Ave & 8th St SE",id:"31635",lat:38.876736,lng:-76.99447},{trips:0,name:"Crabbs Branch Way & Redland Rd",id:"32015",lat:39.120045,lng:-77.15698},{trips:0,name:"Fallsgrove Dr & W Montgomery Ave",id:"32016",lat:39.099377,lng:-77.18801},{trips:0,name:"Monroe St & Monroe Pl",id:"32017",lat:39.08278,lng:-77.14883},{trips:0,name:"Needwood Rd & Eagles Head Ct",id:"32018",lat:39.123512,lng:-77.15741},{trips:0,name:"East West Hwy & Blair Mill Rd",id:"32019",lat:38.99025,lng:-77.02935},{trips:0,name:"Crabbs Branch Way & Calhoun Pl",id:"32020",lat:39.107708,lng:-77.15207},{trips:0,name:"47th & Elm St",id:"32021",lat:38.982456,lng:-77.09199},{trips:0,name:"Garland Ave & Walden Rd",id:"32022",lat:39.00058,lng:-77.00149},{trips:0,name:"Montgomery College/W Campus Dr & Mannakee St",id:"32023",lat:39.09566,lng:-77.15905},{trips:0,name:"Fenton St & Gist Ave",id:"32024",lat:38.989723,lng:-77.02386},{trips:0,name:"Carroll & Westmoreland Ave",id:"32025",lat:38.975,lng:-77.01121},{trips:0,name:"Carroll & Ethan Allen Ave",id:"32026",lat:38.977932,lng:-77.00647},{trips:0,name:"Battery Ln & Trolley Trail",id:"32027",lat:38.992374,lng:-77.100105},{trips:0,name:"Norfolk & Rugby Ave",id:"32028",lat:38.99064,lng:-77.10024},{trips:0,name:"Offutt Ln & Chevy Chase Dr",id:"32029",lat:38.977093,lng:-77.09459},{trips:0,name:"Broschart & Blackwell Rd",id:"32030",lat:39.1021,lng:-77.200325},{trips:0,name:"Taft St & E Gude Dr",id:"32031",lat:39.094105,lng:-77.13296},{trips:0,name:"Fleet St & Ritchie Pkwy",id:"32032",lat:39.076332,lng:-77.14138},{trips:0,name:"Piccard & W Gude Dr",id:"32033",lat:39.10221,lng:-77.17709},{trips:0,name:"Ripley & Bonifant St",id:"32034",lat:38.99268,lng:-77.02946},{trips:0,name:"Georgia Ave & Spring St",id:"32035",lat:38.99939,lng:-77.031555},{trips:0,name:"Fenton St & Ellsworth Dr ",id:"32036",lat:38.997032,lng:-77.025604},{trips:0,name:"King Farm Blvd & Pleasant Dr",id:"32037",lat:39.11469,lng:-77.171486},{trips:0,name:"King Farm Blvd & Piccard Dr",id:"32038",lat:39.110313,lng:-77.18267},{trips:0,name:"Calvert St & Woodley Pl NW",id:"31121",lat:38.923584,lng:-77.05005},{trips:1,name:"New Jersey Ave & N St NW/Dunbar HS",id:"31636",lat:38.90706,lng:-77.01523},{trips:0,name:"Nannie Helen Burroughs Ave & 49th St NE",id:"31710",lat:38.898537,lng:-76.93186},{trips:0,name:"Deanwood Rec Center",id:"31711",lat:38.908474,lng:-76.9331},{trips:2,name:"Hains Point/Buckeye & Ohio Dr SW",id:"31273",lat:38.878433,lng:-77.03023},{trips:1,name:"Arlington Blvd & Fillmore St",id:"31070",lat:38.873756,lng:-77.08923},{trips:1,name:"Long Bridge Park/Long Bridge Dr & 6th St S",id:"31071",lat:38.86646,lng:-77.04826},{trips:0,name:"Old Georgetown Rd & Southwick St",id:"32039",lat:38.999634,lng:-77.10965},{trips:0,name:"Friendship Blvd & Willard Ave",id:"32040",lat:38.96115,lng:-77.08866},{trips:1,name:"North Capitol St & G Pl NE",id:"31637",lat:38.899704,lng:-77.00891},{trips:0,name:"31st & Woodrow St S",id:"31072",lat:38.837666,lng:-77.09482},{trips:0,name:"Washington Blvd & Walter Reed Dr ",id:"31073",lat:38.87322,lng:-77.08211},{trips:0,name:"TJ Cmty Ctr / 2nd St & S Old Glebe Rd",id:"31074",lat:38.86942,lng:-77.0956},{trips:1,name:"Connecticut Ave & Tilden St NW",id:"31313",lat:38.941154,lng:-77.062035},{trips:0,name:"Medical Center Dr & Key West Ave",id:"32041",lat:39.103092,lng:-77.19644},{trips:0,name:"Shady Grove Hospital",id:"32042",lat:39.097637,lng:-77.19663},{trips:0,name:"Veterans Pl & Pershing Dr ",id:"32043",lat:38.997444,lng:-77.023895},{trips:0,name:"Rockville Metro East",id:"32044",lat:39.085396,lng:-77.145805},{trips:0,name:"1st & H St NW",id:"31638",lat:38.900356,lng:-77.01211},{trips:0,name:"Fort Totten Metro",id:"31515",lat:38.95237,lng:-77.00272},{trips:0,name:"Takoma Metro",id:"31408",lat:38.97522,lng:-77.01685},{trips:0,name:"Rhode Island Ave Metro",id:"31516",lat:38.92068,lng:-76.99587},{trips:0,name:"Rolfe St & 9th St S",id:"31075",lat:38.86647,lng:-77.07613},{trips:0,name:"Shirlington Transit Center / S Quincy & Randolph St",id:"31076",lat:38.839912,lng:-77.08708},{trips:0,name:"Shady Grove Metro West",id:"32045",lat:39.119766,lng:-77.16609},{trips:0,name:"River Rd & Landy Ln",id:"32046",lat:38.964993,lng:-77.10338},{trips:0,name:"Rockville Metro West",id:"32047",lat:39.084377,lng:-77.146866},{trips:0,name:"Bethesda Metro",id:"32048",lat:38.98469,lng:-77.094536},{trips:29,name:"Iwo Jima Memorial/N Meade & 14th St N",id:"31077",lat:38.88992,lng:-77.071304},{trips:3,name:"34th & Water St NW",id:"31314",lat:38.903584,lng:-77.06779},{trips:0,name:"Duke St & John Carlyle St",id:"31081",lat:38.80438,lng:-77.06087},{trips:1,name:"Lee Hwy & N Cleveland St",id:"31079",lat:38.89494,lng:-77.09169},{trips:0,name:"Arlington Blvd & S George Mason Dr/NFATC",id:"31078",lat:38.869442,lng:-77.1045},{trips:0,name:"MLK Library/9th & G St NW",id:"31274",lat:38.898403,lng:-77.024284},{trips:1,name:"Lee Hwy & N Scott St",id:"31080",lat:38.897614,lng:-77.08085},{trips:1,name:"New Hampshire Ave & 24th St NW",id:"31275",lat:38.901756,lng:-77.05109},{trips:0,name:"Eisenhower Ave & Mill Race Ln",id:"31082",lat:38.80111,lng:-77.068954},{trips:0,name:"Potomac Greens Dr & Slaters Ln",id:"31083",lat:38.82175,lng:-77.04749},{trips:0,name:"Ballenger Ave & Dulaney St",id:"31084",lat:38.802677,lng:-77.06356},{trips:0,name:"Mount Vernon Ave & E Nelson Ave",id:"31085",lat:38.820065,lng:-77.05762},{trips:0,name:"Mount Vernon Ave & E Del Ray Ave",id:"31086",lat:38.82595,lng:-77.05854},{trips:0,name:"Monroe Ave & Leslie Ave",id:"31087",lat:38.82093,lng:-77.05309},{trips:0,name:"Mount Vernon Ave & Kennedy St",id:"31088",lat:38.833076,lng:-77.05982},{trips:3,name:"Court House Metro / 15th & N Uhle St ",id:"31089",lat:38.890614,lng:-77.0848},{trips:0,name:"Washington Adventist U / Flower Ave & Division St",id:"32049",lat:38.986744,lng:-77.00004},{trips:0,name:"6th & S Ball St",id:"31090",lat:38.8647,lng:-77.048676},{trips:0,name:"McKinley St & Connecticut Ave NW",id:"31315",lat:38.96497,lng:-77.07594},{trips:3,name:"15th & L St NW",id:"31276",lat:38.90366,lng:-77.03484},{trips:4,name:"17th & G St NW",id:"31277",lat:38.89841,lng:-77.03963},{trips:0,name:"Spring St & Second Ave",id:"32050",lat:38.997654,lng:-77.0345},{trips:1,name:"18th & R St NW",id:"31278",lat:38.912647,lng:-77.04183},{trips:5,name:"S Joyce & 16th St S",id:"31091",lat:38.859253,lng:-77.06328},{trips:1,name:"Union Market/6th St & Neal Pl NE",id:"31517",lat:38.90801,lng:-76.99699},{trips:0,name:"N Nelson St & Lee Hwy",id:"31092",lat:38.895927,lng:-77.10525},{trips:0,name:"21st St N & N Pierce St",id:"31093",lat:38.898983,lng:-77.078316},{trips:0,name:"Lee Hwy & N Kirkwood Rd",id:"31094",lat:38.89538,lng:-77.09713},{trips:2,name:"19th & G St NW",id:"31279",lat:38.89841,lng:-77.04318},{trips:4,name:"Army Navy Dr & S Nash St",id:"31095",lat:38.86247,lng:-77.068245},{trips:1,name:"11th & S St NW",id:"31280",lat:38.91376,lng:-77.02702},{trips:0,name:"S Walter Reed Dr & 8th St S",id:"31096",lat:38.86612,lng:-77.08787},{trips:2,name:"2nd & G St NE",id:"31639",lat:38.89967,lng:-77.00367},{trips:0,name:"8th & O St NW",id:"31281",lat:38.90864,lng:-77.02277},{trips:0,name:"Georgia & Missouri Ave NW",id:"31411",lat:38.961338,lng:-77.027855},{trips:0,name:"Oklahoma Ave & D St NE",id:"31712",lat:38.894474,lng:-76.97483},{trips:0,name:"Maryland Ave & E St NE",id:"31640",lat:38.896133,lng:-76.9929},{trips:0,name:"New York Ave & Hecht Ave NE",id:"31518",lat:38.915604,lng:-76.98368}];
var caBiModel;
var CaBiSplineIndex = -1;
var CaBiSplineDelta = 0;
var CaBiSplineSteps = 24;
var showStations = true;
var showDocks = false;
var showData = false;

function getCaBiData() {
  var xmlhttp = new XMLHttpRequest();
  xmlhttp.onreadystatechange = function() {
    if (xmlhttp.readyState == 4) {
      if (xmlhttp.status == 200) renderCaBiData(xmlhttp.responseText);
      else                       alert("status: " + xmlhttp.status);
      }
    };
  xmlhttp.open("GET", "http://www.mvjantzen.com/cabi/cabidata.php?details=true");
  xmlhttp.send();
  }

function renderCaBiData(responseText) {
  try {
    var cabiData = JSON.parse(responseText);
    var stations = cabiData.station;
    var totalBikes = 0;
    var totalDocks = 0;
    for (var i = 0; i < stations.length; i++) {
      var j = 0;
      while (j < LincolnTraffic.length && LincolnTraffic[j].id != stations[i].terminalName) {
        j++;
        }
      if (j < LincolnTraffic.length) {
        var lat = parseFloat(stations[i].lat);
        var lng = parseFloat(stations[i].long);
        LincolnTraffic[j].bikes = parseInt(stations[i].nbBikes);
        LincolnTraffic[j].docks = parseInt(stations[i].nbEmptyDocks);
        totalBikes += LincolnTraffic[j].bikes;
        totalDocks += LincolnTraffic[j].docks;
        for (var k = 0; k < LincolnTraffic[j].bikes; k++) {
          //scene.add(makeMesh(caBiModel, lat, lng, k*12, [0.2, 0.7, 0.8]));
          edges = new THREE.EdgesHelper(CaBiBike(38.889057, -77.03505, 0, 10*globalScale, [0.93, 0.15, 0.11]), 0x00ff00);
          edges.position.x = lngToX(lng);
          edges.position.y = k*12*globalScale;
          edges.position.z = latToZ(lat);
          edges.updateMatrix();
          scene.add(edges);
          }
        }
      else {
        console.log("Unrecognized station: " + stations[i].terminalName + " ( " + stations[i].name + ")");
        }
      }
    updateLabels();
    console.log("totalBikes: " + totalBikes);
    console.log("totalDocks: " + totalDocks);
    }
  catch(e) {
    console.log("PARSE ERROR:", e);
    console.log(responseText);
    return;
    }
  }

function addXRoofedBox(geometry, dimensions, roofHeight, roofIndent, position) {
  if (typeof position == 'undefined') {position = [0, 0, 0];}
  var base = geometry.vertices.length;
  addBoxSides(geometry, dimensions, position);
  // roof points:
  var xRoofHalf = dimensions[0]/2 - roofIndent;
  geometry.vertices.push(new THREE.Vector3( xRoofHalf + position[0], dimensions[1] + roofHeight + position[1], position[2]));
  geometry.vertices.push(new THREE.Vector3(-xRoofHalf + position[0], dimensions[1] + roofHeight + position[1], position[2]));
  // roof segments:
  geometry.faces.push(new THREE.Face3(base + 4, base + 9, base + 5), new THREE.Face3(base + 4, base + 8, base + 9));
  geometry.faces.push(new THREE.Face3(base + 5, base + 9, base + 6));
  geometry.faces.push(new THREE.Face3(base + 6, base + 8, base + 7), new THREE.Face3(base + 6, base + 9, base + 8));
  geometry.faces.push(new THREE.Face3(base + 7, base + 8, base + 4));
  }

function addYRoofedBox(geometry, dimensions, roofHeight, roofIndent, position) {
  if (typeof position == 'undefined') {position = [0, 0, 0];}
  var base = geometry.vertices.length;
  addBoxSides(geometry, dimensions, position);
  // roof points:
  var zRoofHalf = dimensions[2]/2 - roofIndent;
  geometry.vertices.push(new THREE.Vector3(position[0], dimensions[1] + roofHeight + position[1],  zRoofHalf + position[2]));
  geometry.vertices.push(new THREE.Vector3(position[0], dimensions[1] + roofHeight + position[1], -zRoofHalf + position[2]));
  // roof segments:
  geometry.faces.push(new THREE.Face3(base + 7, base + 8, base + 4), new THREE.Face3(base + 7, base + 9, base + 8));
  geometry.faces.push(new THREE.Face3(base + 4, base + 8, base + 5));
  geometry.faces.push(new THREE.Face3(base + 5, base + 9, base + 6), new THREE.Face3(base + 5, base + 8, base + 9));
  geometry.faces.push(new THREE.Face3(base + 6, base + 9, base + 7));
  }

function addBoxSides(geometry, dimensions, position) {
  if (typeof position == 'undefined') {position = [0, 0, 0];}
  var base = geometry.vertices.length;
  var xHalf = dimensions[0]/2;
  var y = dimensions[1];
  var zHalf = dimensions[2]/2;
  // base of box:
  geometry.vertices.push(new THREE.Vector3( xHalf + position[0], position[1],  zHalf + position[2]));
  geometry.vertices.push(new THREE.Vector3(-xHalf + position[0], position[1],  zHalf + position[2]));
  geometry.vertices.push(new THREE.Vector3(-xHalf + position[0], position[1], -zHalf + position[2]));
  geometry.vertices.push(new THREE.Vector3( xHalf + position[0], position[1], -zHalf + position[2]));
  // top of box:
  geometry.vertices.push(new THREE.Vector3( xHalf + position[0], y + position[1],  zHalf + position[2]));
  geometry.vertices.push(new THREE.Vector3(-xHalf + position[0], y + position[1],  zHalf + position[2]));
  geometry.vertices.push(new THREE.Vector3(-xHalf + position[0], y + position[1], -zHalf + position[2]));
  geometry.vertices.push(new THREE.Vector3( xHalf + position[0], y + position[1], -zHalf + position[2]));
  // four walls:
  geometry.faces.push(new THREE.Face3(base + 0, base + 5, base + 1), new THREE.Face3(base + 0, base + 4, base + 5));
  geometry.faces.push(new THREE.Face3(base + 1, base + 6, base + 2), new THREE.Face3(base + 1, base + 5, base + 6));
  geometry.faces.push(new THREE.Face3(base + 2, base + 7, base + 3), new THREE.Face3(base + 2, base + 6, base + 7));
  geometry.faces.push(new THREE.Face3(base + 3, base + 4, base + 0), new THREE.Face3(base + 3, base + 7, base + 4));
  }

function addCylinderDome(geometry, radius, baseHeight, domeHeight, segments, position) {
  // handle baseHeight == 0?
  if (typeof position == 'undefined') {position = [0, 0, 0];}
  var base = geometry.vertices.length;
  for (var i = 0; i < segments; i++) {
    var theta = 2*Math.PI*(i + 0.5)/segments;
    geometry.vertices.push(new THREE.Vector3(radius*Math.sin(theta) + position[0],              position[1], radius*Math.cos(theta) + position[2]));  // floor
    geometry.vertices.push(new THREE.Vector3(radius*Math.sin(theta) + position[0], baseHeight + position[1], radius*Math.cos(theta) + position[2]));  // straight up to base of dome
    for (var j = 1; j < 8; j++) {
      var phi = (Math.PI/2)*j/8;
      var sinPhi = Math.sin(phi);  // 0 to 1
      var cosPhi = Math.cos(phi);  // 1 to 0
      geometry.vertices.push(new THREE.Vector3(radius*cosPhi*Math.sin(theta) + position[0], baseHeight + domeHeight*sinPhi + position[1], radius*cosPhi*Math.cos(theta) + position[2]));
      }
    }
  var top = geometry.vertices.length;
  geometry.vertices.push(new THREE.Vector3(position[0], baseHeight + domeHeight + position[1], position[2]));
  var chunk = 9;  // number of points per slice
  for (var i = 0; i < segments; i++) {
    var sliceA = base + chunk*i;
    var sliceB = base + chunk*((i + 1) % segments);
    for (var j = 0; j < chunk - 1; j++) {
      var k = j + 1;
      geometry.faces.push(new THREE.Face3(sliceA + j, sliceB + k, sliceA + k), new THREE.Face3(sliceA + j, sliceB + j, sliceB + k));
      }
    geometry.faces.push(new THREE.Face3(sliceA + chunk - 1, sliceB + chunk - 1, top));
    }
  }

function addCircle(geometry, radius, segments, position) {
  if (typeof position == 'undefined') {position = [0, 0, 0];}
  for (var i = 0; i < segments; i++) {
    var theta = 2*Math.PI*i/segments;
    geometry.vertices.push(new THREE.Vector3(radius*Math.sin(theta) + position[0], position[1], radius*Math.cos(theta) + position[2]));
    }
  var center = geometry.vertices.length;
  geometry.vertices.push(new THREE.Vector3(position[0], position[1], position[2]));
  for (var i = 0; i < segments; i++) {
    var j = (i + 1) % segments;
    geometry.faces.push(new THREE.Face3(i, j, center));
    }
  }

function CaBiBikeModel(scale) {
  var geometry = new THREE.Geometry();
  x=0;y=0;z=0;
  // handlebars to front wheel:
  // slope of head tube/fork is 0.07 x / 0.19 y
  addTube(geometry, 0.03*scale, 12, true, [{P1: [x + 0.32*scale, y + 1.09*scale, z + 0.18*scale], P2: [x + 0.40*scale, y + 1.10*scale, z]}]);  // upper-right handlebar
  addTube(geometry, 0.03*scale, 12, true, [{P1: [x + 0.32*scale, y + 1.09*scale, z - 0.18*scale], P2: [x + 0.40*scale, y + 1.10*scale, z]}]);  // upper-left handlebar
  addTube(geometry, 0.03*scale, 12, false, [{P1: [x + 0.40*scale, y + 1.10*scale, z],              P2: [x + 0.47*scale, y + 0.91*scale, z]}]);  // upper head tube
  addTube(geometry, 0.03*scale, 12, false, [{P1: [x + 0.47*scale, y + 0.91*scale, z],              P2: [x + 0.547*scale, y + 0.701*scale, z]}], [2, 1, 3]);  // lower head tube
  addTube(geometry, 0.03*scale, 12, false, [{P1: [x + 0.54*scale, y + 0.72*scale, z + 0.06*scale], P2: [x + 0.68*scale, y + 0.34*scale, z + 0.06*scale]}]);  // right fork
  addTube(geometry, 0.03*scale, 12, false, [{P1: [x + 0.54*scale, y + 0.72*scale, z - 0.06*scale], P2: [x + 0.68*scale, y + 0.34*scale, z - 0.06*scale]}]);  // left fork
  addTube(geometry, 0.05*scale, 12, false, [{P1: [x + 0.487*scale, y + 0.834*scale, z],            P2: [x + 0.16*scale, y + 0.36*scale, z]}], [1, 2, 1]);  // down tube
  addTube(geometry, 0.05*scale, 12, false, [{P1: [x + 0.16*scale, y + 0.36*scale, z],            P2: [x - 0.07*scale, y + 0.36*scale, z]}], [1, 1, 2]);  // chain stay
  addTube(geometry, 0.03*scale, 12, false, [{P1: [x - 0.07*scale, y + 0.36*scale, z + 0.06*scale], P2: [x - 0.42*scale, y + 0.36*scale, z + 0.06*scale]}]);  // chain stay right fork
  addTube(geometry, 0.03*scale, 12, false, [{P1: [x - 0.07*scale, y + 0.36*scale, z - 0.06*scale], P2: [x - 0.42*scale, y + 0.36*scale, z - 0.06*scale]}]);  // chain stay left fork
  // seat support:
  addTube(geometry, 0.03*scale, 12, false, [{P1: [x - 0.23*scale, y + 0.91*scale, z],            P2: [x - 0.02*scale, y + 0.36*scale, z]}]);  // seat post
  addTube(geometry, 0.02*scale, 12, false, [{P1: [x - 0.13*scale, y + 0.66*scale, z], P2: [x - 0.23*scale, y + 0.62*scale, z + 0.06*scale]}]);  // upper-right seat stay
  addTube(geometry, 0.02*scale, 10, false, [{P1: [x - 0.13*scale, y + 0.66*scale, z], P2: [x - 0.23*scale, y + 0.62*scale, z - 0.06*scale]}]);  // upper-left seat stay
  addTube(geometry, 0.02*scale, 10, false, [{P1: [x - 0.44*scale, y + 0.34*scale, z + 0.06*scale], P2: [x - 0.23*scale, y + 0.62*scale, z + 0.06*scale]}]);  // lower-right seat stay
  addTube(geometry, 0.02*scale, 10, false, [{P1: [x - 0.44*scale, y + 0.34*scale, z - 0.06*scale], P2: [x - 0.23*scale, y + 0.62*scale, z - 0.06*scale]}]);  // lower-left seat stay
  addWheel(geometry, 0.32*scale, 0.02*scale, 16, 6, [x - 0.44*scale, y + 0.34*scale, z]);  // rear wheel
  addWheel(geometry, 0.32*scale, 0.02*scale, 16, 6, [x + 0.68*scale, y + 0.34*scale, z]);  // front wheel
  addXRects(geometry, [[-0.1*scale, 0.03*scale, 0.02*scale], [-0.07*scale, 0.04*scale, 0.06*scale], [0, 0.03*scale, 0.06*scale], [0.05*scale, 0.02*scale, 0.03*scale], [0.12*scale, 0.02*scale, 0.02*scale]], [x - 0.23*scale, y + 0.91*scale, z]);  // saddle
  return geometry;
  }

function CaBiBike(lat, lng, floor, scale, color) {
  return makeMesh(CaBiBikeModel(scale), lat, lng, floor, color);  // yellow: [0.98, 0.78, 0.00]
  }

function addXRects(geometry, rectCorners, position) {
  if (typeof position == 'undefined') {position = [0, 0, 0];}
  var top = geometry.vertices.length;
  for (var i = 0; i < rectCorners.length; i++) {
    // mirror along the X axis
    geometry.vertices.push(new THREE.Vector3(position[0] + rectCorners[i][0], position[1] + rectCorners[i][1], position[2] + rectCorners[i][2]));
    geometry.vertices.push(new THREE.Vector3(position[0] + rectCorners[i][0], position[1] - rectCorners[i][1], position[2] + rectCorners[i][2]));
    geometry.vertices.push(new THREE.Vector3(position[0] + rectCorners[i][0], position[1] - rectCorners[i][1], position[2] - rectCorners[i][2]));
    geometry.vertices.push(new THREE.Vector3(position[0] + rectCorners[i][0], position[1] + rectCorners[i][1], position[2] - rectCorners[i][2]));
    }
  geometry.faces.push(new THREE.Face3(top, top + 2, top + 1), new THREE.Face3(top, top + 3, top + 2));
  for (var i = 0; i < rectCorners.length - 1; i++) {
    var section = top + 4*i;
    geometry.faces.push(new THREE.Face3(section + 0, section + 4, section + 7), new THREE.Face3(section + 0, section + 7, section + 3));
    geometry.faces.push(new THREE.Face3(section + 1, section + 5, section + 4), new THREE.Face3(section + 1, section + 4, section + 0));
    geometry.faces.push(new THREE.Face3(section + 2, section + 6, section + 5), new THREE.Face3(section + 2, section + 5, section + 1));
    geometry.faces.push(new THREE.Face3(section + 3, section + 7, section + 6), new THREE.Face3(section + 3, section + 6, section + 2));
    }
  top += 4*(rectCorners.length - 1);
  geometry.faces.push(new THREE.Face3(top, top + 1, top + 2), new THREE.Face3(top, top + 2, top + 3));
  }

function addWheel(geometry, majorRadius, minorRadius, majorSegments, minorSegments, position) {
  // add a torus in the XY plane
  if (typeof position == 'undefined') {position = [0, 0, 0];}
  var z = position[2];
  var top = geometry.vertices.length;
  for (var i = 0; i < majorSegments; i++) {
    var majorTheta = 2*Math.PI*i/majorSegments;
    var x = majorRadius*Math.sin(majorTheta) + position[0];
    var y = majorRadius*Math.cos(majorTheta) + position[1];
    for (var j = 0; j < minorSegments; j++) {
      var minorTheta = 2*Math.PI*j/minorSegments;
      geometry.vertices.push(new THREE.Vector3(x + minorRadius*Math.sin(majorTheta)*Math.cos(minorTheta), y + minorRadius*Math.cos(majorTheta)*Math.cos(minorTheta), z + minorRadius*Math.sin(minorTheta)));
      }
    }
  for (var i = 0; i < majorSegments; i++) {
    var a = top + minorSegments*i;
    var b = top + minorSegments*((i + 1) % majorSegments);
    for (var j = 0; j < minorSegments; j++) {
      var k = (j + 1) % minorSegments;
      geometry.faces.push(new THREE.Face3(a + j, a + k, b + k), new THREE.Face3(a + j, b + k, b + j));
      }
    }
  }

function addTube(geometry, radius, segments, capFirstPoint, cylinders, scale) {
  if (typeof scale == 'undefined') {scale = [1, 1, 1];}
  for (var i = 0; i < cylinders.length; i++) {
    var bases = createCylinderVertices(geometry, radius, segments, cylinders[i].P1, cylinders[i].P2, scale);
    if (capFirstPoint) {
      var top = geometry.vertices.length;
      geometry.vertices.push(new THREE.Vector3(cylinders[0].P1[0], cylinders[0].P1[1], cylinders[0].P1[2]));
      }
    for (var j = 0; j < bases.C1.length; j++) {
      var k = (j + 1) % bases.C1.length;
      geometry.faces.push(new THREE.Face3(bases.C1[j], bases.C2[k], bases.C2[j]), new THREE.Face3(bases.C1[j], bases.C1[k], bases.C2[k]));
      if (capFirstPoint) {
        geometry.faces.push(new THREE.Face3(bases.C1[j], top, bases.C1[k]));
        }
      }
    }
  }

function createCylinderVertices(geometry, radius, segments, P1, P2, scale) {
  if (typeof scale == 'undefined') {scale = [1, 1, 1];}
  // given a line segment from P1 to P2,
  // add to "geometry" the vertices needed to form the top and bottom circular bases of a cylinder of a given radius,
  // each circle having "segments" number of points
  var result = {C1: [], C2: []};
  // Q = P1→P2 moved to origin
  var Qx = P2[0] - P1[0];
  var Qy = P2[1] - P1[1];
  var Qz = P2[2] - P1[2];
  // Create vectors U and V that are (1) mutually perpendicular and (2) perpendicular to Q
  if (Qx != 0) {  // create a perpendicular vector on the XY plane
    // there are an infinite number of potential vectors; arbitrarily select y = 1
    var Ux = -Qy/Qx;
    var Uy = 1;
    var Uz = 0;
    // to prove U is perpendicular to Q:
    // (Qx, Qy, Qz)·(Ux, Uy, Uz) = Qx·Ux + Qy·Uy + Qz·Uz = Qx·-Qy/Qx + Qy·1 + Qz·0 = -Qy + Qy + 0 = 0
    }
  else if (Qy != 0) {  // create a perpendicular vector on the YZ plane
    var Ux = 0;
    var Uy = -Qz/Qy;
    var Uz = 1;
    }
  else {  // assume Qz != 0; create a perpendicular vector on the XZ plane
    var Ux = 1;
    var Uy = 0;
    var Uz = -Qx/Qz;
    }
  // The cross product of two vectors is perpendicular to both, so to find V:
  // (Vx, Vy, Vz) = (Qx, Qy, Qz)×(Ux, Uy, Uz) = (Qy×Uz - Qz×Uy, Qz×Ux - Qx×Uz, Qx×Uy - Qy×Ux)
  var Vx = Qy*Uz - Qz*Uy;
  var Vy = Qz*Ux - Qx*Uz;
  var Vz = Qx*Uy - Qy*Ux;
  // normalize U and V:
  var Ulength = Math.sqrt(Math.pow(Ux, 2) + Math.pow(Uy, 2) + Math.pow(Uz, 2));
  var Vlength = Math.sqrt(Math.pow(Vx, 2) + Math.pow(Vy, 2) + Math.pow(Vz, 2));
  Ux /= Ulength;
  Uy /= Ulength;
  Uz /= Ulength;
  Vx /= Vlength;
  Vy /= Vlength;
  Vz /= Vlength;
  for (var i = 0; i < segments; i++) {
    var theta = 2*Math.PI*i/segments;  // theta
    var dx = scale[0]*radius*(Math.cos(theta)*Ux + Math.sin(theta)*Vx);
    var dy = scale[1]*radius*(Math.cos(theta)*Uy + Math.sin(theta)*Vy);
    var dz = scale[2]*radius*(Math.cos(theta)*Uz + Math.sin(theta)*Vz);
    result.C1.push(geometry.vertices.length);
    geometry.vertices.push(new THREE.Vector3(P1[0] + dx, P1[1] + dy, P1[2] + dz));
    result.C2.push(geometry.vertices.length);
    geometry.vertices.push(new THREE.Vector3(P2[0] + dx, P2[1] + dy, P2[2] + dz));
    }
  return result;
  }

function drawLine(x1, y1, z1, x2, y2, z2, color) {
  var material = new THREE.LineBasicMaterial({color: color});
  var linegeo = new THREE.Geometry();
  linegeo.vertices.push(new THREE.Vector3(x1, y1, z1), new THREE.Vector3(x2, y2, z2));
  var line = new THREE.Line( linegeo, material );
  scene.add(line);
  }

function addClippedCylinderDome(geometry, radius, baseHeight, domeHeight, bounds, position) {
  if (typeof position == 'undefined') {position = [0, 0, 0];}
  var oldBase = geometry.vertices.length;
  addCylinderDome(geometry, radius, baseHeight, domeHeight, 24);
  var newBase = geometry.vertices.length;
  var boundsXHalf = bounds[0]/2;
  var boundsZHalf = bounds[1]/2;
  for (var i = oldBase; i < newBase; i++) {
    var v = geometry.vertices[i];
    if (Math.abs(v.x) > boundsXHalf) {
      if (v.x < 0) {v.x = -boundsXHalf;}
      else         {v.x =  boundsXHalf;}
      }
    if (Math.abs(v.z) > boundsZHalf) {
      if (v.z < 0) {v.z = -boundsZHalf;}
      else         {v.z =  boundsZHalf;}
      }
    v.x += position[0];
    v.y += position[1];
    v.z += position[2];
    }
  }

function addCylinderConeTopBottom(geometry, radius, baseHeight, bottomHeight, topHeight, cylSegments, position) {
  if (typeof position == 'undefined') {position = [0, 0, 0];}
  var base = geometry.vertices.length;
  for (var i = 0; i < cylSegments; i++) {
    var theta = 2*Math.PI*(i + 0.5)/cylSegments;  // the 0.5 puts a flat edge at the axes rather than a corner
    geometry.vertices.push(new THREE.Vector3(radius*Math.sin(theta) + position[0],              position[1], radius*Math.cos(theta) + position[2]));  // floor
    geometry.vertices.push(new THREE.Vector3(radius*Math.sin(theta) + position[0], baseHeight + position[1], radius*Math.cos(theta) + position[2]));  // straight up to base of cone
    }
  var tips = geometry.vertices.length;
  geometry.vertices.push(new THREE.Vector3(position[0],          -bottomHeight + position[1], position[2]));
  geometry.vertices.push(new THREE.Vector3(position[0], baseHeight + topHeight + position[1], position[2]));
  for (var i = 0; i < cylSegments; i++) {
    var sliceA = base + 2*i;
    var sliceB = base + 2*((i + 1) % cylSegments);
    geometry.faces.push(new THREE.Face3(sliceA, sliceB + 1, sliceA + 1), new THREE.Face3(sliceA, sliceB, sliceB + 1));
    geometry.faces.push(new THREE.Face3(sliceB,     sliceA,     tips));
    geometry.faces.push(new THREE.Face3(sliceA + 1, sliceB + 1, tips + 1));
    }
  }

function addCylinder(geometry, radius, baseHeight, cylSegments, position) {
  if (typeof position == 'undefined') {position = [0, 0, 0];}
  var base = geometry.vertices.length;
  for (var i = 0; i < cylSegments; i++) {
    var theta = 2*Math.PI*(i + 0.5)/cylSegments;  // the 0.5 puts a flat edge at the axes rather than a corner
    geometry.vertices.push(new THREE.Vector3(radius*Math.sin(theta) + position[0],              position[1], radius*Math.cos(theta) + position[2]));  // floor
    geometry.vertices.push(new THREE.Vector3(radius*Math.sin(theta) + position[0], baseHeight + position[1], radius*Math.cos(theta) + position[2]));  // straight up to base of cone
    }
  for (var i = 0; i < cylSegments; i++) {
    var sliceA = base + 2*i;
    var sliceB = base + 2*((i + 1) % cylSegments);
    geometry.faces.push(new THREE.Face3(sliceA, sliceB + 1, sliceA + 1), new THREE.Face3(sliceA, sliceB, sliceB + 1));
    }
  }

function addCylinderConeTop(geometry, radius, baseHeight, coneHeight, cylSegments, position) {
  if (typeof position == 'undefined') {position = [0, 0, 0];}
  var base = geometry.vertices.length;
  for (var i = 0; i < cylSegments; i++) {
    var theta = 2*Math.PI*(i + 0.5)/cylSegments;  // the 0.5 puts a flat edge at the axes rather than a corner
    geometry.vertices.push(new THREE.Vector3(radius*Math.sin(theta) + position[0],              position[1], radius*Math.cos(theta) + position[2]));  // floor
    geometry.vertices.push(new THREE.Vector3(radius*Math.sin(theta) + position[0], baseHeight + position[1], radius*Math.cos(theta) + position[2]));  // straight up to base of cone
    }
  var top = geometry.vertices.length;
  geometry.vertices.push(new THREE.Vector3(position[0], baseHeight + coneHeight + position[1], position[2]));
  for (var i = 0; i < cylSegments; i++) {
    var sliceA = base + 2*i;
    var sliceB = base + 2*((i + 1) % cylSegments);
    geometry.faces.push(new THREE.Face3(sliceA, sliceB + 1, sliceA + 1), new THREE.Face3(sliceA, sliceB, sliceB + 1));
    geometry.faces.push(new THREE.Face3(sliceA + 1, sliceB + 1, top));
    }
  }

function addBox(geometry, dimensions, position) {
  var base = geometry.vertices.length;
  addBoxSides(geometry, dimensions, position);
  // add top:
  geometry.faces.push(new THREE.Face3(base + 4, base + 6, base + 5), new THREE.Face3(base + 4, base + 7, base + 6));
  }

function addRaisedPyramid(geometry, lowerDimensions, upperDimensions, lowerHeight, upperHeight, position) {
  // pyramid on a box
  if (typeof position == 'undefined') {position = [0, 0, 0];}
  addBoxSides(geometry, [lowerDimensions[0], lowerHeight, lowerDimensions[1]], position);
  addPyramid(geometry, lowerDimensions, upperDimensions, upperHeight, [position[0], position[1] + lowerHeight, position[2]])
  var base = geometry.vertices.length;
  }

function addPyramid(geometry, lowerDimensions, upperDimensions, height, position) {
  if (typeof position == 'undefined') {position = [0, 0, 0];}
  var base = geometry.vertices.length;
  var lowerXHalf = lowerDimensions[0]/2;
  var lowerZHalf = lowerDimensions[1]/2;
  var upperXHalf = upperDimensions[0]/2;
  var upperZHalf = upperDimensions[1]/2;
  // base of box:
  geometry.vertices.push(new THREE.Vector3( lowerXHalf + position[0], position[1],  lowerZHalf + position[2]));
  geometry.vertices.push(new THREE.Vector3(-lowerXHalf + position[0], position[1],  lowerZHalf + position[2]));
  geometry.vertices.push(new THREE.Vector3(-lowerXHalf + position[0], position[1], -lowerZHalf + position[2]));
  geometry.vertices.push(new THREE.Vector3( lowerXHalf + position[0], position[1], -lowerZHalf + position[2]));
  // top of box:
  geometry.vertices.push(new THREE.Vector3( upperXHalf + position[0], height + position[1],  upperZHalf + position[2]));
  geometry.vertices.push(new THREE.Vector3(-upperXHalf + position[0], height + position[1],  upperZHalf + position[2]));
  geometry.vertices.push(new THREE.Vector3(-upperXHalf + position[0], height + position[1], -upperZHalf + position[2]));
  geometry.vertices.push(new THREE.Vector3( upperXHalf + position[0], height + position[1], -upperZHalf + position[2]));
  // four walls:
  geometry.faces.push(new THREE.Face3(base + 0, base + 5, base + 1), new THREE.Face3(base + 0, base + 4, base + 5));
  geometry.faces.push(new THREE.Face3(base + 1, base + 6, base + 2), new THREE.Face3(base + 1, base + 5, base + 6));
  geometry.faces.push(new THREE.Face3(base + 2, base + 7, base + 3), new THREE.Face3(base + 2, base + 6, base + 7));
  geometry.faces.push(new THREE.Face3(base + 3, base + 4, base + 0), new THREE.Face3(base + 3, base + 7, base + 4));
  // top:
  geometry.faces.push(new THREE.Face3(base + 4, base + 6, base + 5), new THREE.Face3(base + 4, base + 7, base + 6));
  }

function addPolygon(geometry, points, height, useOriginForRoof, position) {
  if (typeof position == 'undefined') {position = [0, 0, 0];}
  var base = geometry.vertices.length;
  for (var i = 0; i < points.length; i++) {
    geometry.vertices.push(new THREE.Vector3(-points[i][0] + position[0],          position[1], points[i][1] + position[2]));
    geometry.vertices.push(new THREE.Vector3(-points[i][0] + position[0], height + position[1], points[i][1] + position[2]));
    }
  if (useOriginForRoof) {
    var centerTop = geometry.vertices.length;
    geometry.vertices.push(new THREE.Vector3(position[0], height + position[1], position[2]));
    }
  for (var i = 0; i < points.length; i++) {
    var a = base + 2*i;
    var b = base + 2*((i + 1) % points.length);
    geometry.faces.push(new THREE.Face3(a, a + 1, b + 1), new THREE.Face3(a, b + 1, b));
    if (useOriginForRoof) {
      geometry.faces.push(new THREE.Face3(a + 1, centerTop, b + 1));
      }
    else if (i < points.length - 2) {
      geometry.faces.push(new THREE.Face3(base + 1, a + 5, a + 3));
      }
    }
  }

function WashingtonMonument(lat, lng) {
  var obeliskGeometry = new THREE.Geometry();
  var height = 169.29;  // height in meters
  var pyramidBase = 0.9*height;
  var pyramidHalfWidth = 0.03*height;
  var bottomHalfWidth = 0.05*height;
  // Define each vertex:
  // The bottom plane:
  obeliskGeometry.vertices.push(new THREE.Vector3( bottomHalfWidth,            0,  bottomHalfWidth));
  obeliskGeometry.vertices.push(new THREE.Vector3( bottomHalfWidth,            0, -bottomHalfWidth));
  obeliskGeometry.vertices.push(new THREE.Vector3(-bottomHalfWidth,            0, -bottomHalfWidth));
  obeliskGeometry.vertices.push(new THREE.Vector3(-bottomHalfWidth,            0,  bottomHalfWidth));
  // Base of the pyramid:
  obeliskGeometry.vertices.push(new THREE.Vector3( pyramidHalfWidth, pyramidBase,  pyramidHalfWidth));
  obeliskGeometry.vertices.push(new THREE.Vector3( pyramidHalfWidth, pyramidBase, -pyramidHalfWidth));
  obeliskGeometry.vertices.push(new THREE.Vector3(-pyramidHalfWidth, pyramidBase, -pyramidHalfWidth));
  obeliskGeometry.vertices.push(new THREE.Vector3(-pyramidHalfWidth, pyramidBase,  pyramidHalfWidth));
  // The tippy-top:
  obeliskGeometry.vertices.push(new THREE.Vector3(0, height, 0));
  // Create the faces:
  // Floor:
  obeliskGeometry.faces.push(new THREE.Face3(0, 2, 1), new THREE.Face3(0, 3, 2));
  // The four main sides (each side is two triangles):
  obeliskGeometry.faces.push(new THREE.Face3(0, 1, 5), new THREE.Face3(0, 5, 4));
  obeliskGeometry.faces.push(new THREE.Face3(1, 2, 6), new THREE.Face3(1, 6, 5));
  obeliskGeometry.faces.push(new THREE.Face3(2, 3, 7), new THREE.Face3(2, 7, 6));
  obeliskGeometry.faces.push(new THREE.Face3(3, 0, 4), new THREE.Face3(3, 4, 7));
  // Four sides of the pyramid:
  obeliskGeometry.faces.push(new THREE.Face3(4, 5, 8));
  obeliskGeometry.faces.push(new THREE.Face3(6, 7, 8));
  obeliskGeometry.faces.push(new THREE.Face3(5, 6, 8));
  obeliskGeometry.faces.push(new THREE.Face3(7, 4, 8));
  return makeMesh(obeliskGeometry, lat, lng, 0);
  }

function WhiteHouse(lat, lng) {
  var geometry = new THREE.Geometry();
  box = makeBox(51, 13.5, 26,  0.0);  geometry.merge(box.geometry, box.matrix);  // main building
  box = makeBox(31,  1.0,  6, 13.5);  geometry.merge(box.geometry, box.matrix);  // sun roof
  box = makeBox(14,  1.0, 13, 0);
  box.position.set(0, 11.5, 19.5);
  box.updateMatrix();
  geometry.merge(box.geometry, box.matrix);  // north portico
  var box = makeCylinder(9, 9, 1, 28, 11.5);
  box.position.set(0, 12, -13);
  box.updateMatrix();
  geometry.merge(box.geometry, box.matrix);  // south balcony roof
  var box = makeCylinder(9, 9, 3.5, 28, 0);
  box.position.set(0, 1.75, -13);
  box.updateMatrix();
  geometry.merge(box.geometry, box.matrix);  // south balcony base
  var cylgeo = new THREE.CylinderGeometry(0.25, 0.25, 8, 8);  // radiusTop, radiusBottom, height, segments
  var column = new THREE.Mesh(cylgeo);
  for (var i = 0; i < 8; i++) {  // south balcony columns
    column.position.set(8.75*Math.cos(Math.PI*i/7), 7.5, -8.75*Math.sin(Math.PI*i/7) - 13);
    column.updateMatrix();
    geometry.merge(column.geometry, column.matrix);
    }
  var cylgeo = new THREE.CylinderGeometry(0.5, 0.5, 11, 8);  // radiusTop, radiusBottom, height, segments
  var column = new THREE.Mesh(cylgeo);
  column.position.set(-6.5, 5.5, 21.5);  column.updateMatrix();  geometry.merge(column.geometry, column.matrix);
  column.position.set(-6.5, 5.5, 18.5);  column.updateMatrix();  geometry.merge(column.geometry, column.matrix);
  column.position.set(-6.5, 5.5, 25.5);  column.updateMatrix();  geometry.merge(column.geometry, column.matrix);
  column.position.set(-2.2, 5.5, 25.5);  column.updateMatrix();  geometry.merge(column.geometry, column.matrix);
  column.position.set( 2.2, 5.5, 25.5);  column.updateMatrix();  geometry.merge(column.geometry, column.matrix);
  column.position.set( 6.5, 5.5, 25.5);  column.updateMatrix();  geometry.merge(column.geometry, column.matrix);
  column.position.set( 6.5, 5.5, 21.5);  column.updateMatrix();  geometry.merge(column.geometry, column.matrix);
  column.position.set( 6.5, 5.5, 18.5);  column.updateMatrix();  geometry.merge(column.geometry, column.matrix);
  return makeMesh(geometry, lat, lng, 0);
  }

function makeRoundObject(pattern, segments, lat, lng) {
  // build an object that has rotational symmetry around the Y axis; similar to a lathe
  // pattern:  array of {x, y} points defining the shapes's cutaway silhouette in the 1st quadrant of the X-Y Plane
  //           closure is not automatic; repeat the first point at the end in order to make a closed object
  // segments: how many times to create vertexes, rotating around the Y axis
  // lat, lng: where to place the center of the object on the X-Z place
  var geometry = new THREE.Geometry();
  var maxHeight = pattern[0].y;
  for (var j = 1; j < pattern.length; j++) {
    maxHeight = Math.max(maxHeight, pattern[j].y);
    }
  for (var i = 0; i < segments; i++) {  // each segment
    var theta = 2*Math.PI*i/segments;
    for (var j = 0; j < pattern.length; j++) {  // each point for this segment
      geometry.vertices.push(new THREE.Vector3(pattern[j].x*Math.sin(theta),  pattern[j].y, pattern[j].x*Math.cos(theta)));
      }
    }
  for (var i = 0; i < segments; i++) {  // each segment
    var a = pattern.length*i;
    var b = pattern.length*((i + 1) % segments);
    for (var j = 0; j < pattern.length - 1; j++) {  // each face for this and the next segment
      var k = j + 1
      geometry.faces.push(new THREE.Face3(a + j, b + k, a + k), new THREE.Face3(a + j, b + j, b + k));
      }
    }
  geometry.computeFaceNormals();  // required to show directional light
  var object = new THREE.Mesh(geometry, new THREE.MeshLambertMaterial({vertexColors: THREE.VertexColors}));
  object.scale.x = object.scale.y = object.scale.z = globalScale;
  //object.position.set(lngToX(lng), maxHeight/2 + floor, latToZ(lat));
  object.position.set(lngToX(lng), 0, latToZ(lat));
  object.updateMatrix();
  return object;
  }

function makeCylinder(radiusTop, radiusBottom, height, segments, floor) {
  var geometry = new THREE.CylinderGeometry(radiusTop, radiusBottom, height, segments);
  var cylinder = new THREE.Mesh(geometry);
  cylinder.position.y = height/2 + floor;
  cylinder.updateMatrix();
  return cylinder;
  }

function makeBox(depth, height, width, floor) {
  var box = new THREE.CubeGeometry(depth, height, width);
  var mesh = new THREE.Mesh(box);
  mesh.position.y = height/2 + floor;
  mesh.updateMatrix();
  return mesh;
  }

function makeCube(depth, height, width, dx, dz) {
  var box = new THREE.CubeGeometry(depth, height, width);
  var mesh = new THREE.Mesh(box);
  mesh.position.set(dx, height/2, dz);
  mesh.updateMatrix();
  return mesh;
  }

function AirSpaceMuseum(lat, lng) {
  var geometry = new THREE.Geometry();
  box = makeBox(196, 20, 61, 0);  geometry.merge(box.geometry, box.matrix);
  box = makeBox( 25, 25, 69, 0);  box.position.x = -29.5; box.updateMatrix();  geometry.merge(box.geometry, box.matrix);
  box = makeBox( 25, 25, 69, 0);  box.position.x =  29.5; box.updateMatrix();  geometry.merge(box.geometry, box.matrix);
  box = makeBox( 25, 25, 25, 0);  box.position.x =  88.5; box.position.z =  21; box.updateMatrix();  geometry.merge(box.geometry, box.matrix);
  box = makeBox( 11, 25, 17, 0);  box.position.x =  81.5; box.position.z =   0; box.updateMatrix();  geometry.merge(box.geometry, box.matrix);
  box = makeBox( 25, 25, 25, 0);  box.position.x =  88.5; box.position.z = -21; box.updateMatrix();  geometry.merge(box.geometry, box.matrix);
  box = makeBox( 25, 25, 25, 0);  box.position.x = -88.5; box.position.z =  21; box.updateMatrix();  geometry.merge(box.geometry, box.matrix);
  box = makeBox( 11, 25, 17, 0);  box.position.x = -81.5; box.position.z =   0; box.updateMatrix();  geometry.merge(box.geometry, box.matrix);
  box = makeBox( 25, 25, 25, 0);  box.position.x = -88.5; box.position.z = -21; box.updateMatrix();  geometry.merge(box.geometry, box.matrix);
  box = makeBox(152, 21, 13, 0);                          box.position.z = -15; box.updateMatrix();  geometry.merge(box.geometry, box.matrix);
  box = makeBox( 22, 17, 12, 4);  box.position.x = -59.0; box.position.z = -27.5; box.updateMatrix();  geometry.merge(box.geometry, box.matrix);
  box = makeBox( 22, 17, 12, 4);                          box.position.z = -27.5; box.updateMatrix();  geometry.merge(box.geometry, box.matrix);
  box = makeBox( 22, 17, 12, 4);  box.position.x =  59.0; box.position.z = -27.5; box.updateMatrix();  geometry.merge(box.geometry, box.matrix);
  return makeMesh(geometry, lat, lng, 0);
  }

function AlexandriaLodge(lat, lng) {
  var geometry = new THREE.Geometry();
  box = makeBox(68,  1.0, 78,  0.0);      geometry.merge(box.geometry, box.matrix);  // basement level
  box = makeBox(50, 18.9, 60,  0.0);      geometry.merge(box.geometry, box.matrix);  // main structure
  box = makeBox(22, 27.5, 34,  0.0);      geometry.merge(box.geometry, box.matrix);  // 2nd segment
  box = makeBox(16, 46.5, 22,  0.0);      geometry.merge(box.geometry, box.matrix);  // 3rd segment
  box = makeBox(14, 63.8, 18,  0.0);      geometry.merge(box.geometry, box.matrix);  //
  box = makeBox(10, 79.2, 14,  0.0);      geometry.merge(box.geometry, box.matrix);  //
  box = makeBox( 8, 86.0, 10,  0.0);      geometry.merge(box.geometry, box.matrix);  //
  box = makeCube(18, 22.6, 15, 0, 24.5);  geometry.merge(box.geometry, box.matrix);  // front extrusion
  for (var i = 0; i < 10; i++) {
    box = makeBox(7 - i*0.5, 87.4 + 1.4*i, 9 - i*0.5,  0.0);  geometry.merge(box.geometry, box.matrix);  // pyramidal top
    }
  return makeMesh(geometry, lat, lng, 0);
  }

function shiftVertices(vertices, dx, dy, dz) {
  for (var i = 0; i < vertices.length; i++) {
    vertices[i].x += dx;
    vertices[i].y += dy;
    vertices[i].z += dz;
    }
  }

function LOC_Jefferson(lat, lng) {
  var geometry = new THREE.Geometry();
  addCylinderConeTop(geometry, 21.5, 31, 0, 8);  // base of main reading room
  addCylinderDome(geometry, 17.0, 5, 11, 8, [0, 31, 0]);  // dome of main reading room
  addCylinderConeTop(geometry, 5, 16, 0, 8, [0, 31, 0]);  // cupola base
  addCylinderDome(geometry, 3.5, 18, 4, 8, [0, 31, 0]);  // cupola
  addBox(geometry, [8, 28, 12], [23.5, 0, 0]);  // Great Hall to main reading room
  addYRoofedBox(geometry, [32, 30, 43], 5, 16, [43.5, 0, 0]);  // Great Hall
  addBox(geometry, [37, 25, 109], [-13.5, 0, 0]);  // eastern container
  addYRoofedBox(geometry, [23, 5, 109], 2, 11, [-20.5, 25, 0]);  // eastern upper portion
  addXRoofedBox(geometry, [67, 25, 12], 1, 0, [1.5, 0,  60.5]);  // northern hall
  addXRoofedBox(geometry, [67, 25, 12], 1, 0, [1.5, 0, -60.5]);  // southern hall
  addYRoofedBox(geometry, [12, 25, 109], 1, 0, [41, 0, 0]);  // western hall
  addYRoofedBox(geometry, [12, 25, 109], 1, 0, [-38, 0, 0]);  // eastern hall
  addRaisedPyramid(geometry, [16, 16], [2, 2], 27.5, 2.5, [ 41, 0,  60.5]);  // corner square
  addRaisedPyramid(geometry, [16, 16], [2, 2], 27.5, 2.5, [-38, 0,  60.5]);  // corner square
  addRaisedPyramid(geometry, [16, 16], [2, 2], 27.5, 2.5, [ 41, 0, -60.5]);  // corner square
  addRaisedPyramid(geometry, [16, 16], [2, 2], 27.5, 2.5, [-38, 0, -60.5]);  // corner square
  addBox(geometry, [2, 30, 7.5], [60.5, 0, 17.6]);  // Great Hall bump-out
  addBox(geometry, [2, 30, 7.5], [60.5, 0, -17.6]);  // Great Hall bump-out
  addBox(geometry, [24, 27.5, 26], [-38, 0, 0]);  // eastern structure
  addBox(geometry, [10, 5, 14], [64.5, 0, 0]);  // western porch
  return makeMesh(geometry, lat, lng, 0);
  }

function ReevesBuilding(lat, lng) {
  var geometry = new THREE.Geometry();
  addBox(geometry, [13, 21, 74]);
  addBox(geometry, [41, 18, 24], [21, 0, -29]);
  addBox(geometry, [19, 18, 64], [3, 0, 15]);
  addBox(geometry, [26, 18, 19], [-16.5, 0, 39.5]);
  addBox(geometry, [23, 13.5, 48], [-18, 0,  6]);
  addBox(geometry, [11, 13.5, 59], [ 12, 0,  17.5]);
  addXRoofedBox(geometry, [6,  9, 6], 2, 0, [ -9.5, 0,  -21]);
  addXRoofedBox(geometry, [6,  9, 6], 2, 0, [ -9.5, 0,  -27]);
  addXRoofedBox(geometry, [9,  6, 6], 2, 0, [ -11, 0,  -27]);
  addXRoofedBox(geometry, [9,  6, 6], 2, 0, [ -11, 0,  -33]);
  for (var i = 0; i < 8; i++) {
    addXRoofedBox(geometry, [6,  1.5, 6], 2, 0, [ -9.5, 13.5,  -15 + i*6]);  // rooftop triangles
    }
  return makeMesh(geometry, lat, lng, 0);
  }

function NGAWest(lat, lng) {
  var geometry = new THREE.Geometry();
  addYRoofedBox(geometry, [34, 28, 76], 3, 0);
  addBox(geometry, [178, 28, 30]);
  addBox(geometry, [238, 24, 50]);
  addBox(geometry, [42, 24, 90], [-75, 0, 0]);
  addBox(geometry, [42, 24, 90], [ 75, 0, 0]);
  addBox(geometry, [42, 32, 30]);
  addBox(geometry, [30, 32, 42]);
  addCylinderDome(geometry, 16, 34, 10, 24);
  return makeMesh(geometry, lat, lng, 0);
  }

function NGAEast(lat, lng) {
  var geometry = new THREE.Geometry();
  addPolygon(geometry, [[-42.5, -30], [-42.5, 30], [42.5, 0]], 18.0, false);  // atrium; lowest space
  addPolygon(geometry, [[-42.5, -21], [-68, -30], [-68, 39], [-42.5, 30]], 19.3, false);  // western section
  addPolygon(geometry, [[-42.5,  13], [-68, 21], [-68, 39], [-42.5, 30]], 35.4, false);  // northwest tower
  addPolygon(geometry, [[-42.5, -21], [-68, -30], [-68, -13], [-42.5, -4]], 35.4, false);  // southwest tower
  addPolygon(geometry, [[ 34, 3], [8.5, -6], [-17, 3], [8.5, 12]], 35.4, false);  // east tower
  addPolygon(geometry, [[ 34, 3], [8.5, -6], [-42.5, 12], [-42.5, 30]], 19.3, false);  // northern section
  addPolygon(geometry, [[ 42.5, 0], [42.5, -39], [-68, -39]], 25.4, false);
  addPolygon(geometry, [[ 42.5, 0], [42.5, -39], [21.25, -31.5], [21.25, -7.5]], 35.4, false);
  addPolygon(geometry, [[ 42.5, 0], [42.5, -9], [-42.5, -39], [-68, -39]], 35.4, false);
  return makeMesh(geometry, lat, lng, 0);
  }

function makeMesh(geometry, lat, lng, elv, color) {
  geometry.computeFaceNormals();  // required to show directional light
  if (typeof color != 'undefined') {
    for (var i = 0; i < geometry.faces.length; i++) {
      geometry.faces[i].color.setRGB(color[0], color[1], color[2]);
      }
    }
  var mesh = new THREE.Mesh(geometry, new THREE.MeshLambertMaterial({vertexColors: THREE.VertexColors}));  // skip side: THREE.DoubleSide
  mesh.scale.x = mesh.scale.y = mesh.scale.z = globalScale;
  mesh.position.set(lngToX(lng), elv*globalScale, latToZ(lat));
  mesh.updateMatrix();
  return mesh;
  }

function NaturalHistoryMuseum(lat, lng) {
  var geometry = new THREE.Geometry();
  addXRoofedBox(geometry, [36,  28, 28], 6, 0);
  addYRoofedBox(geometry, [28,  28, 42], 6, 0);
  addBox(geometry, [170, 24, 36]);
  addCylinderDome(geometry, 12, 34, 10, 24);
  shiftVertices(geometry.vertices, 0, 0, -43);  // move south
  addBox(geometry, [271, 18, 54]);
  addBox(geometry, [150, 22, 74]);
  addBox(geometry, [ 36, 24, 90]);
  return makeMesh(geometry, lat, lng, 0);
  }

function FreerGallery(lat, lng) {
  var geometry = new THREE.Geometry();
  addBox(geometry, [71, 14, 18], [  0, 0,  20]);  // northern section
  addBox(geometry, [24, 14, 22], [ 23, 0,   0]);  // eastern section
  addBox(geometry, [24, 14, 22], [-23, 0,   0]);  // western section
  addBox(geometry, [71, 14, 14], [  0, 0, -18]);  // southern section
  addBox(geometry, [22, 14,  1], [  0, 0, -25.5]);  // southern entrance
  addBox(geometry, [41, 14,  3], [  0, 0,  30.5]);  // northern entrance
  return makeMesh(geometry, lat, lng, 0);
  }

function AmericanHistoryMuseum(lat, lng) {
  var geometry = new THREE.Geometry();
  addBox(geometry, [148.2, 1, 54.6]);  // base
  for (var i = 0; i < 10; i++) {
    addBox(geometry, [7.8, 24, 2], [-70.2 + 15.6*i, 0,  26.3]);
    addBox(geometry, [7.8, 24, 2], [-70.2 + 15.6*i, 0, -26.3]);
    }
  for (var i = 0; i < 4; i++) {
    addBox(geometry, [2, 24, 7.8], [ 73.1, 0, -23.4 + 15.6*i]);
    addBox(geometry, [2, 24, 7.8], [-73.1, 0, -23.4 + 15.6*i]);
    }
  addBox(geometry, [144.2, 24, 50.6]);  // main structure
  addBox(geometry, [148.2,  1, 54.6], [0, 23.5, 0]);  // overhang
  addBox(geometry, [122, 27, 46]);  // lower roof structure
  addBox(geometry, [ 94, 30, 15]);  // upper roof structure
  return makeMesh(geometry, lat, lng, 0);
  }

function AfricanHistoryMuseum(lat, lng) {
  var geometry = new THREE.Geometry();
  addBox(geometry, [42, 35.2, 42]);  // rooftop structure
  addBox(geometry, [54, 30.2, 54]);  // central structure
  addPyramid(geometry, [54, 54], [64, 64], 8.4, [0, 5, 0]);  // lower section
  addPyramid(geometry, [54, 54], [64, 64], 8.4, [0, 13.4, 0]);  // middle section
  addPyramid(geometry, [54, 54], [64, 64], 8.4, [0, 21.8, 0]);  // upper section
  return makeMesh(geometry, lat, lng, 0);
  }

function SmithsonianCastle(lat, lng) {
  var geometry = new THREE.Geometry();
  addXRoofedBox(geometry, [98,  9, 15], 1, 0);  // main, lowest, structure
  addXRoofedBox(geometry, [60, 16, 15], 4, 0);  // east-west corridor
  addYRoofedBox(geometry, [ 8, 16, 32], 4, 0, [0, 0, 3]);  // north-south corridor
  addRaisedPyramid(geometry, [5, 5], [0.5, 0.5], 30, 5, [-30, 0, 9.5]);  // eastern-half north tower
  addRaisedPyramid(geometry, [7, 7], [0.5, 0.5], 30, 6, [-7.5, 0, 15.5]);  // eastern tower by north entrance
  addYRoofedBox(geometry, [ 7, 24, 7], 6, 0, [7.5, 0, 15.5]);   // western tower by north entrance (base)
  addCylinderConeTop(geometry, 3.4, 43, 0, 8, [7.5, 0, 15.5]);  // western tower by north entrance (top)
  addCylinderConeTop(geometry, 3.0, 44, 0, 8, [7.5, 0, 15.5]);  // western tower by north entrance (crown)
  addRaisedPyramid(geometry, [3, 3], [0.5, 0.5], 22, 6, [ 29, 0, 8.5]);  // western-half north tower
  addYRoofedBox(geometry, [12, 12, 21], 5, 0, [55, 0, 0]);  // western room
  addYRoofedBox(geometry, [15, 12, 24], 6, 3, [-56.5, 0, 0]);  // eastern room
  addRaisedPyramid(geometry, [4, 4], [0.5, 0.5], 22, 4, [62, 0, 8.5]);  // northwest corner tower
  addBox(geometry, [8, 30, 8], [0, 0, -17]);  // south tower
  addCylinderConeTop(geometry, 1.2, 34, 0, 8, [4.8, 0, -18]);  // south tower's turret
  addBox(geometry, [3, 16, 3], [28.5, 0, -9]);  // western-half south tower (base)
  addCylinderConeTop(geometry, 1.5, 12, 0, 8, [28.5, 16, -9]);  // western-half south tower (top)
  addBox(geometry, [3, 8, 3], [-29, 0, -8.5]);  // eastern-half south tower (base)
  addCylinderConeTop(geometry, 1.5, 16, 0, 8, [-29, 8, -8.5]);  // eastern-half south tower (top)
  addXRoofedBox(geometry, [11, 12, 7], 4, 0, [-62, 0, 0]);  // eastern  entrance (juts out 4m?)
  return makeMesh(geometry, lat, lng, 0);
  }

function IndianMuseum(lat, lng) {
  var geometry = new THREE.Geometry();
  addPolygon(geometry, [[38,-6],[32,-10],[25,-10],[23,-13],[20,-14],[12,-18],[10,-19],[0,-19],[-1,-20],[-2,-22],[-5,-24],[-10,-25],[-16,-27],[-20,-27],[-25,-30],[-30,-33],[-40,-35],[-50,-38],[-60,-42],[-68,-40],[-67,-30],[-68,-20],[-67,-10],[-68,-5],[-67,0],[-67,10],[-65,20],[-60,25],[-55,26],[-50,24],[-40,24],[-30,26],[-24,23],[-20,24],[-15,26],[-10,25],[-5,24],[0,25],[5,26],[15,26],[20,25],[30,21],[35,18],[39,15],[40,10],[41,4],[38, 0]], 18.0, true);
  addPolygon(geometry, [[38,-6],[32,-10],[25,-10],[23,-13],[20,-14],[12,-18],[10,-19],[0,-19],[-1,-20],[-2,-22],[-5,-24],[-10,-25],[-16,-27],[-20,-27],[-25,-30],[-30,-33],[-40,-35],[-50,-38],[-60,-42],[-68,-40],[-67,-30],[-68,-20],[-67,-10],[-68,-5],[-67,0],[-67,10],[-65,20],[-60,25],[-55,26],[-50,24],[-40,24],[-30,26],[-24,23],[-20,24],[-15,26],[-10,25],[-5,24],[0,25],[5,26],[15,26],[20,25],[30,22],[38,19],[43,15],[42,10],[44,4],[42,-3]], 18.0, true, [0,18,0]);
  addPolygon(geometry, [[38,-6],[32,-10],[25,-10],[23,-13],[20,-14],[12,-18],[10,-19],[0,-19],[-1,-20],[-2,-22],[-5,-24],[-10,-25],[-16,-27],[-20,-27],[-25,-30],[-30,-33],[-40,-35],[-50,-38],[-60,-42],[-68,-40],[-67,-30],[-68,-20],[-67,-10],[-68,-5],[-67,0],[-67,10],[-65,20],[-60,25],[-55,26],[-50,24],[-40,24],[-30,26],[-24,23],[-20,24],[-15,26],[-10,25],[-5,24],[0,25],[5,26],[15,26],[20,25],[30,25],[35,23],[40,20],[46,16],[48,12],[51,6],[51,1],[50,0],[45,-3]], 4.0, true, [0,36,0]);
  addPolygon(geometry, [        [32,-10],[25,-10],[23,-13],[20,-14],[12,-18],[10,-19],[0,-19],[-1,-20],[-2,-22],[-5,-24],[-10,-25],[-16,-27],[-20,-27],[-25,-30],[-30,-33],[-40,-35],[-50,-38],[-60,-42],[-68,-40],[-67,-30],[-68,-20],[-67,-10],[-68,-5],[-67,0],[-67,10],[-65,20],[-60,25],[-55,26],[-50,24],[-40,24],[-30,26],[-24,23],[-20,24],[-15,26],[-10,25],[-5,24],[0,25],[5,26],[10,24],[19,20],[19,17],[22,15],[23,8],[23,2],[26,0],[33,-1],[32,-6]], 6, true, [0,40,0]);
  addPolygon(geometry, [                                                              [0,-19],[-1,-20],[-2,-22],[-5,-24],[-10,-25],[-16,-27],[-20,-27],[-25,-30],[-30,-33],[-40,-35],[-50,-38],[-60,-42],[-68,-40],[-67,-30],[-68,-20],[-67,-10],[-68,-5],[-67,0],[-67,10],[-65,20],[-60,25],[-55,26],[-50,24],[-40,24],[-30,26],[-24,23],[-20,24],[-15,26],[-10,25],[-4,22], [-1,18], [3,18],[10,16],[15,14],[20,0],[15,-10],[10,-18]], 4, true, [0,46,0]);
  addCylinderDome(geometry, 15, 0.5, 10, 24, [0, 50, 0]);
  return makeMesh(geometry, lat, lng, 0);
  }

function NatlCathedral(lat, lng) {
  var geometry = new THREE.Geometry();
  addXRoofedBox(geometry, [132, 30, 16], 10, 0, [12, 0, 0]);  // nave
  addYRoofedBox(geometry, [16, 30, 62], 10, 0);  // perpendicular to nave
  addCylinderConeTop(geometry, 8, 30, 10, 10, [-54, 0, 0]);  //
  addBox(geometry, [23, 82.4, 23]);  // central tower
  addBox(geometry, [22,  1.4, 22], [0, 82.4, 0]);  // central tower top
  addRaisedPyramid(geometry, [2, 2], [0.5, 0.5], 3.5, 6, [ 10.5, 82.4,  10.5]);  // central tower spire
  addRaisedPyramid(geometry, [2, 2], [0.5, 0.5], 3.5, 6, [-10.5, 82.4,  10.5]);  // central tower spire
  addRaisedPyramid(geometry, [2, 2], [0.5, 0.5], 3.5, 6, [ 10.5, 82.4, -10.5]);  // central tower spire
  addRaisedPyramid(geometry, [2, 2], [0.5, 0.5], 3.5, 6, [-10.5, 82.4, -10.5]);  // central tower spire
  addBox(geometry, [11, 39.0, 11], [72.5, 0,  13.5]);  // north west tower base
  addBox(geometry, [ 8, 23.3,  8], [72.5, 39,  13.5]);  // north west tower upper section
  addRaisedPyramid(geometry, [2, 2], [0.5, 0.5], 2, 4, [75.5, 62.3,  16.5]);  // north west tower spire
  addRaisedPyramid(geometry, [2, 2], [0.5, 0.5], 2, 4, [69.5, 62.3,  16.5]);  // north west tower spire
  addRaisedPyramid(geometry, [2, 2], [0.5, 0.5], 2, 4, [75.5, 62.3,  10.5]);  // north west tower spire
  addRaisedPyramid(geometry, [2, 2], [0.5, 0.5], 2, 4, [69.5, 62.3,  10.5]);  // north west tower spire
  addBox(geometry, [11, 39.0, 11], [72.5, 0, -13.5]);  // south west tower base
  addBox(geometry, [ 8, 23.3,  8], [72.5, 39, -13.5]);  // south west tower upper section
  addRaisedPyramid(geometry, [2, 2], [0.5, 0.5], 2, 4, [75.5, 62.3, -16.5]);  // south west tower spire
  addRaisedPyramid(geometry, [2, 2], [0.5, 0.5], 2, 4, [69.5, 62.3, -16.5]);  // south west tower spire
  addRaisedPyramid(geometry, [2, 2], [0.5, 0.5], 2, 4, [75.5, 62.3, -10.5]);  // south west tower spire
  addRaisedPyramid(geometry, [2, 2], [0.5, 0.5], 2, 4, [69.5, 62.3, -10.5]);  // south west tower spire
  addYRoofedBox(geometry, [12,  6.0, 74], 2, 0, [72.0, 0, 0]);  // lower front section
  addXRoofedBox(geometry, [132, 18, 36], 9, 0, [12, 0, 0]);  // nave hips
  addXRoofedBox(geometry, [78, 12, 48], 12, 0, [39, 0, 0]);  // nave foot
  return makeMesh(geometry, lat, lng, 0);
  }

function Airport(lat, lng) {
  var geometry = new THREE.Geometry();
  addBoxSides(geometry, [26.8, 17.0, 361.8]);  // main concourse
  addBox(geometry, [40.2, 1.0, 361.8], [20.1, 10, 0]);  // west-side awning
  addBox(geometry, [13.4, 12.0, 522.6], [-6.7, 0, 0]);  // long hallway at ends
  for (var i = 0; i < 27; i++) {  // domes
    addClippedCylinderDome(geometry, 9, 0, 6, [13.4, 13.4], [ 6.7, 17, (i - 13)*13.4]);
    addClippedCylinderDome(geometry, 9, 0, 6, [13.4, 13.4], [-6.7, 17, (i - 13)*13.4]);
    }
  addBox(geometry, [48, 11.0, 48], [-138, 0,  226]);  // northern gates
  addBox(geometry, [48, 11.0, 48], [-148, 0,    0]);  // center gates
  addBox(geometry, [48, 11.0, 48], [ -98, 0, -226]);  // southern gates
  addBox(geometry, [100.6, 11.0, 32], [-63.7, 0,  226]);
  addBox(geometry, [110.6, 11.0, 32], [-68.7, 0,    0]);
  addBox(geometry, [ 60.6, 11.0, 32], [-43.7, 0, -226]);
  addCylinderConeTop(      geometry, 4.0, 60,       0.0, 10, [13.4,  0, 107.2]);  // main control tower
  addCylinderConeTop(      geometry, 3.8,  1,       0.0, 10, [13.4, 60, 107.2]);  // top of tower
  addCylinderConeTopBottom(geometry, 5.6, 15, 14.0, 2.8, 10, [13.4, 37, 107.2]);  // lower bulge
  addCylinderConeTopBottom(geometry, 5.6,  1, 14.0, 2.8, 10, [13.4, 57, 107.2]);  // upper bulge
  return makeMesh(geometry, lat, lng, 0);
  }

function ArlingtonHouse(lat, lng) {
  var geometry = new THREE.Geometry();
  addXRoofedBox(geometry, [20, 9,  18], 3, 0);  // main structure
  addYRoofedBox(geometry, [10, 6,  42], 1.5, 5, [2, 0, 0]);  // wings
  return makeMesh(geometry, lat, lng, 0);
  }

function EisenhowerOffice(lat, lng) {
  var geometry = new THREE.Geometry();
  addRaisedPyramid(geometry, [34, 18], [62, 6], 12, 2);  // middle corridor
  addRaisedPyramid(geometry, [74, 18], [62, 6], 12, 2, [0, 0,  60]);  // north corridor
  addRaisedPyramid(geometry, [74, 18], [62, 6], 12, 2, [0, 0, -60]);  // south corridor
  addRaisedPyramid(geometry, [18, 138], [6, 64], 12, 2, [ 26, 0, 0]);  // west corridor
  addRaisedPyramid(geometry, [18, 138], [6, 64], 12, 2, [-26, 0, 0]);  // east corridor
  addRaisedPyramid(geometry, [16, 22], [10, 16], 14, 2, [0, 0,  62]);  // north entrance
  addRaisedPyramid(geometry, [16, 22], [10, 16], 14, 2, [0, 0, -62]);  // south entrance
  addRaisedPyramid(geometry, [22, 16], [16, 10], 14, 2, [ 28, 0, 0]);  // west entrance
  addRaisedPyramid(geometry, [22, 16], [16, 10], 14, 2, [-28, 0, 0]);  // east entrance
  addBox(geometry, [10, 1, 16], [0, 16,  62]);  // north entrance raised roof
  addBox(geometry, [10, 1, 16], [0, 16, -62]);  // south entrance raised roof
  addBox(geometry, [16, 1, 10], [ 28, 16, 0]);  // west entrance raised roof
  addBox(geometry, [16, 1, 10], [-28, 16, 0]);  // east entrance raised roof
  addRaisedPyramid(geometry, [14, 6], [11, 3], 14, 2, [-32, 0, 19]);  //  NE extrusion
  addRaisedPyramid(geometry, [14, 6], [11, 3], 14, 2, [ 32, 0, 19]);  //  NW extrusion
  addRaisedPyramid(geometry, [14, 6], [11, 3], 14, 2, [-32, 0,-19]);  //  SE extrusion
  addRaisedPyramid(geometry, [14, 6], [11, 3], 14, 2, [ 32, 0,-19]);  //  SW extrusion
  addBox(geometry, [11, 1, 3], [-32, 16,  19]);  // NE extrusion raised roof
  addBox(geometry, [11, 1, 3], [ 32, 16,  19]);  // NW extrusion raised roof
  addBox(geometry, [11, 1, 3], [-32, 16, -19]);  // SE extrusion raised roof
  addBox(geometry, [11, 1, 3], [ 32, 16, -19]);  // SW extrusion raised roof
  return makeMesh(geometry, lat, lng, 0);
  }

function SupremeCourt(lat, lng) {
  var geometry = new THREE.Geometry();
  addBox(geometry, [ 118, 4.6, 30]);  // main floor (under columns)
  addBox(geometry, [ 110, 15, 30], [-4, 4.6, 0]);  // main filler
  addXRoofedBox(geometry, [118, 3, 30], 5.8, 0, [0, 19.6, 0]);  // main roof (over columns)
  addBox(geometry, [ 26, 11, 68]);  // middle corridor
  addXRoofedBox(geometry, [90, 11, 12], 2, 6, [0, 0,  39]);
  addXRoofedBox(geometry, [90, 11, 12], 2, 6, [0, 0, -39]);
  addYRoofedBox(geometry, [12, 11, 90], 2, 6, [ 39, 0, 0]);
  addYRoofedBox(geometry, [12, 11, 90], 2, 6, [-39, 0, 0]);
  for (var i = 0; i < 8; i++) {
    addCylinder(geometry, 0.9, 15, 10, [54.1, 4.6, -14 + i*4]);
    addCylinder(geometry, 0.9, 15, 10, [58.1, 4.6, -14 + i*4]);
    }
  for (var i = 0; i < 11; i++) {
    addBox(geometry, [0.8, 4.4 - i*0.4, 30], [59.4 + i*0.8, 0, 0]);  // steps
    }
  return makeMesh(geometry, lat, lng, 0);
  }

function ChinatownArch(lat, lng) {
  var geometry = new THREE.Geometry();
  addBox(geometry, [1.8, 3.2, 1.8], [0, 0, 12]);  // north pole base
  addBox(geometry, [1.8, 3.2, 1.8], [0, 0, -12]);  // south pole base
  addCylinderConeTop(geometry, 0.4, 7.5, 0, 12, [0, 3.2,  12]);  // north pole
  addCylinderConeTop(geometry, 0.4, 7.5, 0, 12, [0, 3.2, -12]);  // south pole
  addBox(geometry, [0.8, 2.5, 24.8], [0, 10.7, 0]);  // lower beam
  addBox(geometry, [0.8, 0.8, 12.2], [0, 13.2, 0]);  // center panel
  addBox(geometry, [0.8, 3.0,  4.0], [0, 13.2, 8.1]);
  addBox(geometry, [0.8, 3.0,  4.0], [0, 13.2, -8.1]);
  addPyramid(geometry, [0.8, 2.4], [2.0, 2.4], 1.2, [0, 13.2,  11.3]);
  addPyramid(geometry, [2.0, 2.4], [0.8, 2.4], 1.2, [0, 14.4,  11.3]);
  addPyramid(geometry, [0.8, 2.4], [2.0, 2.4], 1.2, [0, 13.2, -11.3]);
  addPyramid(geometry, [2.0, 2.4], [0.8, 2.4], 1.2, [0, 14.4, -11.3]);
  addPyramid(geometry, [0.8, 3.4], [2.0, 3.4], 1.1, [0, 14.0, -4.4]);
  addPyramid(geometry, [2.0, 3.4], [0.8, 3.4], 1.1, [0, 15.1, -4.4]);
  addPyramid(geometry, [0.8, 3.4], [2.0, 3.4], 1.1, [0, 14.0,  4.4]);
  addPyramid(geometry, [2.0, 3.4], [0.8, 3.4], 1.1, [0, 15.1,  4.4]);
  addBox(geometry, [0.8, 3.6, 5.4], [0, 14.0, 0]);  // upper center panel
  addPyramid(geometry, [0.8, 5.4], [2.6, 7.2], 1.4, [0, 17.6, 0]);
  addPyramid(geometry, [2.6, 7.2], [0.8, 5.4], 1.4, [0, 19.0, 0]);
  addPyramid(geometry, [0.8, 4.0], [2.6, 5.8], 1.5, [0, 16.2, 8.1]);
  addPyramid(geometry, [2.6, 5.8], [0.8, 4.0], 1.5, [0, 17.7, 8.1]);
  addPyramid(geometry, [0.8, 4.0], [2.6, 5.8], 1.5, [0, 16.2, -8.1]);
  addPyramid(geometry, [2.6, 5.8], [0.8, 4.0], 1.5, [0, 17.7, -8.1]);
  return makeMesh(geometry, lat, lng, 0);
  }

function BotanicGarden(lat, lng) {
  var geometry = new THREE.Geometry();
  addBox(geometry, [86, 12, 22], [0, 0, 23]);  // northern segment
  addXRoofedBox(geometry, [60, 0.5, 14], 6,  7, [  0, 12,  19]);  // northern skylight
  addBox(geometry, [86, 4, 9], [0, 0, -24.5]);  // southern segment
  addXRoofedBox(geometry, [60, 4, 8], 4,  0,   [  0, 0,  -16]);  // southern atrium
  addRaisedPyramid(geometry, [8, 8], [3.5, 3.5], 5, 4, [ 34, 0,-16]);  //  corner structure
  addRaisedPyramid(geometry, [3.5, 3.5], [0.5, 0.5], 1, 2, [ 34, 9,-16]);  //  corner structure skylight
  addRaisedPyramid(geometry, [8, 8], [3.5, 3.5], 5, 4, [ -34, 0,-16]);  //  corner structure
  addRaisedPyramid(geometry, [3.5, 3.5], [0.5, 0.5], 1, 2, [ -34, 9,-16]);  //  corner structure skylight
  addYRoofedBox(geometry, [8, 4, 24], 4,  0,   [-34, 0, 0]);  // western atrium
  addYRoofedBox(geometry, [8, 4, 24], 4,  0,   [ 34, 0, 0]);  // eastern atrium
  addRaisedPyramid(geometry, [30, 24], [20, 24], 2, 2);  // center atrium base
  addRaisedPyramid(geometry, [20, 24], [10, 18], 16, 6, [0, 4, 0]);  // center atrium middle level
  addRaisedPyramid(geometry, [9, 17], [1, 9], 1, 3, [0, 26, 0]);  // center atrium middle top
  return makeMesh(geometry, lat, lng, 0);
  }

function PortraitGallery(lat, lng) {
  var geometry = new THREE.Geometry();
  addYRoofedBox(geometry, [ 30, 20, 15], 4,  0,   [  0, 0,  36.5]);  // north entrance
  addXRoofedBox(geometry, [100, 20, 20], 4,  0,   [  0, 0,  29]);  // north corridor
  addXRoofedBox(geometry, [100, 20, 20], 4,  0,   [  0, 0, -29]);  // south corridor
  addYRoofedBox(geometry, [ 30, 20, 20], 4,  0,   [  0, 0, -39]);  // south entrance
  addXRoofedBox(geometry, [ 15, 20, 22], 4,  0,   [ 60, 0,   0]);  // west entrance
  addYRoofedBox(geometry, [ 20, 20, 84], 4, 10.5, [-50, 0,   0]);  // west corridor
  addYRoofedBox(geometry, [ 20, 20, 84], 4, 10.5, [ 50, 0,   0]);  // east corridor
  addXRoofedBox(geometry, [ 15, 20, 22], 4,  0,   [-60, 0,   0]);  // east entrance
  addClippedCylinderDome(geometry, 45, 1, 3, [80, 38], [0, 20, 0]);  // atrium canopy
  return makeMesh(geometry, lat, lng, 0);
  }

function TreasuryDept(lat, lng) {
  var geometry = new THREE.Geometry();
  addXRoofedBox(geometry, [52, 14,  18], 4, 0);  // middle corridor
  addXRoofedBox(geometry, [82, 14,  18], 4, 0, [0, 0,  61]);  // north corridor
  addXRoofedBox(geometry, [82, 14,  18], 4, 0, [0, 0, -61]);  // south corridor
  addYRoofedBox(geometry, [18, 14, 122], 4, 0, [ 26, 0, 0]);  // west corridor
  addYRoofedBox(geometry, [18, 14, 122], 4, 0, [-26, 0, 0]);  // east corridor
  addYRoofedBox(geometry, [23, 14,  31], 4, 0, [0, 0,  63.5]);  // north entrance
  addYRoofedBox(geometry, [23, 14,  18], 4, 0, [0, 0, -70.0]);  // south entrance
  return makeMesh(geometry, lat, lng, 0);
  }

function OldPostOffice(lat, lng) {
  var geometry = new THREE.Geometry();
  addBox(geometry, [ 60, 12,  84]);  // lower base
  addRaisedPyramid(geometry, [52, 76], [48, 72], 41, 10);  // central structure
  addYRoofedBox(geometry, [48, 1, 72], 8, 4, [0, 51, 0]);  // atrium roof
  addYRoofedBox(geometry, [16, 41, 32], 16, 4, [ 22, 0,  26]);  // corner block
  addYRoofedBox(geometry, [16, 41, 32], 16, 4, [-22, 0,  26]);  // corner block
  addYRoofedBox(geometry, [16, 41, 32], 16, 4, [ 22, 0, -26]);  // corner block
  addYRoofedBox(geometry, [16, 41, 32], 16, 4, [-22, 0, -26]);  // corner block
  addRaisedPyramid(geometry, [12, 12], [0.5, 0.5], 80, 16, [0, 0, 33]);  // tower
  return makeMesh(geometry, lat, lng, 0);
  }

function Carillon(lat, lng) {
  var geometry = new THREE.Geometry();
  addBox(geometry, [7.6,  0.6, 11.0]);  // floor
  addBox(geometry, [0.6, 38.7, 0.6], [ 3.5, 0,  5.2]);  // corner vertical beam
  addBox(geometry, [0.6, 38.7, 0.6], [-3.5, 0,  5.2]);  // corner vertical beam
  addBox(geometry, [0.6, 38.7, 0.6], [ 3.5, 0, -5.2]);  // corner vertical beam
  addBox(geometry, [0.6, 38.7, 0.6], [-3.5, 0, -5.2]);  // corner vertical beam
  addBox(geometry, [7.6,  0.6, 11.0], [0, 18.6, 0]);  // lower platform
  addBox(geometry, [7.6,  6.1, 11.0], [0, 21.6, 0]);  // cube supporting upper platform
  addBox(geometry, [7.6, 18.6, 5.0]);  // middle section (bottom)
  addBox(geometry, [0.6, 20.1, 0.6], [ 3.5, 18.6,  2.2]);  // upper vertical beam
  addBox(geometry, [0.6, 20.1, 0.6], [-3.5, 18.6,  2.2]);  // upper vertical beam
  addBox(geometry, [0.6, 20.1, 0.6], [ 3.5, 18.6, -2.2]);  // upper vertical beam
  addBox(geometry, [0.6, 20.1, 0.6], [-3.5, 18.6, -2.2]);  // upper vertical beam
  addBox(geometry, [7.6,  0.6, 5.0], [0, 32.8, 0]);  // roof near top
  addBox(geometry, [3.4, 32.8, 5.0]);  // upper housing
  addBox(geometry, [7.6,  0.6,  0.6], [ 0,   38.1,  5.2]);  // top square
  addBox(geometry, [7.6,  0.6,  0.6], [ 0,   38.1, -5.2]);  // top square
  addBox(geometry, [0.6,  0.6, 11.0], [ 3.5, 38.1,  0]);  // top square
  addBox(geometry, [0.6,  0.6, 11.0], [-3.5, 38.1,  0]);  // top square
  return makeMesh(geometry, lat, lng, 0);
  }

function NatlBuildingMuseum(lat, lng) {
  var geometry = new THREE.Geometry();
  addBox(       geometry, [ 123, 26, 63]);  // main structure
  addYRoofedBox(geometry, [ 38, 38, 38], 10, 0);  // Tall center
  addXRoofedBox(geometry, [ 96, 30, 38], 7, 0);  // attic
  addXRoofedBox(geometry, [ 86, 37, 10], 2, 0);  // attic upper level
  return makeMesh(geometry, lat, lng, 0);
  }

function NatlArchives(lat, lng) {
  var geometry = new THREE.Geometry();
  addBox(       geometry, [ 99, 29, 66]);  // main structure
  addBox(       geometry, [108, 29, 42]);  // east & west extensions
  addBox(       geometry, [ 76, 29, 73]);  // north & south extensions
  addYRoofedBox(geometry, [ 33, 29, 87], 8, 0);  // north-south corridor
  addBox(       geometry, [ 85, 41, 49]);  // upper section
  addBox(       geometry, [ 75, 46, 39]);  // upper setback
  return makeMesh(geometry, lat, lng, 0);
  }

function ArtsAndIndustries(lat, lng) {
  var geometry = new THREE.Geometry();
  addBoxSides(geometry, [90, 8, 90]);  // main structure
  addXRoofedBox(geometry, [90, 13, 20], 5, 0);  // east-west corridor
  addYRoofedBox(geometry, [20, 13, 90], 5, 0);  // north-south corridor
  addPyramid(geometry, [90, 90], [60, 60], 1.5, [0, 8, 0]);  // main outer roof
  addRaisedPyramid(geometry, [4, 4], [0.5, 0.5], 16, 8, [  8, 0,  47]);
  addRaisedPyramid(geometry, [4, 4], [0.5, 0.5], 16, 8, [ -8, 0,  47]);
  addRaisedPyramid(geometry, [4, 4], [0.5, 0.5], 16, 8, [  8, 0, -47]);
  addRaisedPyramid(geometry, [4, 4], [0.5, 0.5], 16, 8, [ -8, 0, -47]);
  addRaisedPyramid(geometry, [4, 4], [0.5, 0.5], 16, 8, [ 47, 0,   8]);
  addRaisedPyramid(geometry, [4, 4], [0.5, 0.5], 16, 8, [ 47, 0,  -8]);
  addRaisedPyramid(geometry, [4, 4], [0.5, 0.5], 16, 8, [-47, 0,   8]);
  addRaisedPyramid(geometry, [4, 4], [0.5, 0.5], 16, 8, [-47, 0,  -8]);
  addCylinderConeTop(geometry, 12, 24, 6, 18);
  addCylinderConeTop(geometry,  3, 32, 1, 18);  // cupola
  addRaisedPyramid(geometry, [12, 12], [6, 6], 11, 3, [ 43, 0,  43]);
  addRaisedPyramid(geometry, [12, 12], [6, 6], 11, 3, [-43, 0,  43]);
  addRaisedPyramid(geometry, [12, 12], [6, 6], 11, 3, [ 43, 0, -43]);
  addRaisedPyramid(geometry, [12, 12], [6, 6], 11, 3, [-43, 0, -43]);
  return makeMesh(geometry, lat, lng, 0);
  }

function DupontFountain(lat, lng) {
  var geometry = new THREE.Geometry();
  var cyl = makeCylinder(28.9, 28.9, 0.3, 48, 0.0);  geometry.merge(cyl.geometry, cyl.matrix);  // lowest base
  var cyl = makeCylinder(20.2, 20.2, 2.3, 36, 0.0);  geometry.merge(cyl.geometry, cyl.matrix);  // walkable circumference
  var cyl = makeCylinder(15.4, 15.4, 3.4, 24, 0.0);  geometry.merge(cyl.geometry, cyl.matrix);  // pool container
  var cyl = makeCylinder( 3.5,  3.5, 4.1, 24, 0.0);  geometry.merge(cyl.geometry, cyl.matrix);  // pedestal base
  var cyl = makeCylinder( 2.2,  3.5, 0.3, 24, 4.1);  geometry.merge(cyl.geometry, cyl.matrix);  // pedestal base's bevel
  var cyl = makeCylinder( 2.2,  2.2, 9.0, 24, 0.0);  geometry.merge(cyl.geometry, cyl.matrix);  // pedestal column
  var cyl = makeCylinder( 5.3,  2.3, 1.4, 24, 9.0);  geometry.merge(cyl.geometry, cyl.matrix);  // upper bowl
  return makeMesh(geometry, lat, lng, 0);
  }

function Hirshhorn(lat, lng) {
  var museum = [{x: 17.5, y:  4.3},  // interior bottom
                {x: 35.0, y:  4.3},  // exterior bottom; lower bevel
                {x: 35.0, y:  6.3},  // exterior bottom; bevel elbow
                {x: 35.2, y:  6.3},  // exterior bottom; outer bevel
                {x: 35.2, y: 19.7},  // exterior top; outer bevel
                {x: 35.0, y: 19.7},  // exterior top; bevel elbow
                {x: 35.0, y: 21.7},  // exterior top; upper bevel
                {x: 17.5, y: 21.7},  // interior top
                {x: 17.5, y:  4.3}];
  return makeRoundObject(museum, 32, lat, lng, 0);
  }

function HirshhornFeet(lat, lng) {
  var geometry = new THREE.Geometry();
  for (var i = 0; i < 4; i++) {
    var theta = Math.PI*i/2 + Math.PI/4;
    geometry.vertices.push(new THREE.Vector3(34.0*Math.sin(theta - 0.11), 0.0, 34.0*Math.cos(theta - 0.11)));  // 0
    geometry.vertices.push(new THREE.Vector3(35.0*Math.sin(theta - 0.13), 4.3, 35.0*Math.cos(theta - 0.13)));  // 1
    geometry.vertices.push(new THREE.Vector3(35.0*Math.sin(theta + 0.13), 4.3, 35.0*Math.cos(theta + 0.13)));  // 2
    geometry.vertices.push(new THREE.Vector3(34.0*Math.sin(theta + 0.11), 0.0, 34.0*Math.cos(theta + 0.11)));  // 3
    geometry.vertices.push(new THREE.Vector3(18.5*Math.sin(theta - 0.11), 0.0, 18.5*Math.cos(theta - 0.11)));  // 4
    geometry.vertices.push(new THREE.Vector3(17.5*Math.sin(theta - 0.13), 4.3, 17.5*Math.cos(theta - 0.13)));  // 5
    geometry.vertices.push(new THREE.Vector3(17.5*Math.sin(theta + 0.13), 4.3, 17.5*Math.cos(theta + 0.13)));  // 6
    geometry.vertices.push(new THREE.Vector3(18.5*Math.sin(theta + 0.11), 0.0, 18.5*Math.cos(theta + 0.11)));  // 7
    }
  for (var i = 0; i < 4; i++) {
    var segment = 8*i;
    geometry.faces.push(new THREE.Face3(segment + 0, segment + 2, segment + 1), new THREE.Face3(segment + 0, segment + 3, segment + 2));
    geometry.faces.push(new THREE.Face3(segment + 3, segment + 6, segment + 2), new THREE.Face3(segment + 3, segment + 7, segment + 6));
    geometry.faces.push(new THREE.Face3(segment + 5, segment + 7, segment + 4), new THREE.Face3(segment + 5, segment + 6, segment + 7));
    geometry.faces.push(new THREE.Face3(segment + 1, segment + 4, segment + 0), new THREE.Face3(segment + 1, segment + 5, segment + 4));
    }
  return makeMesh(geometry, lat, lng, 0);
  }

function RFKStadium(lat, lng) {
  var stadium = [{x: 104, y:  0.0},  // exterior foot
                 {x: 104, y: 22.5},  // top of lower wall
                 {x:  96, y: 22.5},  // setback
                 {x:  96, y: 33.8},  // top of upper wall
                 {x:  83, y: 40.0},  // tip of canopy
                 {x:  95, y: 33.8},  // top of upper seating area
                 {x:  74, y: 22.5},  // bottom of upper seating area
                 {x:  86, y: 16.3},  // top of lower seating area
                 {x:  55, y:  0.0}]  // bottom of lower seating area
  return makeRoundObject(stadium, 32, lat, lng, 0);
  }

function Pentagon(lat, lng) {
  var geometry = new THREE.Geometry();
  for (var i = 0; i < 5; i++) {  // each of five segments
    var theta = 2*Math.PI*i/5;
    geometry.vertices.push(new THREE.Vector3( 90*Math.sin(theta),  0,  90*Math.cos(theta)));
    geometry.vertices.push(new THREE.Vector3( 90*Math.sin(theta), 23,  90*Math.cos(theta)));
    geometry.vertices.push(new THREE.Vector3(240*Math.sin(theta), 23, 240*Math.cos(theta)));
    geometry.vertices.push(new THREE.Vector3(240*Math.sin(theta),  0, 240*Math.cos(theta)));
    }
  for (var i = 0; i < 5; i++) {
    var a = 4*i;
    var b = 4*((i + 1) % 5);
    geometry.faces.push(new THREE.Face3(    a, a + 1, b + 1), new THREE.Face3(    a, b + 1,     b));  // inner wall
    geometry.faces.push(new THREE.Face3(a + 1, a + 2, b + 2), new THREE.Face3(a + 1, b + 2, b + 1));  // roof
    geometry.faces.push(new THREE.Face3(a + 2, a + 3, b + 3), new THREE.Face3(a + 2, b + 3, b + 2));  // outer wall
    }
  return makeMesh(geometry, lat, lng, 0);
  }

function JeffersonMemorial(lat, lng) {
  var geometry = new THREE.Geometry();
  var cyl = makeCylinder(25.5, 25.5, 0.9, 48,  0.0);  geometry.merge(cyl.geometry, cyl.matrix);  // lowest base
  var cyl = makeCylinder(24.0, 24.0, 1.8, 36,  0.0);  geometry.merge(cyl.geometry, cyl.matrix);  // 1st step up
  var cyl = makeCylinder(22.5, 22.5, 2.7, 24,  0.0);  geometry.merge(cyl.geometry, cyl.matrix);  // 2nd step up
  var cyl = makeCylinder(22.5, 22.5, 4.7, 24, 15.7);  geometry.merge(cyl.geometry, cyl.matrix);  // roof over columns
  var cyl = makeCylinder(18.0, 18.0, 3.3, 24, 20.4);  geometry.merge(cyl.geometry, cyl.matrix);  // lower base of the dome
  var cyl = makeCylinder(15.4, 15.4, 2.4, 24, 23.7);  geometry.merge(cyl.geometry, cyl.matrix);  // upper base of the dome
  var spheregeo = new THREE.SphereGeometry(14, 12, 9, 0, 2*Math.PI, 0, Math.PI/2);
  var dome = new THREE.Mesh(spheregeo);
  dome.position.y = 24;
  dome.scale.y = 0.67;
  dome.updateMatrix();
  geometry.merge(dome.geometry, dome.matrix);
  var cylgeo = new THREE.CylinderGeometry(0.9, 0.9, 13, 24);  // radiusTop, radiusBottom, height, segments
  var column = new THREE.Mesh(cylgeo);
  for (var i = 0; i < 36; i++) {  // 36 columns
    var distFromXAxis = sign(           i - 17.5)*Math.min(3.5, 9 - Math.abs(      i % 18 - 8.5));
    var distFromZAxis = sign((i + 9) % 36 - 17.5)*Math.min(5.5, 9 - Math.abs((i + 9) % 18 - 8.5));
    column.position.set(20.5*Math.sin(Math.PI*i/18), 9.2, 20.5*Math.cos(Math.PI*i/18));
    column.updateMatrix();
    geometry.merge(column.geometry, column.matrix);
    }
  return makeMesh(geometry, lat, lng, 0);
  }

function KennedyCenter(lat, lng) {
  var geometry = new THREE.Geometry();
  box = makeBox(144.5,  0.1, 210.0,  0.0);  box.position.x = -5.5; box.updateMatrix(); geometry.merge(box.geometry, box.matrix);  // patio circumference
  box = makeBox( 94.5, 20.0, 199.0,  0.1);  geometry.merge(box.geometry, box.matrix);  // main section
  box = makeBox(105.5,  1.0, 210.0, 20.1);  geometry.merge(box.geometry, box.matrix);  // main overhang
  box = makeBox( 83.5,    8, 188.0, 21.1);  geometry.merge(box.geometry, box.matrix);  // upper section
  box = makeBox( 90.5,  0.9, 195.0, 29.1);  geometry.merge(box.geometry, box.matrix);  // upper overhang
  var cylgeo = new THREE.CylinderGeometry(0.25, 0.25, 20.0, 8);  // radiusTop, radiusBottom, height, segments
  var cylinder = new THREE.Mesh(cylgeo);
  for (var i = 0; i < 23; i++) {
    cylinder.position.set( 52.0, 10.05, 104.5 - 9.5*i);  cylinder.updateMatrix();  geometry.merge(cylinder.geometry, cylinder.matrix);
    cylinder.position.set(-52.0, 10.05, 104.5 - 9.5*i);  cylinder.updateMatrix();  geometry.merge(cylinder.geometry, cylinder.matrix);
    }
  for (var i = 0; i < 10; i++) {
    cylinder.position.set(42.75 - 9.5*i, 10.05,  104.75);  cylinder.updateMatrix();  geometry.merge(cylinder.geometry, cylinder.matrix);
    cylinder.position.set(42.75 - 9.5*i, 10.05, -104.75);  cylinder.updateMatrix();  geometry.merge(cylinder.geometry, cylinder.matrix);
    }
  return makeMesh(geometry, lat, lng, 0);
  }

function LincolnMemorial(lat, lng) {
  var columnWidth = 61/23;  // about 2.65 meters
  var memorialWidth = columnWidth*23;  // 23 = 12 columns + 11 spaces
  var memorialDepth = columnWidth*15;  // 15 = 8 columns + 7 spaces
  var geometry = new THREE.Geometry();
  box = makeBox(memorialDepth - 11, 29, memorialWidth - 11,  0.0);  geometry.merge(box.geometry, box.matrix);  // interior container
  box = makeBox(memorialDepth,       4, memorialWidth,      19.0);  geometry.merge(box.geometry, box.matrix);  // roof over columns
  box = makeBox(memorialDepth,       3, memorialWidth,       0.0);  geometry.merge(box.geometry, box.matrix);  // walkable circumference
  box = makeBox(memorialDepth +  2,  2, memorialWidth +  2,  0.0);  geometry.merge(box.geometry, box.matrix);  // upper base
  box = makeBox(memorialDepth +  4,  1, memorialWidth +  4,  0.0);  geometry.merge(box.geometry, box.matrix);  // lower base
  var cylgeo = new THREE.CylinderGeometry(columnWidth/2 - 0.1, columnWidth/2 - 0.01, 16, 24);  // radiusTop, radiusBottom, height, segments
  var cylinder = new THREE.Mesh(cylgeo);
  for (var i = 0; i < 36; i++) {  // 36 columns
    var distFromXAxis = sign(           i - 17.5)*Math.min(3.5, 9 - Math.abs(      i % 18 - 8.5));
    var distFromZAxis = sign((i + 9) % 36 - 17.5)*Math.min(5.5, 9 - Math.abs((i + 9) % 18 - 8.5));
    cylinder.position.set(2*columnWidth*distFromXAxis, 11, 2*columnWidth*distFromZAxis);
    cylinder.updateMatrix();
    geometry.merge(cylinder.geometry, cylinder.matrix);
    }
  return makeMesh(geometry, lat, lng, 0);
  }

function Capitol(lat, lng) {
  var geometry = new THREE.Geometry();
  box = makeCube(68.0, 31.0,  54.6,  7.1,   0.0); geometry.merge(box.geometry, box.matrix);  // central section
  box = makeCube(48.4, 31.0,  28.4, -5.0,  41.5); geometry.merge(box.geometry, box.matrix);  // northern midsection
  box = makeCube(48.4, 31.0,  28.4, -5.0, -41.5); geometry.merge(box.geometry, box.matrix);  // southern midsection
  box = makeCube(24.0, 31.0, 139.0, -7.0,   0.0); geometry.merge(box.geometry, box.matrix);  // central north-south axis
  box = makeCube(75.4, 31.0,  45.0,  0.0,  92.0); geometry.merge(box.geometry, box.matrix);  // Senate chamber
  box = makeCube(75.4, 31.0,  45.0,  0.0, -92.0); geometry.merge(box.geometry, box.matrix);  // House chamber
  var cyl = makeCylinder(17.5, 17.5, 46.2, 48, 0.0);  geometry.merge(cyl.geometry, cyl.matrix);  // lower base of the dome ... should be 20?
  var cyl = makeCylinder(16.0, 16.0, 56.2, 48, 0.0);  geometry.merge(cyl.geometry, cyl.matrix);  // upper base of the dome
  var cyl = makeCylinder( 2.0,  2.0, 81.2, 48, 0.0);  geometry.merge(cyl.geometry, cyl.matrix);  // tholos
  var cyl = makeCylinder( 1.0,  2.0, 86.2, 48, 0.0);  geometry.merge(cyl.geometry, cyl.matrix);  // statue on top
  var spheregeo = new THREE.SphereGeometry(15, 12, 9, 0, 2*Math.PI, 0, Math.PI/2);
  var dome = new THREE.Mesh(spheregeo);
  dome.position.y = 56.2;
  dome.scale.y = 1.3333333;
  dome.updateMatrix();
  geometry.merge(dome.geometry, dome.matrix);
  return makeMesh(geometry, lat, lng, 0);
  }

function latToZ(lat) {
  return worldHeight*(lat - minLat)/(maxLat - minLat) - worldHeight/2;
  }

function lngToX(lng) {
  return worldWidth/2 - worldWidth*(lng - minLng)/(maxLng - minLng);
  }

function setBoundary(background, south, west, north, east, w, h) {
  minLng = west;  // left
  maxLng = east;  // right
  minLat = south;  // bottom
  maxLat = north;  // top
  swidth = w;
  sheight = h;
  }

function init() {
  setBoundary("region512.png", 38.78854, -77.27364, 39.12946, -76.83205, 640, 640);
  renderer = new THREE.WebGLRenderer({antialias: true, alpha: false});
  renderer.setClearColor(0x202040);
  renderer.setSize(window.innerWidth, window.innerHeight);
  document.body.appendChild(renderer.domElement);
  camera = new THREE.PerspectiveCamera(50, window.innerWidth/window.innerHeight, 1, 10000);
  camera.position.x = lngToX(-77.058);
  camera.position.z = latToZ(38.887);
  camera.position.y = 0.4;
  camera.up.set(0, 1, 0);
  controls = new MapControls(camera, render);
  /*
  controls = new THREE.TrackballControls( camera );
				controls.rotateSpeed = 1.0;
				controls.zoomSpeed = 1.2;
				controls.panSpeed = 0.8;
				controls.noZoom = false;
				controls.noPan = false;
				controls.staticMoving = true;
				controls.dynamicDampingFactor = 0.3;
				controls.keys = [ 65, 83, 68 ];
				controls.addEventListener( 'change', render );
        */
  lookingAt.point.x = lngToX(-77.035246);
  lookingAt.point.z = latToZ( 38.889376);
  camera.lookAt(lookingAt.point);
  camera.updateMatrix();
  scene = new THREE.Scene();
  scene.fog = new THREE.FogExp2(0x000000, 0.0015);  // color, density
  var directionalLight = new THREE.DirectionalLight(0xffffee, 0.5);
  directionalLight.position.set(-800, 1600, 400);
  scene.add(directionalLight);
  scene.add(new THREE.HemisphereLight(0xffffff, 0x000088, 1));  // skyColorHex, groundColorHex, intensity
  scene.add(new THREE.AmbientLight(0x334444));
  for (var i = 0; i < LincolnTraffic.length; i++) {
    LincolnTraffic[i].splineObject = [];
    for (var j = 1; j <= CaBiSplineSteps; j++) {
      var curve = new THREE.CatmullRomCurve3([
        new THREE.Vector3(lngToX(-77.049426), 0, latToZ(38.888251)),  // LincolnMemorial cabi station
        new THREE.Vector3(lngToX((LincolnTraffic[i].lng + -77.050153)/2), 0.1*LincolnTraffic[i].trips*j/CaBiSplineSteps, latToZ((LincolnTraffic[i].lat + 38.889376)/2)),
        new THREE.Vector3(lngToX(LincolnTraffic[i].lng), 0, latToZ(LincolnTraffic[i].lat))
        ]);
      var geometry = new THREE.Geometry();
      geometry.vertices = curve.getPoints(50);
      var material = new THREE.LineBasicMaterial({color: 0xff0000, opacity: 0.8, transparent: true});
      LincolnTraffic[i].splineObject[j - 1] = new THREE.Line(geometry, material);
      }
    LincolnTraffic[i].label = document.createElement('div');
    LincolnTraffic[i].label.className = "cabistation";
    document.body.appendChild(LincolnTraffic[i].label);
    }
  updateLabels();
  var groundGeometry = new THREE.PlaneGeometry(worldWidth, worldHeight);
  var groundMaterial = new THREE.MeshBasicMaterial({side: THREE.DoubleSide});
  var textureLoader = new THREE.TextureLoader();
  textureLoader.load('region512.png', function(texture) {
    groundMaterial.map = texture;
    ground = new THREE.Mesh(groundGeometry, groundMaterial);
    ground.rotation.x = -Math.PI/2;  // change from vertical to horizontal
    ground.rotation.z = Math.PI;  // have south end of image (the bottom) be closest to us
    scene.add(ground);
    });
  scene.add(ArlingtonHouse(       38.881178, -77.072647));
  scene.add(Airport(              38.853729, -77.043069));
  scene.add(NatlCathedral(        38.930615, -77.070781));
  scene.add(ReevesBuilding(       38.917565, -77.032430));
  scene.add(ChinatownArch(        38.899820, -77.021703));
  scene.add(DupontFountain(       38.909662, -77.043415));
  scene.add(EisenhowerOffice(     38.897582, -77.038635));
  scene.add(WhiteHouse(           38.897681, -77.036500));
  scene.add(TreasuryDept(         38.897582, -77.034247));
  scene.add(KennedyCenter(        38.895927, -77.055687));
  scene.add(PortraitGallery(      38.897879, -77.022829));
  scene.add(NatlBuildingMuseum(   38.897762, -77.017612));
  scene.add(OldPostOffice(        38.894073, -77.027777));
  scene.add(NatlArchives(         38.892817, -77.023134));
  scene.add(AfricanHistoryMuseum( 38.891067, -77.032602));
  scene.add(AmericanHistoryMuseum(38.891218, -77.030017));
  scene.add(NaturalHistoryMuseum( 38.891338, -77.026126));
  scene.add(NGAWest(              38.891306, -77.020017));
  scene.add(NGAEast(              38.891364, -77.016696));
  scene.add(LincolnMemorial(      38.889376, -77.050153));
  scene.add(WashingtonMonument(   38.889457, -77.035237));
  scene.add(SupremeCourt(         38.890609, -77.004426));
  scene.add(LOC_Jefferson(        38.888652, -77.004717));
  scene.add(BotanicGarden(        38.887961, -77.012979));
  scene.add(Capitol(              38.889828, -77.009144));
  scene.add(RFKStadium(           38.889376, -76.971950));
  scene.add(FreerGallery(         38.888068, -77.027391));
  scene.add(SmithsonianCastle(    38.888758, -77.026075));
  scene.add(ArtsAndIndustries(    38.888163, -77.024586));
  scene.add(Hirshhorn(            38.888175, -77.023042));
  scene.add(HirshhornFeet(        38.888175, -77.023042));
  scene.add(AirSpaceMuseum(       38.888186, -77.019922));
  scene.add(IndianMuseum(         38.888254, -77.016539));
  scene.add(JeffersonMemorial(    38.881398, -77.036513));
  scene.add(Carillon(             38.888208, -77.069491));
  scene.add(Pentagon(             38.870998, -77.055964));
  scene.add(AlexandriaLodge(      38.807510, -77.065934));
  //scene.add(CaBiBike(             38.889057, -77.035037, 0, 100, [0.93, 0.15, 0.11]));  // giant bike on Mall
  //caBiModel = CaBiBikeModel(10);  // parameter is scale (1 is normal)
  //caBiEdgeModel = CaBiBikeModel(1);  // needs a different scale
  //edges = new THREE.EdgesHelper(makeMesh(caBiEdgeModel, 38.889057, -77.03505, 0), 0x00ff00);
  //edges.position.x = lngToX(-77.03505);
  //edges.position.z = latToZ(38.889057);
  //edges.updateMatrix();
  //scene.add(edges);
  lastTime = window.performance ? performance.now() : Date.now();
  }

function updateLabels() {
  for (var i = 0; i < LincolnTraffic.length; i++) {
    LincolnTraffic[i].label.innerHTML = LincolnTraffic[i].name;
    if (showData) {
      LincolnTraffic[i].label.innerHTML += "<br>" + LincolnTraffic[i].trips + " trips";
      }
    if (showDocks) {
      LincolnTraffic[i].label.innerHTML += "<br>" + LincolnTraffic[i].bikes + " bikes, " + LincolnTraffic[i].docks + " docks";
      }
    }
  }

function checkMouse(e) {
  cursor.x = e.clientX;
  cursor.y = e.clientY;
  }

function checkKeyboard(e) {
  var key = e.which || e.keyCode;
  console.log(key)
  if (key == 38) {  // up arrow
    camera.position.y *= 1.1;
    }
  if (key == 40) {  // down arrow
    camera.position.y *= 0.9;
    }
  if (key == 75) {  // "K"
    lookingAt.point.x = lngToX(-77.055687);
    lookingAt.point.z = latToZ( 38.895927);
    camera.lookAt(lookingAt.point);
    }
  if (key == 76) {  // "L" for Lincoln Memorial:
    lookingAt.point.x = lngToX(-77.050153);
    lookingAt.point.z = latToZ( 38.889376);
    camera.lookAt(lookingAt.point);
    }
  if (key == 87) {  // "W" for Washington Monument:
    lookingAt.point.x = lngToX(-77.035246);
    lookingAt.point.z = latToZ( 38.889376);
    camera.lookAt(lookingAt.point);
    }
  }

function sign(x) {
  return x ? x < 0 ? -1 : 1 : 0;
  }

function animate() {
  requestAnimationFrame(animate);
  controls.update();
  var time = (window.performance ? performance.now() : Date.now())/1000;
  /*
  var horSpeed = Math.floor(8*(window.innerWidth/2 - cursor.x)/window.innerWidth);  // -4 to 4
  var verSpeed = Math.floor(8*(window.innerHeight/2 - cursor.y)/window.innerHeight);  // -4 to 4
  var lookingAt = camera.getWorldDirection();
  var theta = Math.atan2(lookingAt.x, lookingAt.z);
  //camera.position.x = camera.position.x + 0.03*(horSpeed*Math.cos(theta) + verSpeed*Math.sin(theta));
  //camera.position.z = camera.position.z + 0.03*(horSpeed*Math.sin(theta) + verSpeed*Math.cos(theta));
  camera.position.x = camera.position.x + 0.03*horSpeed*Math.cos(theta);
  camera.position.z = camera.position.z + 0.03*horSpeed*Math.sin(theta);
  //camera.position.x = camera.position.x + 0.03*(horSpeed*Math.cos(theta));
  //camera.position.z = camera.position.z + 0.03*(horSpeed*Math.sin(theta));
  console.log(theta)
  camera.updateMatrix();
  camera.updateProjectionMatrix();
  */
  renderer.render(scene, camera);
  var vector = new THREE.Vector3();
  var widthHalf = 0.5*renderer.context.canvas.width;
  var heightHalf = 0.5*renderer.context.canvas.height;
  if (CaBiSplineDelta != 0) {
    // animate data splines:
    var prevIndex = CaBiSplineIndex;
    if (CaBiSplineIndex + CaBiSplineDelta < -1 || CaBiSplineIndex + CaBiSplineDelta >= CaBiSplineSteps) {
      CaBiSplineDelta = 0;
      }
    else {
      CaBiSplineIndex += CaBiSplineDelta;
      }
    for (var i = 0; i < LincolnTraffic.length; i++) {
      if (prevIndex >= 0) {
        scene.remove(LincolnTraffic[i].splineObject[prevIndex]);
        }
      if (CaBiSplineIndex >= 0) {
        scene.add(LincolnTraffic[i].splineObject[CaBiSplineIndex]);
        }
      }
    if (CaBiSplineIndex >= CaBiSplineSteps && CaBiSplineIndex < 0) {
      CaBiSplineDelta = 0;
      }
    }
  for (var i = 0; i < LincolnTraffic.length; i++) {
    vector.set(lngToX(LincolnTraffic[i].lng), 0, latToZ(LincolnTraffic[i].lat));
    vector.project(camera);
    LincolnTraffic[i].label.style.left = vector.x*widthHalf + widthHalf + "px";
    LincolnTraffic[i].label.style.bottom = vector.y*heightHalf + heightHalf + 20 + "px";
    LincolnTraffic[i].label.style.zIndex = Math.round(2048*(1 - vector.z)) + "";
    LincolnTraffic[i].label.style.visibility = showStations && vector.z >= 0 && vector.z + 0.2*Math.abs(vector.x) < 0.9 ? "visible" : "hidden";
    }
  lastTime = time;
  }

function render() {
  renderer.render(scene, camera);
  }

function toggleStns() {
  showStations = !showStations;
  }

function toggleDocks() {
  showDocks = !showDocks;
  getCaBiData();
  }

function toggleData() {
  showData = !showData;
  if (CaBiSplineIndex < CaBiSplineSteps/2) {
    CaBiSplineDelta = 1;
    }
  else {
    CaBiSplineDelta = -1;
    }
  updateLabels();
  }

document.addEventListener("keydown", checkKeyboard);
init();
animate();
</script>
<div id=controls >left-mouse button: pan & dolley<br>
  right-mouse button: rotate XZ/YZ<br>
  up/down arrows: move up/down<br>
  k: look at Kennedy Center<br>
  l: look at Lincoln Memorial<br>
  w: look at Washington Monument<br>
  <label><input type=checkbox checked onchange="toggleStns()">show CaBi labels</label><br>
  <label><input type=checkbox onchange="toggleDocks()">show CaBi dock statuses</label><br>
  <label><input type=checkbox id=showCaBiData onchange="toggleData()">show CaBi data</label>
</body>
</html>
